!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(module,exports){window.jSW=window.jSW||{},function(jSW){var jSWInit=function(){var t=t||{},n=n||{},o=o||{http:"http://127.0.0.1",ip:"192.168.6.32",port:8181,url:"/jswapi",appkey:"FE04553E-B6D8-4CCB-AAAB-FF7F6B64E006",version:"1.0.1",calltype:0,ocxWebsocketPort:0,session_list:[],init_options:null,CheckOcx:function(){return jSW.CallProtoType.CheckOcx(this.calltype)},CheckNotOcx:function(){return!this.CheckOcx()},CheckHttp:function(){return jSW.CallProtoType.HTTP==this.calltype}};function i(e){this._lastCPI={bCanGet:!1,iAlready:-1,iTotal:-1},this._session=e,this._bLoading=!1,this._iAlreadLoadCount=0,this.bMutilNotify=i.Config.bMutilNotifyDft}jSW.CallProtoType={AUTO:0,OCX:1,HTTP:2,CheckOcx:function(e){return e==this.OCX}},jSW.SW_CHANEL_STATUS={OPENED:0,OPENING:1,CLOSED:2,HLS_OPEN:3,HLS_M3U8:4},jSW.MessageType=null,jSW.RotateType=null,jSW.EventActions=null,jSW.StorageRecordType={NONE:0,MANUAL:1,ONTIME:2,ONALARM:4},jSW.OpenDebug=function(e){n._IsDebug=e},jSW.StorageFileType={ALL:0,RECORD:1,CAPTURE:2,GPS:4,AUDIO:8,FIRMWARE:256},jSW._swOcxOnEvent=function(e,t){console.log("ocx on event rc:"+e+" websocket port: "+t);var n=parseInt(t);(e!=jSW.RcCode.RC_CODE_S_OK||n<=0)&&console.error("ocx init fail "+e+" "+n),n<=0&&(e=jSW.RcCode.RC_CODE_E_INVALIDARG),o.ocxWebsocketPort=n,o.init_options.oninit&&"function"==typeof o.init_options.oninit&&(jSW._mMgr.bUseOcx()?setTimeout(o.init_options.oninit,50,e):o.init_options.oninit(e))},jSW._swOcxPlayerOnEvent=function(e,t){try{0==e&&t&&t._swOnDivSizeChange(-1)}catch(e){}},jSW._lastOptions=null,jSW.swInit=function(e){return function(e){var t={bocxws:!1,bNEGP:!1};e&&e.config&&(t.bocxws=!!e.config.bocxws,t.bNEGP=!!e.config.bNEGP);jSW._mMgr.setBUseOcxWs(t.bocxws),i.Config.SetMultiNotifyDft(t.bNEGP)}(e),jSW.DependencyMgr.LoadProDepends(function(e){var i={url:null,calltype:jSW.CallProtoType.AUTO,oninit:null,home:null};if(e=n.extend({},i,e||{}),null==jSW.MessageType&&(jSW.MessageType=t.RequestHeader.notifys),null==jSW.RotateType&&(jSW.RotateType=t.RotateType),null==jSW.EventActions&&(jSW.EventActions=t.EVENTACTIONS),0=="WebSocket"in window)return alert("not support websocket"),e.oninit&&"function"==typeof e.oninit&&e.oninit(jSW.RcCode.RC_CODE_E_INVALIDARG),jSW.RcCode.RC_CODE_E_INVALIDARG;o.init_options=e;var r=window.document.location.href,s=window.document.location.pathname,a=r.lastIndexOf(s),l=r.substring(0,a);if(null!=e.url&&e.url.length>0&&(l=e.url),null==e.home&&(e.home=l),o.http=l,o.url=l.replace("http://","")+"/jswapi",o.ip=l.replace("http://","").replace("/","").split(":")[0],o.port=parseInt(document.location.port),o.calltype=e.calltype,jSW.CallProtoType.AUTO==o.calltype&&(n.isIE()?o.calltype=jSW.CallProtoType.OCX:o.calltype=jSW.CallProtoType.HTTP),0==n.isIE()&&jSW.CallProtoType.OCX==o.calltype)return console.error("only ie support ocx!"),e.oninit&&"function"==typeof e.oninit&&e.oninit(jSW.RcCode.RC_CODE_E_INVALIDARG),jSW.RcCode.RC_CODE_E_INVALIDARG;if(jSW.CallProtoType.OCX==o.calltype){var _=document.getElementById("jsw_ocx");if(null==_){try{(_=document.createElement("object")).id="jsw_ocx",_.classid="clsid:51DF1D91-DA4E-47DA-A5BE-84A96ADD2425",_.width=1,_.height=1,_.style.position="absolute",_.style.top="0px",_.style.left="0px",document.body.appendChild(_)}catch(t){if(console.error("ocx attach exception "+t),(d=document.getElementById("jsw_ocx"))&&document.body.removeChild(d),jSW.CallProtoType.OCX==o.calltype)return e.oninit&&"function"==typeof e.oninit&&e.oninit(jSW.RcCode.RC_CODE_E_INVALIDARG),jSW.RcCode.RC_CODE_E_INVALIDARG;o.calltype=jSW.CallProtoType.HTTP}if(null!=_){try{var c=0,u=setInterval(function(){document.innerHTML-="0";var e=_.oxGetWebSocketPort();e>0||c>10?(clearInterval(u),jSW._swOcxOnEvent(0,e)):c++},200)}catch(t){var d;if((d=document.getElementById("jsw_ocx"))&&document.body.removeChild(d),document.body.removeChild(oScript),console.error("ocx add event exception "+t),jSW.CallProtoType.OCX==o.calltype)return e.oninit&&"function"==typeof e.oninit&&e.oninit(jSW.RcCode.RC_CODE_E_INVALIDARG),jSW.RcCode.RC_CODE_E_INVALIDARG;o.calltype=jSW.CallProtoType.HTTP}jSW._mMgr.RegOcxHandle(_)}}else e.oninit&&"function"==typeof e.oninit&&e.oninit(jSW.RcCode.RC_CODE_S_OK);jSW.DependencyMgr.LoadOcxDepends()}else o.calltype==jSW.CallProtoType.HTTP&&jSW.DependencyMgr.LoadHttpDepends(function(e){e.oninit&&"function"==typeof e.oninit&&(e.oninit(jSW.RcCode.RC_CODE_S_OK),n.debugLogInfo("load video.js ok!"))},e)},e),jSW.RcCode.RC_CODE_S_OK},jSW.swDeInit=function(){if(o.session_list.length>0){for(var e=0;e<o.session_list.length;e++)o.session_list[e].swDispose(),delete o.session_list[e];o.session_list=[]}return jSW.RcCode.RC_CODE_S_OK},jSW.swGetOption=function(){return{http:o.http,version:o.version,calltype:o.calltype}},jSW.SWSession=function(e){jSW.swDeInit();e=n.extend({},{server:"127.0.0.1",port:9701,onopen:null,onclose:null},e||{}),this._server=e.server,this._port=Number(e.port),this._arr_pu=[],this._arr_pu_index=[],this._arr_pu_offline=[],this._arr_pu_online=[],this._arr_dialog=[],this._arr_record_play=[],this._p_emms=new proto.WEBBVCU.EmmsHeader,this._p_emms.setKey(o.appkey),this._p_emms.setVer(o.version),this._emms=new t.EmmsHeader(o.appkey,o.version),this._bLogout=!1,this._callbackManager=new jSW.SWCallbackManager(this,[t.RequestHeader.notifys.notify.cmd,t.RequestHeader.login.cmd,t.RequestHeader.keeplive.cmd,t.RequestHeader.logout.cmd,t.RequestHeader.pulist.cmd,t.RequestHeader.openchanle.cmd,t.RequestHeader.keeplivechanle.cmd,t.RequestHeader.closechanle.cmd,t.RequestHeader.pugpsdata.cmd]),this._confManager=null,this._immodule=null,this._pusModule=null,o.calltype==jSW.CallProtoType.OCX&&(this._confManager=new jSW.SwConfManager(this),this._pusModule=new jSW.SWSession._SwPuModule(this),this._immodule=new jSW.SWSession.SwImModule(this,this._confManager)),this._userManager=new jSW.SwUserManager(this),this._commDlgMgr=new jSW.CommonDlgMgr(this);try{jSW._mMgr.loadWebSocket(function(e,t,n){try{var o=e._getWsDesUrl(t);e._ws=new n(o),e._checkWsCreateResult(t)}catch(n){e._onWsError(t,n)}},this,e)}catch(t){return void this._onWsError(e,t)}this._pulistLoadMgr=new i(this)},i.Config={bMutilNotifyDft:!1,SetMultiNotifyDft:function(e){this.bMutilNotifyDft=!!e}},i.prototype={LOAD_PU_COUNT_PER_REQ:100,onGetCPI:function(e,t,n){this._lastCPI.bCanGet=e,this._lastCPI.iAlready=n,this._lastCPI.iTotal=t,e&&this._checkDispatch()},_checkDispatch:function(){this._bLoading||this._iAlreadLoadCount<this._lastCPI.iAlready&&(this._bLoading=!0,this._GetPulist())},_GetPulist:function(){var e=this._iAlreadLoadCount,t=this._lastCPI.iAlready-this._iAlreadLoadCount;t>this.LOAD_PU_COUNT_PER_REQ&&(t=this.LOAD_PU_COUNT_PER_REQ);var n={reqParams:null,pLM:this},o={sIndex:e,iCount:t,callback:this._onGetHasResult,tag:n};o.tag.reqParams=o,this._session._onShouldGetPulist(o)},_onGetPulistHasResult:function(e,t){e&&(this._iAlreadLoadCount=t.sIndex+t.iCount,this._bLoading&&(this._bLoading=!1,this._checkDispatch()))},_onGetHasResult:function(e,t){e.tag.pLM._onGetPulistHasResult(0==t.emms.code,e.tag.reqParams)},_checkBNotiCaller:function(){return!(!this.bMutilNotify&&this._iAlreadLoadCount!=this._lastCPI.iTotal)}},jSW.SWSession._SwPuModule=function(e){this._session=e},jSW.SWSession._SwPuModule.prototype={_onNotifyImMsg:function(e,n,o){var i=o.getPayload();n=t.RequestHeader.confnotify.notifyimmsg.cmd,data=proto.WEBBVCU.IMMsgPks.deserializeBinary(i),data=t.IMMsgPksPb2_Json(data);var r={szSourceId:data.szSourceId,iSourceId:data.iSourceId};data={sender:r,szmsgs:data.szmsg},this._notifytouser(o,n,data)},_notifytouser:function(e,t,n){this._session._callbackManager.dispatchCallback("notify",{code:e.getCode(),response:e,msg:t,content:n})}},jSW.SWSession.SwImModule=function(e,t,n){console.log("Construct Im Module"),this._session=e,this._confmanger=t,this._pusModules=n},jSW.SWSession.SwImModule.prototype={_swConfIMSend:function(e,n,o){var i;if((i=t.CheckOptions(n,e))!=jSW.RcCode.RC_CODE_S_OK)return i;!e._targetid&&e.targetid&&(e._targetid=e.targetid);for(var r=null,s=new proto.BVCU.IM_Msgs,a=null,l=null,_=-1,c=0;c<e.msgitems.length;c++)switch(a=e.msgitems[c],(l=s.addSzmsgs()).setItype(a.iType),_=a.iType,a.iType){case t.IMMSGTypes.TEXT:l.setSztextmsg(a.data);break;case t.IMMSGTypes.PICTURE:case t.IMMSGTypes.FILE:var u=new proto.BVCU.IM_File;u.setSzid(a.nruid),u.setSzfilepath(a.data),l.setStfile(u),r=e.pcallback}return i=t.SendRequest({session:this._session,msgtype:n,target:e._targetid,payload:s,targetIndex:-1,cmd:t.RequestHeader.confimsend.cmd,callback:e.callback,callbackrelay:r,tag:e.tag,_dhcb:o,_dhcbtag:_})},_SwConfFileRecv:function(e){return this._swConfIMSend(e,proto.WEBBVCU.MSGType.WEB_CONF_IM_FILE_MSG,this._dhcbConIMSend)},_swIMSend:function(e){return this._swConfIMSend(e,proto.WEBBVCU.MSGType.WEB_BVCU_CONF_IM_MSG,this._dhcbConIMSend)},_imOnNotify:function(e,t,n){var o=n.getTargetid();-1!=o.indexOf("CONF")?this._confmanger._onNotify(e,t,n):-1!=o.indexOf("PU")&&this._pusModules._onNotifyImMsg(e,t,n)},_imMsgProgress:function(e,t,n){var o=n.getTargetid();this._imAfterSendMsg(t.data,t.attchdata,o)},_imAfterSendMsg:function(e,t,n){var o=e.sEvent.szRemoteFilePath,i=e.sEvent.nruid;return this._swConfIMSend({msgitems:[{iType:t._dhcbtag,data:o,nruid:i}],callback:function(e,t,n){var o=e.tag.attchdata,i=e.tag.targetid,r=e.tag.data;(0,e.tag.callback)(i,o,r,t)},tag:{callback:this._imAfterSendRealMsgToDes,targetid:n,attchdata:t,data:e},_targetid:n},proto.WEBBVCU.MSGType.WEB_BVCU_CONF_IM_MSG,this._dhcbConIMSend)},_dhcbConIMSend:function(){},_imAfterSendRealMsgToDes:function(e,t,n,o){if(t&&"function"==typeof t.callback){t._dhcbtag,n.sEvent.szLocalFilePath;t.callback(t.options,o,n)}}},jSW.SWSession.prototype={_getWsDesUrl:function(e){var t="";if(o.CheckHttp())t="ws://"+o.url;else if(o.CheckOcx()){if(o.ocxWebsocketPort<=0)try{var n=document.getElementById("jsw_ocx");null!=n?o.ocxWebsocketPort=n.oxGetWebSocketPort():console.error("not found jsw_ocx")}catch(e){console.error("oxGetWebSocketPort fail "+e)}if(o.ocxWebsocketPort<=0)return void this._onWsError(e,"ocx not init or init fail");t="ws://127.0.0.1:"+o.ocxWebsocketPort,jSW._mMgr.bWsTest()&&(t="ws://127.0.0.1:8888")}return console.log("ws url: "+t),t},_checkWsCreateResult:function(t){if(null==this._ws)return console.error("http websoket error null"),void this._onWsError(t,e);this._onWsCreateOk(t),jSW._mMgr.oWsOpen(this._ws)},_onWsCreateOk:function(e){o.session_list.push(this);var n=this,i=e;console.log("websoket connect ..."),this._ws.onopen=function(){console.log("http websoket connect success!"),i.onopen&&"function"==typeof i.onopen&&i.onopen(n)},this._ws.onerror=function(e){n._ws=null,n._onWsError(i,e)},this._ws.onmessage=function(e){t.txOnResponse(-1,e.data)},this._ws.onclose=function(e){n._ws=null,console.log("http websoket connect closed:"+e.code+" reason: "+e.reason),n.swLogout(),i.onclose&&"function"==typeof i.onclose&&i.onclose(n,e)}},_onWsError:function(e,t){console.error("http websoket error"+t),e.onclose&&"function"==typeof e.onclose&&e.onclose(this,t)},swImSend:function(e){return o.calltype!=jSW.CallProtoType.OCX?(console.log("only support ocx"),jSW.RcCode.RC_CODE_E_BVCU_UNSUPPORTED):e.targetid&&-1!=e.targetid.indexOf("PU")?(e.msgitems=[{nruid:"NRU_",iType:t.IMMSGTypes.FILE,data:e.filepath}],this._immodule._swIMSend(e)):(console.log("target id invalidarg"),jSW.RcCode.RC_CODE_E_BVCU_INVALIDARG)},swImRecv:function(e){return o.calltype!=jSW.CallProtoType.OCX?(console.log("only support ocx"),jSW.RcCode.RC_CODE_E_BVCU_UNSUPPORTED):e.targetid&&-1!=e.targetid.indexOf("PU")?(e.msgitems=[{nruid:e.nruid,iType:t.IMMSGTypes.FILE,data:e.remotepath}],this._immodule._SwConfFileRecv(e)):(console.log("target id invalidarg"),jSW.RcCode.RC_CODE_E_BVCU_INVALIDARG)},swOpenFileInDir:function(e){if(o.calltype!=jSW.CallProtoType.OCX)return jSW.RcCode.RC_CODE_E_BVCU_UNSUPPORTED;if(jSW.CallProtoType.OCX!=o.calltype)return jSW.RcCode.RC_CODE_E_FAIL;var n=e.szFilePath;return t.SendRequest({session:this,msgtype:proto.WEBBVCU.MSGType.WEB_UTILS_OPEN_FILE_IN_DIR,payload:n,callback:e.callback,tag:e.tag})},_send:function(e){var t=this._ws;if(null==t)return console.error("websocket is null, current calltype "+(o.CheckOcx()?"ocx":"http")),jSW.RcCode.RC_CODE_E_DISCONNECTED;if(this._ws.OPEN||(this._ws.OPEN=1),t.readyState!=this._ws.OPEN)return console.warn("websocket not connection"),jSW.RcCode.RC_CODE_E_DISCONNECTED;if(this._bLogout)return jSW.RcCode.RC_CODE_E_BVCU_DISCONNECTED;try{return t.send(e),jSW.RcCode.RC_CODE_S_OK}catch(e){return jSW.RcCode.RC_CODE_E_DISCONNECTED}},swAddCallBack:function(e,t){return this._callbackManager.addCallback(e,t),jSW.RcCode.RC_CODE_S_OK},swGetVersion:function(e){var n=new proto.WEBBVCU.Request;return n.setMsgtype(proto.WEBBVCU.MSGType.WEB_GET_VERSION_INFO),n.setEmms(this._p_emms),t._internalSend({session:this,request:n,callback:e.callback,enforce:!0})},swLogin:function(e){e=n.extend({},{user:"admin",password:"123456"},e||{}),this._user=e.user;var o=new proto.WEBBVCU.Request;return o.setMsgtype(proto.WEBBVCU.MSGType.WEB_BVCU_GET_PUBKEY),o.setEmms(this._p_emms),t._internalSend({cmd:t.RequestHeader.pubkey.cmd,session:this,request:o,callback:function(n,o){n.tag,o.url;var i=n.request;if((a=n.session).p_options=n,a.p_response=o,o.getCode()==jSW.RcCode.RC_CODE_S_OK){var r=o.getPayload(),s=proto.WEBBVCU.PublicKey.deserializeBinary(r);this.pubkey_d=s.getD(),this.pubkey_n=s.getN();var a=n.session;(i=new proto.WEBBVCU.Request).setMsgtype(proto.WEBBVCU.MSGType.WEB_BVCU_LOGIN),i.setEmms(a._p_emms);var l=new proto.WEBBVCU.BVCU_LOGIN;l.setServer(a._server),l.setPort(Number(a._port)),l.setUser(a._user),l.setPassword(e.password),i.setPayload(l.serializeBinary()),t._internalSend({cmd:t.RequestHeader.login.cmd,session:a,request:i}),console.log("login info:"+a._server+":"+a._port+"user"+a._user)}}})},swLogout:function(){for(var e=0;e<this._arr_dialog.length;e++)this._arr_dialog[e].swClose();for(e=0;e<this._arr_pu.length;e++);this._arr_pu_index=[],this._arr_pu.splice(0,this._arr_pu.length),this._arr_dialog.splice(0,this._arr_dialog.length),this._timer_keeplive&&(clearInterval(this._timer_keeplive),this._timer_keeplive=null);var n=new t.JsonParamNoAttach(this._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_LOGOUT),i=t._internalSend({cmd:t.RequestHeader.logout.cmd,session:this,request:n}),r=o.session_list;e=0;for(e=0;e<r.length;e++)if(r[e]==this){o.session_list.splice(e,1),this._bLogout=!0;break}return null!=this._confManager&&this._confManager._clear(),clearInterval(this._timer_keeplive),i},swKeepLive:function(){t.RequestHeader.keeplive;var e=new t.JsonParamNoAttach(this._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_KEEPALIVE),n=t._internalSend({cmd:t.RequestHeader.keeplive.cmd,session:this,request:e});return console.log("keeplive session: "+this._server+" "+this._port),n},swGetPuList:function(e){return this._AutoReqSendProxy(e,{status:3,pagesize:0,page:0},function(e){var n=t.ParamPuList(e.status,e.pagesize,e.page);return{msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_PULIST,target:"CMS_",payload:n,cmd:t.RequestHeader.pulist.cmd}})},_onShouldGetPulist:function(e){return this._AutoReqSendProxy(e,{status:3,pagesize:0,page:0,sIndex:-1,iCount:-1},function(n){var o=t.ParamPuList(n.status,n.pagesize,n.page,e.sIndex,e.iCount);return{msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_PULIST,target:"CMS_",payload:o,cmd:t.RequestHeader.pulist.cmd}})},_innerNotifyIGotLoginInfo:function(){return this._AutoReqSendProxy({},{},function(e){return{msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_SESSION_GETPULIST}})},_innerOnGetCPI:function(e,t){var n={bCanGet:e.getBcanget(),iAlready:e.getIalreadycount(),iTotal:e.getItotalcount()};this._pulistLoadMgr.onGetCPI(n.bCanGet,n.iTotal,n.iAlready),t&&this._innerNotifyIGotLoginInfo()},_swAsyncGetPu:function(e){if(!e.szpuid||0==e.szpuid.length)return jSW.RcCode.RC_CODE_E_INVALIDARG;var t=this._AutoReqSendProxy(e,dft_options,function(e){return{msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_PUINFO_BY_PUID,target:e.szpuid}});return console.log("async get pu list"),t},_AutoReqSendProxy:function(e,o,i){o||(o={});jSW.RcCode.RC_CODE_E_FAIL;var r={session:this,msgtype:-1,target:"",targetIndex:-1,payload:null,cmd:"",callback:(e=n.extend({},o,e||{})).callback?e.callback:null,tag:e.tag?e.tag:null},s=i.bind(this)(e);return s=n.extend({},r,s||{}),t.SendRequest(s)},swSearch:function(e){return this._searchFile(e,"NRU_")},swDownFileFromNru:function(e){if(o.calltype!=jSW.CallProtoType.OCX)return alert("Just OCX support!!"),jSW.RcCode.RC_CODE_E_FAIL;return e=n.extend({},{pcallback:null},e||{}),this._swDownFileSearch({szRFP:e.remoteFilePath,szLFD:e.localFileDir,szTargetId:e.szNRUID,msgType:proto.WEBBVCU.MSGType.WEB_BVCU_DOWN_FILE_ONNRU,callback:e.callback,callbackrelay:e.pcallback,tag:e.tag})},_searchFile:function(e,o){var i={stSearchInfo:{iType:1,iPostition:0,iCount:50},stFilter:{szPUID:"",iChannelIndex:-1,iFileType:0,iTimeCondition:0,iTimeBegin:0,iTimeEnd:0,iFileSizeMin:0,iFileSizeMax:0,iRecordType:0,szDesc1:"",szDesc2:""},callback:null,tag:null};(e=n.extend({},i,e||{})).stSearchInfo=n.extend({},i.stSearchInfo,e.stSearchInfo||{}),e.stFilter=n.extend({},i.stFilter,e.stFilter||{});var r=t.ParamSearchList(e.stSearchInfo,e.stFilter);return t.SendRequest({cmd:t.RequestHeader.searchlist.cmd,session:this,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_SEARCH_LIST,target:o,payload:r,callback:e.callback,tag:e.tag})},swDelRecordFileFilter:function(e){var o={stFilter:{szPUID:"",iChannelIndex:-1,iFileType:0,iTimeCondition:0,iTimeBegin:0,iTimeEnd:0,iFileSizeMin:0,iFileSizeMax:0,iRecordType:0,szDesc1:"",szDesc2:""},callback:null,tag:null};(e=n.extend({},o,e||{})).stFilter=n.extend({},o.stFilter,e.stFilter||{});var i=function(e){var t=new proto.BVCU.NRUConfig.DeleteFileReq,n=new proto.BVCU.Search.Search_FileFilter;return n.setSzpuid(e.szPUID),n.setIchannelindex(e.iChannelindex),n.setIfiletype(e.iFileType),n.setItimebegin(e.iTimeBegin),n.setItimeend(e.iTimeEnd),n.setIfilesizemin(e.iFileSizeMin),n.setIfilesizemax(e.iFileSizeMax),n.setIrecordtype(e.iRecordType),n.setSzdesc1(e.szDesc1),n.setSzdesc2(e.szDesc2),n.setItimecondition(e.iTimeCondition),t.setItype(1),t.setIcount(1),t.addStfilefilters(n),t}(e.stFilter);return t.SendRequest({cmd:t.RequestHeader.recordfile_del.cmd,session:this,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_RECORDFILE_DELETE,payload:i,callback:e.callback,tag:e.tag})},swDelRecordFileFilterId:function(e){(e=n.extend({},{stFileIds:[],callback:null,tag:null},e||{})).stFileIds||(e.stFileIds=[]);var o=function(e){var t=new proto.BVCU.NRUConfig.DeleteFileReq;t.setItype(2);for(var n=0;n<e.length;n++){var o=new proto.BVCU.NRUConfig.FileID;o.setSzsourceid(e[n].nruid),o.addIrecordid(e[n].recordid),t.addStfileidfilters(o)}return t}(e.stFileIds);return t.SendRequest({cmd:t.RequestHeader.recordfile_del.cmd,session:this,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_RECORDFILE_DELETE,payload:o,callback:e.callback,tag:e.tag})},swSearchFileOnPu:function(e){return null==e||null==e.stFilter||null==e.stFilter.szPUID||0==e.stFilter.szPUID.length?(console.warn("bad args, please check!"),jSW.RcCode.RC_CODE_E_FAIL):this._searchFile(e,e.stFilter.szPUID)},swDownFileFromPu:function(e){if(o.calltype!=jSW.CallProtoType.OCX)return alert("Just OCX support!!"),jSW.RcCode.RC_CODE_E_FAIL;return e=n.extend({},{pcallback:null},e||{}),this._swDownFileSearch({szRFP:e.remoteFilePath,szLFD:e.localFileDir,szTargetId:e.szPUID,msgType:proto.WEBBVCU.MSGType.WEB_BVCU_DOWN_FILE_ONPU,callback:e.callback,callbackrelay:e.pcallback,tag:e.tag})},_swDownFileSearch:function(e){if(o.calltype!=jSW.CallProtoType.OCX)return alert("Just OCX support!!"),jSW.RcCode.RC_CODE_E_FAIL;if(null==e||null==e.szTargetId||0==e.szTargetId.length||null==e.szRFP||0==e.szRFP.length||null==e.szLFD||0==e.szLFD.length)return console.warn("bad args, please check!"),jSW.RcCode.RC_CODE_E_FAIL;var n=new proto.WEBBVCU.DownFileFromPu;return n.setSzremotefilepathname(e.szRFP),n.setSzlocalfilepathname(e.szLFD),t.SendRequest({session:this,msgtype:e.msgType,target:e.szTargetId,payload:n,callback:e.callback,callbackrelay:e.callbackrelay,tag:e.tag})},swSearchGps:function(e){if(o.calltype!=jSW.CallProtoType.OCX)return alert("Just OCX support!!"),jSW.RcCode.RC_CODE_E_FAIL;if(null==e.szNruId||0==e.szNruId.length)return console.warn("nruid should be invalid!"),jSW.RcCode.RC_CODE_E_FAIL;if(null==e.iTimeBegin||null==e.iTimeEnd)return console.warn("time slice should be invalid!"),jSW.RcCode.RC_CODE_E_FAIL;if(null==this._swGetPu(e.szPuid)||null==e.szPuid||0==e.szPuid.length)return console.warn("puid should be invalid!"),jSW.RcCode.RC_CODE_E_FAIL;if(e.iTimeBegin=Number(e.iTimeBegin),e.iTimeEnd=Number(e.iTimeEnd),e.iTimeBegin>=e.iTimeEnd)return console.warn("time slice should be invalid!"),jSW.RcCode.RC_CODE_E_FAIL;var n=new proto.WEBBVCU.RecordFileFilter;return n.setSzpuid(e.szPuid),n.setItimebegin(e.iTimeBegin),n.setItimeend(e.iTimeEnd),t.SendRequest({session:this,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_GPS_RECORD,target:e.szNruId,payload:n,callback:e.callback,tag:e.tag})},swGetGpsRecordData:function(e){if(o.calltype!=jSW.CallProtoType.OCX)return alert("Just OCX support!!"),jSW.RcCode.RC_CODE_E_FAIL;if(null==e.szNruId||0==e.szNruId.length)return console.warn("nruid should be invalid!"),jSW.RcCode.RC_CODE_E_FAIL;if(null==e.szFilePath||0==e.szFilePath.length)return console.warn("file path should be invalid!"),jSW.RcCode.RC_CODE_E_FAIL;var i=new proto.WEBBVCU.FTPFileInfo;return i.setSzfilepath(n.string2Uint8Array(e.szFilePath)),t.SendRequest({session:this,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_DOWNLOAD_GPS_RECORD,target:e.szNruId,payload:i,callback:e.callback,tag:e.tag})},swGetNruList:function(e){return t.SendRequest({session:this,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_NRU_LIST,callback:e.callback,tag:e.tag})},swGetRecordPlayer:function(e){for(var t=0;t<this._arr_record_play.length;t++)if(player=this._arr_record_play[t],player&&player._dialog_id==e)return player;return console.log("swGetRecordPlayer not found, dialogId: "+e),null},_swGetRecordPlayer:function(e){for(var t=0;t<this._arr_record_play.length;t++)if(player=this._arr_record_play[t],player&&player._player_id==e)return player;return console.log("_swGetRecordPlayer not found, playerId: "+e),null},_swDelRecordPlayer:function(e){for(var t=0;t<this._arr_record_play.length;t++)if(player=this._arr_record_play[t],player&&player._dialog_id==e)return this._arr_record_play[t]=null,!0;return!1},swRecordPlayCtrl:function(e){e=n.extend({},{cmdtype:"PLAY",dialogId:0,ntp_begin:-1,ntp_end:-1,scale:-1,callback:null,tag:null},e||{});var o=new proto.WEBBVCU.MSG_WEB_BVCU_RECORD_PLAY_CRTL;return o.setCmdtype(e.cmdtype),o.setDialogid(e.dialogId),o.setNtpBegin(e.ntp_begin),o.setNtpEnd(e.ntp_end),o.setScale(e.scale),t.SendRequest({session:this,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_RECORD_PLAY_CRTL,cmd:t.RequestHeader.recordplay.play.cmd,target:e.dialogId,payload:o,callback:e.callback,tag:e.tag})},swRecordPlay:function(e){if(o.calltype!=jSW.CallProtoType.OCX)return alert("Just support ocx Video!!"),jSW.RcCode.RC_CODE_E_BVCU_BADSTATE;if(null==(e=n.extend({},{url:null,nru:null,video:!0,audio:!0,callback:null,div:null,time_begin:-1,time_end:-1},e||{})).url||0==e.url.length)return console.error("url error: "+e.url),jSW.RcCode.RC_CODE_E_INVALIDARG;var i=null;"string"==typeof e.div&&(e.div=document.getElementById(e.div));var r=e.div;if(null==r)return console.error("no have div"),jSW.RcCode.RC_CODE_E_INVALIDARG;void 0===r.bv_uuid&&(r.bv_uuid=n.generateUUID());var s=null,a=r.bv_uuid+"_0077554",l=a+"tempdiv";if(null==(s=document.getElementById(a))){var _=document.getElementById(l),c=null;null==_&&((_=document.createElement("div")).id=a+"tempdiv",_.style.width="100%",_.style.height="calc(100% - 20px)",(c=document.createElement("div")).id=a+"tempdiv_playbar",c.style.width="100%",c.style.height="20px",c.style.backgroundColor="#555",_.databardiv=c),_.style.display="block",c=_.databardiv,r.appendChild(_),r.appendChild(c),(i=new jQuery.TigerPlayer).addBar($("#"+c.id),6e4,function(e){e.swPlay()},function(e){e.swPause()},function(e){e.swClose()},function(e,t){e.swJump({ntp_begin:t})}),(s=document.createElement("object")).id=a,s.classid="clsid:CDE6C639-4BA8-4A09-81EB-DCE76A61FE98",s.style.width="100%",s.style.height="100%",s.style.display="block",s.tag=this,_.appendChild(s),isNeedDelay=!0;var u=document.createElement("script");u.type="text/javascript",u.setAttribute("for",a),u.setAttribute("event","OnHwndEvent(hwnd, ieventtype, pParam)"),u.text="jSW._swOcxPlayerOnEvent(ieventtype, this.tag);",document.body.appendChild(u),s.data_player_bar=i}else i=s.data_player_bar,console.warn("have element : "+a);var d=this;return setTimeout(function(){!function(e,o,i,r,s){var a=n.generateUUID(),l=new proto.WEBBVCU.MSG_WEB_BVCU_RECORD_PLAY;if(l.setFilepath(o.url),l.setNruid(o.nru),l.setVideo(o.video?1:0),l.setAudio(o.audio?1:0),l.setStarttime(0),l.setEndtime(-1),l.setHwnd(0),l.setAutoplay(0),l.setPlayerId(a),null!=i?(l.setHwnd(i.GetWMHwnd()),i.style.display="block"):console.error("p_playObject is null"),t.SendRequest({session:e,payload:l,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_RECORD_PLAY,callback:o.callback,tag:o.tag})==jSW.RcCode.RC_CODE_S_OK){var _=new jSW.SWPlayer(e,{playerId:a,nruId:o.nru,file:o.url,dialogId:-1,parentDiv:r,time_begin:o.time_begin,time_end:o.time_end,bar:s,callback:o.closecallback,tag:o.closetag});e._arr_record_play.push(_)}}(d,e,s,r,i)},500),jSW.RcCode.RC_CODE_S_OK},swVodVideo:function(e){if(o.calltype==jSW.CallProtoType.OCX)return alert("Just Http support Vod Video!!"),jSW.RcCode.RC_CODE_E_BVCU_BADSTATE;if(null==(e=n.extend({},{url:null,callback:null,tag:null},e||{})).url||0==e.url.length)return console.error("url error: "+e.url),jSW.RcCode.RC_CODE_E_INVALIDARG;var i=e.tag;if(null==i)return console.error("no have div"),jSW.RcCode.RC_CODE_E_INVALIDARG;void 0===i.bv_uuid&&(i.bv_uuid=n.generateUUID());var r=i.bv_uuid+"_0077553";playObject=document.getElementById(r),null==playObject&&(playObject=document.createElement("VIDEO"),playObject.setAttribute("id",r),playObject.setAttribute("class","video-js vjs-default-skin vjs-big-play-centered"),playObject.style.width="100%",playObject.style.height="100%",playObject.style.display="block",i.appendChild(playObject)),-1!=e.url.indexOf(o.http)&&(e.url=e.url.substr(o.http.length+1));var s=t.RequestHeader.vod,a=new t.JsonParamCommand(this._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_SET_VOD,new t.BVCU_Command("",-1,null));return a.setPayload(n.string2Uint8Array(e.url)),t._internalSend({session:this,cmd:s.cmd,request:a,callback:e.callback,opt:e,tag:e.tag})},swVodVideoEx:function(e){var t=n.extend({},{callback:null,div:"",url:null},e||{});return null==t.url||0==t.url.length?(console.error("url error: "+t.url),jSW.RcCode.RC_CODE_E_INVALIDARG):"string"==typeof t.div&&(t.div=document.getElementById(t.div),null==t.div)?(console.error("no have div"),jSW.RcCode.RC_CODE_E_INVALIDARG):this.swVodVideo({url:t.url,tag:t.div,useoptions:t,callback:function(e,t){var n=e.tag,i=t.url;e.request;if(jSW.RcCode.RC_CODE_S_OK==t.getCode()){var r=n.bv_uuid+"_0077553";if(null==document.getElementById(r))return void console.error("not have player");videojs(r,{controlBar:!0,controls:!0},function(){strArr=i.split("."),2==strArr.length&&(strUrlFileType=strArr[1],"mp4"==strUrlFileType?this.src({type:"video/mp4",src:o.http+"/"+i}):"m3u8"==strUrlFileType&&this.src({type:"application/vnd.apple.mpegurl",src:o.http+"/"+i})),this.play()})}var s=e.opt;s&&s.useoptions&&"function"==typeof s.useoptions.callback&&s.useoptions.callback(s.useoptions,t)}})},swGetConfManager:function(){return o.calltype!=jSW.CallProtoType.OCX?(console.error("Just OCX support conference!!"),null):this._confManager},swGetUserManager:function(){return this._userManager},swGetPu:function(e){var t=this._swGetPu(e);return t||this._swAsyncGetPu({szpuid:e}),t},_swGetPu:function(e){var t=this._swGetPuFromArr(e,this._arr_pu);return-1==t?null:this._arr_pu[t]},_swGetPuFromArr:function(e,t){for(var n=0;n<t.length;n++)if(t[n]._id_pu==e)return n;return-1},_swCheckPuArr:function(e){var t=this._swGetPuFromArr(e._info_pu.id,this._arr_pu_offline),n=this._swGetPuFromArr(e._info_pu.id,this._arr_pu_online);0==e._info_pu.onlinestatus?-1==t&&-1!=n&&(this._arr_pu_online.splice(n,1),this._arr_pu_offline.push(e)):1==e._info_pu.onlinestatus&&-1!=t&&-1==n&&(this._arr_pu_offline.splice(n,1),this._arr_pu_online.push(e))},swGetPuChanel:function(e,t){var n=this._swGetPu(e);return n?n.swGetChanel(t):null},swGetPuDeviceInfo:function(e){return this._swGetPuOperation(e,proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_DEVICEINFO,t.RequestHeader.pucfg.getpudeviceinfo.cmd,this,null)},swSetPuDeviceInfo:function(e){dft_poptions={ilanguage:1,name:"default name"},e=n.extend({},dft_poptions,e||{});var o=new proto.BVCU.PUConfig.DeviceInfo;return o.setSzid(e.puid),o.setIlanguageindex(e.ilanguage),o.setSzname(e.name),o.setIputype(0),t.SendRequest({session:this,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_DEVICEINFO,cmd:t.RequestHeader.pucfg.getpudeviceinfo.cmd,target:e.puid,payload:o,callback:e.callback,tag:e.tag})},swGetPuDeviceTime:function(e){return this._swGetPuOperation(e,proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_DEVICETIME,t.RequestHeader.pucfg.getpudevicetime.cmd,this,null)},swGetPuEthernet:function(e){return this._swGetPuOperation(e,proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_ETHERNET,t.RequestHeader.pucfg.getpuethernet.cmd,this,null)},swGetPuRadioNetwork:function(e){return this._swGetPuOperation(e,proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_RADIONETWORK,t.RequestHeader.pucfg.getpuradionetwork.cmd,this,null)},swGetPuWifi:function(e){return this._swGetPuOperation(e,proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_WIFI,t.RequestHeader.pucfg.getpuwifi.cmd,this,null)},swGetPuPower:function(e){return this._swGetPuOperation(e,proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_POWER,t.RequestHeader.pucfg.getPuPower.cmd,this,null)},swGetPuOnlineControl:function(e){return this._swGetPuOperation(e,proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_ONLINECONTROL,t.RequestHeader.pucfg.getPuOnlineControl.cmd,this,null)},swGetPuUpdateStatus:function(e){return this._swGetPuOperation(e,proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_UPDATESTATUS,t.RequestHeader.pucfg.getPuUpdateStatus.cmd,this,null)},swGetPuLinkactionList:function(e){return this._swGetPuOperation(e,proto.WEBBVCU.MSGType.WEB_BVCU_GET_LINKACTION_LIST,t.RequestHeader.pucfg.getPuLinkactionList.cmd,this,null)},swGetLinkActionInfo:function(e){return this._swGetPuOperation(e,proto.WEBBVCU.MSGType.WEB_BVCU_GET_LINKACTION_LIST,t.RequestHeader.pucfg.getPuLinkactionList.cmd,this,e.linkactionbaseinfo)},swGetPuCarInfo:function(e){return this._swGetPuOperation(e,proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_CARINFO,t.RequestHeader.pucfg.getPuCarInfo.cmd,this,null)},swGetPuZfyInfo:function(e){return this._swGetPuOperation(e,proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_ZFYINFO,t.RequestHeader.pucfg.getPuZfyInfo.cmd,this,null)},swSetPuZfyInfo:function(e){dft_poptions={serial:"default",userno:"default",userame:"default",description:"default",unitno:"default",unitname:"default",defaultconference:""},e=n.extend({},dft_poptions,e||{});var o=new proto.BVCU.PUConfig.ZFYInfo;return o.setSzserial(e.serial),o.setSzuserno(e.userno),o.setSzusername(e.userame),o.setSzuserdescribe(e.description),o.setSzunitno(e.unitno),o.setSzunitname(e.unitname),o.setSzdefaultconference(e.defaultconference),t.SendRequest({session:this,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_ZFYINFO,cmd:t.RequestHeader.pucfg.setPuZfyInfo.cmd,target:e.puid,payload:o,callback:e.callback,tag:e.tag})},swGetPuServers:function(e){return this._swGetPuOperation(e,proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_SERVERS,t.RequestHeader.pucfg.getPuServers.cmd,this,null)},_swGetPuOperation:function(e,n,o,i,r){var s=t.JsonParamCommand(this._p_emms,n,t.BVCU_Command(e.puid,-1,r));return t._internalSend({cmd:o,session:i,request:s,callback:e.callback,tag:e.tag})},swLogQuery:function(e){return jSW.DependencyMgr.cmdParseInJect(function(){this._swLogQuery(e)},this)},_swLogQuery:function(e){e=n.extend({},{ipostition:0,icount:120,itimebegin:0,itimeend:0,username:"",targetid:"",itargetindex:-1,callback:null,tag:null},e||{});var o=new proto.BVCU.Search.Search_Request,i=new proto.BVCU.Search.SearchInfo;o.setStsearchinfo(i),i.setItype(t.SearchType.OPERATE),i.setIcount(Number(e.icount)),i.setIpostition(Number(e.ipostition));var r=new proto.BVCU.Search.Search_OperateLog;if(o.setStoperatefilter(r),r.setSzusername(e.username),r.setSztargetid(e.targetid),0!=e.itimebegin&&0!=e.itimeend&&e.itimeend<e.itimebegin)return console.error("get operate log utc time error please check!"),jSW.RcCode.RC_CODE_E_FAIL;r.setIoperatetime(e.itimebegin),r.setItimeend(e.itimeend);var s=Number(e.itargetindex);return null!=s&&s>=0&&r.setItargetindex(s),r.serializeBinary(),t.SendRequest({session:this,targetIndex:s,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_SEARCH_OPERATE,payload:o,callback:e.callback,tag:e.tag})},swDispose:function(){this._arr_pu_online.length>0&&(this._arr_pu_online.every(function(e,t,n){e._clear()}),this._arr_pu_online=[]),this._timer_keeplive&&clearInterval(this._timer_keeplive),this._ws&&(this._ws.onclose=null,this._ws.close(),console.log("close ws"))},compare:function(e){return this._server==e._server&&this._port==e._port&&this._user==e._user},_internalOnResponseFail:function(e,n,o){var i=e.cmd;e.param;console.error("internal error: "+i+o),i==t.RequestHeader.pubkey.cmd&&(i=t.RequestHeader.login.cmd)},_internalOnResponseSuccess:function(e,i,r){var s=e.cmd,a=e.request,l=(e.tag,i.getMsgtype()),_=i.getPayload(),c=a.getPayload(),u=i.getCode(),d=null;a.param={id:a.getTargetid(),major:a.getTargetindex(),targetid:a.getTargetid(),targetindex:a.getTargetindex(),hdlg:a.getHdlg()};try{if(l==proto.WEBBVCU.MSGType.WEB_GET_VERSION_INFO){if(n.debugLog("get version info",u),u==jSW.RcCode.RC_CODE_S_OK){var p=proto.WEBBVCU.VersionInfo.deserializeBinary(_);d={szprototype:p.getIprototype()==jSW.CallProtoType.OCX?"OCX":"HTTP",szversionid:t.HexToString(p.getSzversionid())}}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY)jSW.RcCode.RC_CODE_S_OK;else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PUBKEY){if(u==jSW.RcCode.RC_CODE_S_OK){var C=proto.WEBBVCU.PublicKey.deserializeBinary(_);this.pubkey_d=C.getD(),this.pubkey_n=C.getN(),d={pubkey_d:this.pubkey_d,pubkey_n:this.pubkey_n}}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_LOGIN)if(console.log("login"+(jSW.RcCode.RC_CODE_S_OK==u?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK){var g=proto.WEBBVCU.BVCU_Login_Response.deserializeBinary(_);this._serverConfig={keepliveinterval:g.getKeepliveinterval(),sessionidletime:g.getSessionidletime(),dialogidletime:g.getDialogidletime(),cryptokey:g.getCryptokey(),cryptoiv:g.getCryptoiv()},this._p_emms.setSession(g.getSession()),this._emms.session=g.getSession(),this._bLogout=!1,this._timer_keeplive&&clearInterval(this._timer_keeplive);var S=1e4;this._serverConfig&&this._serverConfig.keepliveinterval>5e3&&(S=this._serverConfig.keepliveinterval),S=3e4,this._timer_keeplive=setInterval(function(e){if(e._p_emms.getSession()&&e._p_emms.getSession().length>0)try{e.swKeepLive();for(var t=0;t<e._arr_dialog.length;t++)e._arr_dialog[t].swKeepLive();e._serverConfig&&e._serverConfig.keepliveinterval>5e3&&e._serverConfig.keepliveinterval}catch(e){console.error("-- keeplive -- error "+e)}else this._timer_keeplive&&clearInterval(this._timer_keeplive)},S,this),this._innerOnGetCPI(g.getStcpi(),!0)}else console.error("登录结果序列化失败:服务器也许不在线");else{if(l==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_SESSION_GETPULIST)return;if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PULIST){this._internalOnResponsePulist(i);var f=proto.WEBBVCU.BVCU_GetPulist.deserializeBinary(c).getStatus();3==f?d=this._arr_pu:2==f?d=this._arr_pu_offline:1==f&&(d=this._arr_pu_online)}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PUINFO_BY_PUID)this._internalOnResponsePulist(i);else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_KEEPALIVE)jSW.RcCode.RC_CODE_S_HTTP_HAVE_NOTIFY==u&&(this._internalOnResponsePulist(i),i.emms.code=jSW.RcCode.RC_CODE_S_OK,this._callbackManager.dispatchCallback(t.RequestHeader.pulist.cmd,{code:u,request:a,response:i,msg:""}));else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_OPEN_CHANLE||l==proto.WEBBVCU.MSGType.WEB_BVCU_OPEN_CHANLE_TSP){if(console.log("on open chanle, result"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),jSW.RcCode.RC_CODE_S_OK==u){for(var E=proto.WEBBVCU.BVCU_DialogParam.deserializeBinary(c),h=proto.WEBBVCU.Open_Dialog_Response.deserializeBinary(_).getHdlg(),m=this.swGetPuChanel(E.getId(),E.getMajor()),B=this._commDlgMgr.createAndSave(m,h),I=!1,O=0;O<this._arr_dialog.length;O++)m.compare(this._arr_dialog[O])&&(I=!0);0==I&&this._arr_dialog.push(m),d=B}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_CLOSE_CHANLE){if(console.log("on close chanle, result"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),jSW.RcCode.RC_CODE_S_OK==u)for(E=proto.WEBBVCU.BVCU_DialogParam.deserializeBinary(c),m=this.swGetPuChanel(E.getId(),E.getMajor()),O=0;O<this._arr_dialog.length;O++)if(m.compare(this._arr_dialog[O])){this._arr_dialog.splice(O,1);break}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PUGPSDATA){if(console.log("on get pugpsdata, result"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),jSW.RcCode.RC_CODE_S_OK==u){var y=proto.BVCU.PUConfig.GPSData.deserializeBinary(_);i.gps={lat:y.getIlatitude(),long:y.getIlongitude(),height:y.getIheight(),angle:y.getIangle(),speed:y.getIspeed(),starcount:y.getIstarcount(),antennastate:y.getBantennastate(),orientationstate:y.getBorientationstate(),satellitesignal:y.getIsatellitesignal(),sttime:t.Walltime2Json(y.getSttime())},d=i.gps,console.log("gps {lat:"+i.gps.lat+" long:"+i.gps.long+"}")}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_GPS){if(u==jSW.RcCode.RC_CODE_S_OK){var R=proto.BVCU.PUConfig.GPSParam.deserializeBinary(_),T={szname:R.getSzname(),isupportsatellitesignal:R.getIsupportsatellitesignal(),isetupsatellitesignal:R.getIsetupsatellitesignal(),benable:0!=R.getBenable(),ireportinterval:R.getIreportinterval(),ireportdistance:R.getIreportdistance()};gpsattrjsonresult={szname:T.szname,supportsatellitesignal:{isgps:(T.isupportsatellitesignal&jSW.SWPu.SATELLITE.GPS)==jSW.SWPu.SATELLITE.GPS,isbds:(T.isupportsatellitesignal&jSW.SWPu.SATELLITE.BDS)==jSW.SWPu.SATELLITE.BDS,isglonass:(T.isupportsatellitesignal&jSW.SWPu.SATELLITE.GLONASS)==jSW.SWPu.SATELLITE.GLONASS,isgalileo:(T.isupportsatellitesignal&jSW.SWPu.SATELLITE.GALILEO)==jSW.SWPu.SATELLITE.GALILEO,isqzss:(T.isupportsatellitesignal&jSW.SWPu.SATELLITE.QZSS)==jSW.SWPu.SATELLITE.QZSS},setupsatellitesignal:{isgps:(T.isetupsatellitesignal&jSW.SWPu.SATELLITE.GPS)==jSW.SWPu.SATELLITE.GPS,isbds:(T.isetupsatellitesignal&jSW.SWPu.SATELLITE.BDS)==jSW.SWPu.SATELLITE.BDS,isglonass:(T.isetupsatellitesignal&jSW.SWPu.SATELLITE.GLONASS)==jSW.SWPu.SATELLITE.GLONASS,isgalileo:(T.isetupsatellitesignal&jSW.SWPu.SATELLITE.GALILEO)==jSW.SWPu.SATELLITE.GALILEO,isqzss:(T.isetupsatellitesignal&jSW.SWPu.SATELLITE.QZSS)==jSW.SWPu.SATELLITE.QZSS},benable:T.benable,ireportinterval:T.ireportinterval,ireportdistance:T.ireportdistance},d=gpsattrjsonresult}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_SEARCH_LIST){console.log("search file list "+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed"));var U="NRU_"==(L=i.getTargetid()),W=proto.BVCU.Search.Search_Response.deserializeBinary(_);if(u==jSW.RcCode.RC_CODE_S_OK){d=[];var P=W.getStsearchinfo();d={info:{iPostition:P.getIpostition(),iCount:P.getIcount(),iTotalCount:P.getItotalcount()},content:[]};var D="",V=W.getPfileinfoList(),v=null,b=null,A=null;for(O=0;O<W.getStsearchinfo().getIcount();O++){v=(b=V[O]).getSzfilepath(),D=o.CheckNotOcx()&&U?o.http+"/"+n.FilterPath(v):v,A=n.PathParse(v);var M=b.getItimerecord();M>0x1f00000000000000&&(M=-1),d.content[O]={szPuid:A.szpuid,iChannelIndex:A.ichannelindex,szFilePath:D,szFilePathSrc:v,iRecordType:b.getIrecordtype(),iRecordID:b.getIrecordid(),iFileType:b.getIfiletype(),iFileSize:b.getIfilesize(),iTimeRecord:M,iTimeBegin:b.getItimebegin(),iTimeEnd:b.getItimeend(),szDesc1:b.getSzdesc1(),szDesc2:b.getSzdesc2(),szSourceID:b.getSzsourceid()},console.log(d.content[O].szFilePath)}}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_SEARCH_OPERATE){if(console.log("get operate log "+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed")),u==jSW.RcCode.RC_CODE_S_OK){W=proto.BVCU.Search.Search_Response.deserializeBinary(_);d=t.OperateSearchLogs2_Json(_)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_CONF_LIST){console.log("on get conf list, result"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed"));var N=proto.WEBBVCU.Conf_List_Response.deserializeBinary(_);if(u==jSW.RcCode.RC_CODE_S_OK){i.confList=[];var G=null;for(O=0;O<N.getSzconflistList().length;O++)G=null,null!=(G=N.getSzconflistList()[O])&&(i.confList[O]=jSW.SwConfManager._UTILS.confBaseInfoToLocalInfo(G));this._internalOnConfResponse(l,i.confList),d=i.confList}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_CONF_INFO||l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_CONF_CREATE){l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_CONF_CREATE?console.log("create conference: "+a.getTargetid()+" , result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed")):console.log("on get conf: "+a.getTargetid()+" info, result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed"));var w=proto.BVCU.ConfInfo.deserializeBinary(_);if(u==jSW.RcCode.RC_CODE_S_OK){i.confInfo={baseinfo:null,particulars:[],icreater:null};G=w.getBaseinfo();i.confInfo.baseinfo=jSW.SwConfManager._UTILS.confBaseInfoToLocalInfo(G);var F=w.getPparticipatorsList();for(O=0;O<F.length;O++)i.confInfo.particulars[O]=jSW.SwConfManager._UTILS.participatorToLocalUser(this,F[O]);i.confInfo.icreater=65535&w.getPcreator(),i.confInfo.icurrentuserindex=(4294901760&w.getPcreator())>>16,d=this._internalOnConfResponse(l,i.confInfo)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_CONF_DELETE){if(console.log("delete conf, result"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK){var L=a.getTargetid();this._internalOnConfResponse(l,L)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_ADD||l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_REMOVE){if(console.log(s+" result"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK){var k,j,z=proto.BVCU.ConfParticipatorAddResult.deserializeBinary(_).getIresultbitsList(),x=proto.WEBBVCU.Conf_Participator_ADD.deserializeBinary(a.getPayload());x=x.getSzparticcipatorList();var H={resultlist:[],targetid:null};H.targetid=a.getTargetid();for(var q=null,K=0;K<x.length;K++)k=K%32,j=z[K/32]>>>0<<k>>31-k==-1,q=jSW.SwConfManager._UTILS.participatorToLocalUser(this._confManager,x[K]),H.resultlist[K]={particular:q,result:j};this._internalOnConfResponse(l,H),d=H}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_START||l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_STOP){var Y=l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_START?" start":" stop";if(console.log("conf: "+a.getTargetid()+Y+", result"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK){L=a.getTargetid();this._internalOnConfResponse(l,{targetid:L,bIsStarted:l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_START})}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_APPLYFOR_STARTSPEAK||l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_APPLYFOR_ENDSPEAK){if(console.log("conf apply for, result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed")),u==jSW.RcCode.RC_CODE_S_OK){L=a.getTargetid();this._internalOnConfResponse(l,{targetid:L,bIsSpeak:l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_APPLYFOR_STARTSPEAK})}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_LEAVE||l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_RETURN){var J=l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_LEAVE?"leave":"return";if(console.log(J+"conf "+a.getTargetid()+", result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed")),u==jSW.RcCode.RC_CODE_S_OK){L=a.getTargetid();this._internalOnConfResponse(l,{targetid:L,bIsSpeak:l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_APPLYFOR_STARTSPEAK})}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_DEVICEINFO){J="get pu deviceinfo";if(console.log(J+"pu: "+a.getTargetid()+", result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed")),u==jSW.RcCode.RC_CODE_S_OK){var X=proto.BVCU.PUConfig.DeviceInfo.deserializeBinary(_);d={szID:X.getSzid(),szManufacturer:X.getSzmanufacturer(),szProductName:X.getSzproductname(),szSoftwareVersion:X.getSzsoftwareversion(),szHardwareVersion:X.getSzhardwareversion(),iPUType:X.getIputype(),languages:[],languageSelected:"",Ilanguageindex:X.getIlanguageindex(),szName:X.getSzname(),iWIFICount:X.getIwificount(),iRadioCount:X.getIradiocount(),iChannelCount:X.getIchannelcount(),iVideoInCount:X.getIvideoincount(),iAudioInCount:X.getIaudioincount(),iAudioOutCount:X.getIaudiooutcount(),iPTZCount:X.getIptzcount(),iSerialPortCount:X.getIserialportcount(),iAlertInCount:X.getIalertincount(),iAlertOutCount:X.getIalertoutcount(),iStorageCount:X.getIstoragecount(),iGPSCount:X.getIgpscount(),bSupportSMS:1==X.getBsupportsms(),iPresetCount:X.getIpresetcount(),iCruiseCount:X.getIcruisecount(),iAlarmLinkActionCount:X.getIalarmlinkactioncount(),iLongitude:X.getIlongitude(),iLatitude:X.getIlatitude(),szBluetoothAddr:X.getSzbluetoothaddr()};var Z="",Q=X.getIlanguageList();for(iLanguage in Q)Z=t.GetPuLanguageByIndex(Q[iLanguage]),d.languages.push(Z);d.languageSelected=t.GetPuLanguageByIndex(Q[d.Ilanguageindex])}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_DEVICEINFO){J="set pu deviceinfo";console.log(J+"pu: "+a.getTargetid()+", result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed"))}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_ETHERNET){J="get pu ethernet";if(console.log(J+"pu: "+a.getTargetid()+", result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed")),u==jSW.RcCode.RC_CODE_S_OK){var $=proto.BVCU.PUConfig.Ethernet.deserializeBinary(_);d={bDHCP:1==$.getBdhcp(),bPPPoE:1==$.getBpppoe(),bAutoDNS:1==$.getBautodns(),szIP:$.getSzip(),szNetMask:$.getSznetmask(),szGateway:$.getSzgateway(),szDNS:$.getSzdnsList(),szPPPoEUserName:$.getSzpppoeusername(),szPPPoEPassword:$.getSzpppoepassword(),iStatus:$.getIstatus()}}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_RADIONETWORK){J="get pu radionetwork";if(console.log(J+"pu: "+a.getTargetid()+", result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed")),u==jSW.RcCode.RC_CODE_S_OK){var ee=proto.BVCU.PUConfig.RadioNetworkAll.deserializeBinary(_).getStradionetworkList(),te=null;d=[];var ne=null,oe=null;for(radioindex in ee)oe=(ne=ee[radioindex]).getStlasttime(),te={bEnable:1==ne.getBenable(),iTypeAll:ne.getItypeallList(),iTypeIndex:ne.getItypeindex(),szModuleName:ne.getSzmodulename(),szUserName:ne.getSzusername(),szPassword:ne.getSzpassword(),szAPN:ne.getSzapn(),szAccessNum:ne.getSzaccessnum(),szCardNum:ne.getSzcardnum(),bOnline:1==ne.getBonline(),iSignalLevel:ne.getIsignallevelList(),iOnlineTime:ne.getIonlinetime(),iTrafficDownload:ne.getItrafficdownload(),iTrafficUpload:ne.getItrafficupload(),iSpeedDownload:ne.getIspeeddownload(),iSpeedUpload:ne.getIspeedupload(),iTrafficYear:ne.getItrafficyear(),iTrafficMonth:ne.getItrafficmonth(),iTrafficDay:ne.getItrafficday(),iTrafficLastTime:ne.getItrafficlasttime(),stLastTime:{iyear:oe.getIyear(),imonth:oe.getImonth(),iday:oe.getIday(),ihour:oe.getIhour(),iminute:oe.getIminute(),isecond:oe.getIsecond()},iMonthDay:ne.getImonthday(),bRebootAfterDialingFatalErr:1==ne.getBrebootafterdialingfatalerr()},d.push(te)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_WIFI){J="get pu wifi";console.log(J+"pu: "+a.getTargetid()+", result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed"));var ie=proto.BVCU.PUConfig.Wifi.deserializeBinary(_),re=ie.getStgeneral(),se=ie.getSthostspot(),ae=ie.getStwifiap();u==jSW.RcCode.RC_CODE_S_OK&&(d={bEnable:1==ie.getBenable(),iMode:ie.getImode(),iSignalLevel:ie.getIsignallevel(),stGeneral:{szSSID:re.getSzssid(),iSecurityType:re.getIsecuritytype(),iCryptType:re.getIcrypttype(),szWEPKey:re.getSzwepkeyList(),szWPAKey:re.getSzwpakey(),bDHCP:1==re.getBdhcp(),bPPPoE:1==re.getBpppoe(),bAutoDNS:1==re.getBautodns(),szIP:re.getSzip(),szNetMask:re.getSznetmask(),szGateway:re.getSzgateway(),szDNS:re.getSzdnsList(),iStatus:re.getIstatus()},stHostSpot:{szProviderAll:se.getSzproviderallList(),iProviderIndex:se.getIproviderindex(),szAreaAll:se.getSzareaallList(),iAreaIndex:se.getIareaindex(),szUserName:se.getSzusername(),szPassword:se.getSzpassword()},stWifiAP:{bEnable:1==ae.getBenable(),bHideSSID:1==ae.getBhidessid(),szSSID:ae.getSzssid(),iSafeType:ae.getIsafetype(),szPassWord:ae.getSzpassword(),iChannel:ae.getIchannel(),bAutoChannelSelect:1==ae.getBautochannelselect(),szIP:ae.getSzip(),szSubMark:ae.getSzsubmark(),bDHCP:1==ae.getBdhcp(),szDHCPStartAddr:ae.getSzdhcpstartaddr(),szDHCPEndAddr:ae.getSzdhcpendaddr()},szMacAddr:ie.getSzmacaddr()})}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_SERVERS){J="get pu servers";console.log(J+"pu: "+a.getTargetid()+", result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed"));var le=proto.BVCU.PUConfig.Servers.deserializeBinary(_),_e=le.getStregisterserver(),ce=le.getStupdateserver(),ue=le.getSttimesource(),de=le.getStddns(),pe=le.getStemailserver(),Ce=le.setStreserveserver();u==jSW.RcCode.RC_CODE_S_OK&&(d={stRegisterServer:{szAddr:_e.getSzaddr(),iPort:_e.getIport(),iProto:_e.getIproto(),iKeepAliveTimeout:_e.getIkeepalivetimeout(),szUserName:_e.getSzusername(),szPassword:_e.getSzpassword(),iStreamPathWay:_e.getIstreampathway()},stUpdateServer:{szAddr:ce.getSzaddr(),iPort:ce.getIport(),szUserName:ce.getSzusername(),szPassword:ce.getSzpassword(),iProto:ce.getIproto(),szPath:ce.getSzpath()},stTimeSource:{iTimeZone:ue.getItimezone(),bDST:1==ue.getBdst(),stNTPServer:ue.getStntpserver(),iNTP:ue.getIntp(),iGPS:ue.getIgps()},stDDNS:{bDDNS:1==de.getBddns(),szDDNSProvider:de.getSzddnsprovider(),szDDNSAddr:de.getSzddnsaddr(),szDDNSUserName:de.getSzddnsusername(),szDDNSPassword:de.getSzddnspassword(),szDynamicName:de.getSzdynamicname()},stEmailServer:{szServerAddr:null==pe?"":pe.getSzserveraddr(),iServerPort:null==pe?"":pe.getIserverport(),szUserName:null==pe?"":pe.getSzusername(),szPassword:null==pe?"":pe.getPassword(),szSenderAddr:null==pe?"":pe.getSzsenderaddr(),bSSLEnable:null==pe?"":pe.getBsslenable()},stReserveServer:{szAddr:null==Ce?"":Ce.getSzaddr(),iPort:null==Ce?"":Ce.getIport(),iProto:null==Ce?"":Ce.getIproto(),iKeepAliveTimeout:null==Ce?"":Ce.getIkeepalivetimeout(),szUserName:null==Ce?"":Ce.getSzusername(),szPassword:null==Ce?"":Ce.getSzpassword(),iStreamPathWay:null==Ce?"":Ce.getIstreampathway()}})}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_ONLINECONTROL){J="get pu onlinecontrol";console.log(J+"pu: "+a.getTargetid()+", result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed"));var ge=proto.BVCU.PUConfig.OnlineControl.deserializeBinary(_),Se=ge.getStweekList(),fe=ge.getStresms();u==jSW.RcCode.RC_CODE_S_OK&&(d={bPowerOnOnline:1==ge.getBpowerononline(),stWeek:{sunday:t.BVCU_DayTimeSlice_Pb2Json(Se[0]),monday:t.BVCU_DayTimeSlice_Pb2Json(Se[1]),tuesday:t.BVCU_DayTimeSlice_Pb2Json(Se[2]),wednesday:t.BVCU_DayTimeSlice_Pb2Json(Se[3]),thurday:t.BVCU_DayTimeSlice_Pb2Json(Se[4]),friday:t.BVCU_DayTimeSlice_Pb2Json(Se[5]),saturday:t.BVCU_DayTimeSlice_Pb2Json(Se[6])},stRESMS:{szCardNum:fe.getSzcardnumList(),szContent:fe.getSzcontent(),bReply:1==fe.getBreply()}})}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_POWER){J="get pu power";console.log(J+"pu: "+a.getTargetid()+", result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed"));var Ee=proto.BVCU.PUConfig.Power.deserializeBinary(_),he=Ee.getStturnon().getStweekList();u==jSW.RcCode.RC_CODE_S_OK&&(d={iTurnOffDelay:Ee.getIturnoffdelay(),bEnableTimer:1==Ee.getBenabletimer(),stTurnOn:{sunday:t.BVCU_DayTimeSlice_Pb2JsonOnly(he[0]),monday:t.BVCU_DayTimeSlice_Pb2JsonOnly(he[1]),tuesday:t.BVCU_DayTimeSlice_Pb2JsonOnly(he[2]),wednesday:t.BVCU_DayTimeSlice_Pb2JsonOnly(he[3]),thurday:t.BVCU_DayTimeSlice_Pb2JsonOnly(he[4]),friday:t.BVCU_DayTimeSlice_Pb2JsonOnly(he[5]),saturday:t.BVCU_DayTimeSlice_Pb2JsonOnly(he[6])},iBatteryPower:Ee.getIbatterypower(),iBatteryStatus:Ee.getIbatterystatus()})}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_ZFYINFO){J="get pu zfyinfo";console.log(J+"pu: "+a.getTargetid()+", result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed"));var me=proto.BVCU.PUConfig.ZFYInfo.deserializeBinary(_);u==jSW.RcCode.RC_CODE_S_OK&&(d={szDevModel:me.getSzdevmodel(),szIMEI_MEID:me.getSzimeiMeid(),szSerial:me.getSzserial(),szUserNo:me.getSzuserno(),szUserName:me.getSzusername(),szUserDescribe:me.getSzuserdescribe(),szUnitNo:me.getSzunitno(),szUnitName:me.getSzunitname(),szDefaultConference:me.getSzdefaultconference(),szCurrentConference:me.getSzcurrentconference()})}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_ZFYINFO){J="set pu zfyinfo";console.log(J+"pu: "+a.getTargetid()+"result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed"))}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_CARINFO){J="get pu carinfo";console.log(J+"pu: "+a.getTargetid()+"result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed"));var Be=proto.BVCU.PUConfig.CarInfo.deserializeBinary(_),Ie=Be.getStlicenceplate(),Oe=Be.getStdriverList();u==jSW.RcCode.RC_CODE_S_OK&&(d={stLicencePlate:{iCityID:null==Ie?"":Ie.getIcityid(),iColor:null==Ie?"":Ie.getIcolor(),iType:null==Ie?"":Ie.getItype(),szNumber:null==Ie?"":Ie.getSznumber(),szVAO:null==Ie?"":Ie.getSzvao()},stDriver:t.Drivers2Json(Oe),szVehicleType:Be.getSzvehicletype(),szVIN_EngineNo:Be.getSzvinEngineno(),szOwner:Be.getSzowner()})}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_GROUPLIST){J="get user grouplist";console.log(J+"pu: "+a.getTargetid()+"result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed"));var ye=proto.WEBBVCU.UserGroupList.deserializeBinary(_).getUsergroupsList(),Re=null,Te=null;if(d=[],u==jSW.RcCode.RC_CODE_S_OK)for(userGroupIndex in ye)Re=ye[userGroupIndex],Te=t.GroupPb_2Json(Re),d.push(Te)}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_GROUPINFO){J="get user groupinfo";if(console.log(J+": "+a.getTargetid()+"result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed")),u==jSW.RcCode.RC_CODE_S_OK){var Ue=proto.BVCU.UserConfig.UserGroupInfo.deserializeBinary(_);d=t.GroupInfoPb_2Json(Ue,this)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_USERLIST){J="get user userlist";console.log(J+"pu: "+a.getTargetid()+"result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed"));var We=proto.WEBBVCU.UserList.deserializeBinary(_).getUsersList();if(d=[],u==jSW.RcCode.RC_CODE_S_OK){var Pe=null,De=null;for(userIndex in We)Pe=We[userIndex],De=t.USER_USERPb_2Json(Pe),d.push(De)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_USERINFO){J="get user userinfo";if(console.log(J+"pu: "+a.getTargetid()+"result"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed")),u==jSW.RcCode.RC_CODE_S_OK){var Ve=proto.BVCU.UserConfig.UserInfo.deserializeBinary(_);d=t.USER_USERINFO_Pb2Json(Ve,this)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_ONLINE){console.log("on get online users, result"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed"));var ve=proto.WEBBVCU.Conf_OnlineUser_Response.deserializeBinary(_);if(u==jSW.RcCode.RC_CODE_S_OK){i.onlineUsers=[];var be=ve.getSzonlineuserList();for(O=0;O<ve.getSzonlineuserList().length;O++)i.onlineUsers[O]=jSW.SwConfManager._UTILS.onlineUserToLocal(be[O]);d=i.onlineUsers}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_ONLINEINFO){if(console.log("on get online users, result"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK){var Ae=proto.BVCU.UserConfig.UserOnlineInfo.deserializeBinary(_),Me=Ae.getStbase(),Ne=Ae.getPpudialogList(),Ge=null,we=null,Fe=null,Le=null,ke=null,je=[];for(dialogindex in Ne){for(channlIndex in Fe=[],(Ge=Ne[dialogindex]).getPdialogList())Le={ichannelindex:(we=channelpbs[channlIndex]).getIchannelindex(),istreamindex:we.getIstreamindex(),iavstreamdir:we.getIavstreamdir()},Fe.push(Le);ke={puid:Ge.getSzid(),channel:Fe},je.push(ke)}d={baseinfo:jSW.SwConfManager._UTILS.onlineUserToLocal(Me),ppudialog:je}}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_GPS)console.log("on set gps attr, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed"));else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_MANUALRECORD)console.log("on set pu manualrecord, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed"));else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_SNAPSHOT)console.log("on set pu snapshot, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed"));else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_LOCAL_RECORD){if(d={szPath:"",ifileleninseconds:-1},u==jSW.RcCode.RC_CODE_S_OK){var ze=proto.WEBBVCU.LocalStorage.deserializeBinary(_),xe=t.HexToString(ze.getDir()),He=ze.getIfileleninseconds();d={szPath:0==xe.length?"":xe,ifileleninseconds:0==xe.length?-1:He}}console.log("on get local record, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed"))}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_LOCAL_RECORD)console.log("on set local record, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed"));else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_SUBMETHOD_NRU_MANUALRECORD)console.log("on set nru record, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed"));else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_NRU_LIST){if(console.log("on get nru list, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK){var qe=proto.WEBBVCU.NRUList.deserializeBinary(_).getNrusList();d=[];var Ke=null,Ye=null;for(var Je in qe)Ke={szid:(Ye=qe[Je]).getSzid(),szname:Ye.getSzname(),istoragemediacount:Ye.getIstoragemediacount(),ionlinestatus:Ye.getIonlinestatus()},d.push(Ke)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_GPS_RECORD){if(console.log("on get gps record fileinfo, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK){var Xe=proto.WEBBVCU.FTPFileInfoList.deserializeBinary(_).getFileinfosList();d=[];Ke=null;var Ze=null;for(var Qe in Xe)Ze=Xe[Qe],Ke=t.FTPFileInfo2Json(Ze),d.push(Ke)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_DOWNLOAD_GPS_RECORD){if(console.log("on download gps record file, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK){var $e=proto.WEBBVCU.FTPFileInfoGPSInfo.deserializeBinary(_);d=t.FTPFileInfoGPSInfo2Json($e)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_VOD)console.log("on set vod, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),i.url="",u==jSW.RcCode.RC_CODE_S_OK&&(i.url=t.HexToString(_));else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_MODUSER)console.log("on mod user, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK&&null!=this._userManager&&this._userManager._onNotify(proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_MODUSER,i,c);else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_MODGROUP)console.log("on mod group, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK&&null!=this._userManager&&this._userManager._onNotify(proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_MODGROUP,i,c);else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_ADDGROUP)console.log("on add group, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK&&null!=this._userManager&&this._userManager._onNotify(proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_ADDGROUP,i,c);else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_ADDUSER)console.log("on add user, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK&&null!=this._userManager&&this._userManager._onNotify(proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_ADDUSER,i,c);else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_DELGROUP)console.log("on del group, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK&&null!=this._userManager&&this._userManager._onNotify(proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_DELGROUP,i,c);else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_DELUSER)console.log("on del user, result:"+(u==jSW.RcCode.RC_CODE_S_OK?" Ok":" Failed")),u==jSW.RcCode.RC_CODE_S_OK&&null!=this._userManager&&this._userManager._onNotify(proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_DELUSER,i,c);else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_MODPASSWD)n.consoleLog("on mod user pwd, result:",u);else if(l==proto.WEBBVCU.MSGType.WEB_VIDEO_DIALOG_ROTATE||l==proto.WEBBVCU.MSGType.WEB_VIDEO_DIALOG_STRETCH||l==proto.WEBBVCU.WEB_BVCU_SET_LOCAL_SNAPSHOT);else if(l==proto.WEBBVCU.MSGType.WEB_GET_CMS_DIALOGINFO){if(n.consoleLog("on get cms dialog info:",u),u==jSW.RcCode.RC_CODE_S_OK){var et=proto.WEBBVCU.CmsDialogInfoList.deserializeBinary(_);d=t.CmsDialogInfos2Json(et)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_OPEN_INTERCOM){n.consoleLog("on get open intercom:",u);E=a.param,m=this.swGetPuChanel(E.targetid,E.targetindex);if(u==jSW.RcCode.RC_CODE_S_OK){var tt=proto.WEBBVCU.CommonData.deserializeBinary(c).getIdata1();h=proto.WEBBVCU.CommonData.deserializeBinary(_).getIdata1();m.onIntercomOpenOk(!0,tt,h)}else m.onIntercomOpenOk(!1)}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_CLOSE_INTERCOM){n.consoleLog("on get close intercom:",u);E=a.param,m=this.swGetPuChanel(E.targetid,E.targetindex);if(u==jSW.RcCode.RC_CODE_S_OK){tt=proto.WEBBVCU.CommonData.deserializeBinary(c).getIdata1();m.onIntercomCloseOK(!0,tt)}else m.onIntercomCloseOK(!1)}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_ALTER_VIDEO_DIALOG_DIR){if(n.consoleLog("on get alert video dir:",u),u==jSW.RcCode.RC_CODE_S_OK){E=a.param,m=this.swGetPuChanel(E.targetid,E.targetindex),tt=proto.WEBBVCU.CommonData.deserializeBinary(c).getIdata1();m.onAlterMedirDirOk(!0,tt,E.hdlg)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_ALTER_AUDIO_DIALOG_DIR){if(n.consoleLog("on get alert video dir:",u),u==jSW.RcCode.RC_CODE_S_OK){E=a.param,m=this.swGetPuChanel(E.targetid,E.targetindex),tt=proto.WEBBVCU.CommonData.deserializeBinary(c).getIdata1();m.onAlterMedirDirOk(!1,tt,E.hdlg)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_ALTER_VIDEO_VOLUME){if(n.consoleLog("on set alert volume :",u),u==jSW.RcCode.RC_CODE_S_OK){E=a.param,m=this.swGetPuChanel(E.targetid,E.targetindex);var nt=proto.WEBBVCU.BVCU_DialogControlParam_Render.deserializeBinary(c),ot={icapture:nt.getIcapturevolume(),iplay:nt.getIplackbackvolume()};m.onAlterVolumeOk(ot)}}else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_RECORD_PLAY_RESPONSE)n.consoleLog("on open record play :",u),u==jSW.RcCode.RC_CODE_S_OK&&(record_player_res=proto.WEBBVCU.MSG_WEB_BVCU_RECORD_PLAY_RESPONSE.deserializeBinary(_),record_player=this._swGetRecordPlayer(record_player_res.getPlayerId()),record_player?(record_player._dialog_id=record_player_res.getDialogid(),console.log("record play, set dialog id: "+record_player._dialog_id)):console.warn("record play, not found by dialogId: "+record_player_res.getPlayerId()),d={playerId:record_player_res.getPlayerId(),id:record_player_res.getDialogid(),player:record_player});else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_RECORD_PLAY_CRTL_RESPONSE)n.consoleLog("on open record play crtl: ",u);else if(l==proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_REBOOT_OR_SHUTDOWN){n.consoleLog("on set pu shutdown or reboot :",u);E=a.param;var it=proto.WEBBVCU.PU_CONTROL.deserializeBinary(_);d={puid:E.targetid,ioption:it.getIoption()}}else l==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_IM_MSG&&(n.consoleLog("on send im msg :",u),d=proto.BVCU.IM_Msgs.deserializeBinary(c),d=t.IMMsgPb2_Json(d),this._confManager.onSendMsgGetResult(a.param.id,d))}}catch(e){console.log(e)}if(i.emms={code:u},e&&"function"==typeof e.callback&&e.callback(e,i,d),l==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PULIST){if(!this._pulistLoadMgr._checkBNotiCaller())return;console.log("get pu list"+(u==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed")),console.log("pulist count: "+this._arr_pu.length)}if(this._callbackManager.dispatchCallback(s,{code:u,request:a,response:i,msg:""}),jSW.RcCode.RC_CODE_S_OK!=u&&jSW.RcCode.RC_CODE_S_HTTP_HAVE_NOTIFY!=u){var rt="cmd: "+e.cmd+" fail "+jSW.RcCode.trans(u);console.error(rt),this._internalOnResponseFail(e,"",rt)}},_internalNotify:function(e,n){var o=n.getMsgtype(),i={target:null,targetindex:-1,content:null};if(o!=proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_SESSION_GETPULIST){if(o==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_DISCONNECT)return this._bLogout=!0,e.cmd=t.RequestHeader.logout,void this._callbackManager.dispatchCallback("logout",{code:n.getCode(),response:n,msg:e.cmd,content:i});if(o==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_PU_ONOFFLINE){e.cmd=t.RequestHeader.notifys.notify_pu_onoffline.cmd;var r=this._internalOnResponsePulist(n);null!=this._confManager&&this._confManager._onNotifyUserInfo(o,r);var s=r[0];i={onlinestatus:s._info_pu.onlinestatus,content:s}}else if(o==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_TSP_DATA){var a=proto.WEBBVCU.Notify_TSP_Data.deserializeBinary(n.getPayload());e.cmd=t.RequestHeader.notifys.notify_tsp_data.cmd;var l=a.getData();i={target:a.getTargetid(),targetindex:a.getTargetindex(),content:{hex:t.uint8ArrayToHexArray(l)}}}else if(o==proto.WEBBVCU.MSGType.WEB_BVCU_RECORD_PLAY_RESPONSE)record_play_res=proto.WEBBVCU.MSG_WEB_BVCU_RECORD_PLAY_RESPONSE.deserializeBinary(n.getPayload()),record_play_res&&(record_player=this.swGetRecordPlayer(record_play_res.getDialogid()),record_player?record_player._on_update_pts(record_play_res.getPts()):console.warn("record play, not found by dialogId_: "+record_play_res.getDialogid()));else if(o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_CONF_START||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_CONF_CREATE||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_CONF_DELETE||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_CONF_STOP||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_ADD||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_REMOVE||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_APPLYFOR_ENDSPEAK||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_APPLYFOR_STARTSPEAK||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_INVITE_SPEAK||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_TERMINATE_SPEAK||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_LEAVE||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_RETURN||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_MODIFY||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_JOIN||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_EXIT||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_BASEINFO){var _=null;switch(o){case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_CONF_CREATE:_=t.RequestHeader.confnotify.notifyconfcreate.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_CONF_START:_=t.RequestHeader.confnotify.notifyconfstart.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_CONF_DELETE:_=t.RequestHeader.confnotify.notifyconfdelete.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_CONF_STOP:_=t.RequestHeader.confnotify.notifyconfstop.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_ADD:_=t.RequestHeader.confnotify.notifyparticipartoradd.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_JOIN:_=t.RequestHeader.confnotify.notifyparticipartorjoin.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_REMOVE:_=t.RequestHeader.confnotify.notifyparticipartorremove.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_EXIT:_=t.RequestHeader.confnotify.notifyparticipartorexit.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_APPLYFOR_ENDSPEAK:_=t.RequestHeader.confnotify.notifyapplyforendspeak.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_APPLYFOR_STARTSPEAK:_=t.RequestHeader.confnotify.notifyapplyforstartspeak.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_INVITE_SPEAK:_=t.RequestHeader.confnotify.notifyinvitespeak.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_TERMINATE_SPEAK:_=t.RequestHeader.confnotify.notifyterminatespeak;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_LEAVE:_=t.RequestHeader.confnotify.notifyparticipartorleave;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_RETURN:_=t.RequestHeader.confnotify.notifyparticipartorreturn.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_MODIFY:_=t.RequestHeader.confnotify.notifyparticipatormodify.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_BASEINFO:_=t.RequestHeader.confnotify.notifybaseinfo.cmd}if(null!=this._confManager)return void this._confManager._onNotify(o,_,n)}else{if(o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_IM_MSG)return void(this._immodule&&(_=t.RequestHeader.confnotify.notifyimmsg.cmd,this._immodule._imOnNotify(o,_,n)));if(o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_USERLOGIN||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_USERLOGOUT)return void(null!=this._confManager&&this._confManager._onNotifyUserInfo(o,n));if(o==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_EVENT_SOURCE)e.cmd=t.RequestHeader.notifys.notify_event_source.cmd,i=t.EventSourcePb2_Json(n.getPayload());else if(o==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_ADDGROUP||o==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_ADDUSER||o==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_DELGROUP||o==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_DELUSER||o==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_MODGROUP||o==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_MODUSER){if(null!=this._userManager)return void this._userManager._onNotify(o,n,n.getPayload())}else{if(o==proto.WEBBVCU.MSGType.WEB_NOTIFY_BVCU_EVENT_STORAGE_FILE_OPEN||o==proto.WEBBVCU.MSGType.WEB_NOTIFY_BVCU_EVENT_STORAGE_FILE_CLOSE||o==proto.WEBBVCU.MSGType.WEB_NOTIFY_BVCU_EVENT_STORAGE_ERROR){var c=n.getTargetid(),u=n.getTargetindex(),d=this.swGetPuChanel(c,u),p=t.BVCU_EventStoragePb2_Json(n.getPayload());return d._notifyDialogEventStorage(o,p),void(o!=proto.WEBBVCU.MSGType.WEB_NOTIFY_BVCU_EVENT_STORAGE_FILE_CLOSE&&o!=proto.WEBBVCU.MSGType.WEB_NOTIFY_BVCU_EVENT_STORAGE_ERROR||console.log("本地录像 "+c+u+"录像"+p.szfilename+"结果"+(0==p.iresult?"Ok!":"faild!"+p.iresult)))}if(o==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_FILE_TRANS||o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_IM_MSG||o==proto.WEBBVCU.MSGType.WEB_CONF_IM_PIC_MSG||o==proto.WEBBVCU.MSGType.WEB_CONF_IM_FILE_MSG){e.cmd=t.RequestHeader.notifys.notify_down_from_pu.cmd,(i={sEvent:null,sProgressInfo:null}).sEvent=t.SWFileTransEventPb2_Json(n.getPayload()),jSW.FileTransEvent.FILE_TRANS_PROCESS==i.sEvent.iEvent&&(i.sProgressInfo=t.SWFileTransInfoPb2_Json(n.getPayload()));var C=n.getRelayid(),g=t.txGetRequestHelperOption(C);if(jSW.FileTransEvent.FILE_TRANS_CLOSE==i.sEvent.iEvent&&t.txSetRequestHelperOption(C,null),o==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_IM_MSG&&jSW.FileTransEvent.FILE_TRANS_CLOSE==i.sEvent.iEvent){var S=n.getCode();if(jSW.RcCode.RC_CODE_S_OK==S)return void(this._immodule&&this._immodule._imMsgProgress(o,{data:i,attchdata:g},n))}g&&"function"==typeof g.callback&&g.callback(g.options,n,i)}else if(o==proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_PU_OPENDIALOG_CMD){e.cmd=t.RequestHeader.notifys.notify_pu_apply_for_opening_dialog.cmd;var f=t.SWOpenDialogPb2_Json(n.getPayload());i.content=f}}}e&&"function"==typeof e.callback&&e.callback(e,n),this._callbackManager.dispatchCallback("notify",{code:n.getCode(),response:n,msg:e.cmd,content:i})}else{var E=proto.WEBBVCU.Current_Pulist_Info.deserializeBinary(n.getPayload());this._innerOnGetCPI(E)}},_internalOnResponsePulist:function(e){for(var t=e.getPayload(),n=proto.WEBBVCU.BVCU_GetPulist_Response.deserializeBinary(t).getPulistList(),o=[],i=0;i<n.length;i++){var r=n[i].getPubaseinfo().getSzid(),s=this._arr_pu_index[r];null==s?(1==(s=new jSW.SWPu(this,n[i]))._info_pu.onlinestatus?this._arr_pu_online.push(s):0==s._info_pu.onlinestatus&&this._arr_pu_offline.push(s),this._arr_pu.push(s),this._arr_pu_index[r]=s):(s._internalUpdate(n[i]),this._swCheckPuArr(s)),o.push(s)}return o},_internalOnResponseConfList:function(e){null!=this._confManager&&this._confManager._swFreshConflist&&this._confManager._swFreshConflist(e)},_internalOnConfResponse:function(e,t){switch(e){case proto.WEBBVCU.MSGType.WEB_BVCU_GET_CONF_LIST:null!=this._confManager&&this._confManager._swFreshConflist&&this._confManager._swFreshConflist(t);break;case proto.WEBBVCU.MSGType.WEB_BVCU_GET_CONF_INFO:case proto.WEBBVCU.MSGType.WEB_BVCU_SET_CONF_CREATE:return this._confManager._swFreshConfInfo(t);case proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_ONLINE:this._confManager._swFreshUserOnlielist(t);break;case proto.WEBBVCU.MSGType.WEB_BVCU_SET_CONF_DELETE:this._confManager._onConfDeletedOk(t);break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_ADD:case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_REMOVE:this._confManager._onParticularAddResult(t);break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_START:case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_STOP:this._confManager._onConfOpertaion(t);break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_APPLYFOR_STARTSPEAK:case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_APPLYFOR_ENDSPEAK:this._confManager._onApplyForSpeak(t)}}},jSW.SwUserManager=function(e){this._session=e},jSW.SwUserManager.SYSADMIN={NONE:0,GROUP:1,USER:4,DEV:16,DEVASS:64,ALL:85},jSW.SwUserManager.PERMISSIONS={OFF:0,ON:1},jSW.SwUserManager.DEFAULT={GROUP_GOD:"Admin",USER:"admin"},jSW.SwUserManager.Buffer=function(){this._Buffer_Strack=[]},jSW.SwUserManager.Buffer.prototype={_Buffer_Size:1024,_push:function(e){if(!this._is_id_exist(e.id)){for(;this._Buffer_Strack.length>this._Buffer_Size;){(e=this._Buffer_Strack.pop()).tag._clearinfo(e.tag)}this._Buffer_Strack.unshift(e)}},_is_id_exist:function(e){for(itemIndex in this._Buffer_Strack)if(this._Buffer_Strack[itemIndex].id==e)return!0;return!1}},jSW.SwUserManager.SwUser=function(e,t,n){this._session=e,this._user=t,this._group=n,this._userinfo=null},jSW.SwUserManager.SwUser.prototype={_static_buffer:new jSW.SwUserManager.Buffer,_clearinfo:function(e){e._userinfo=null},swGetUserInfo:function(e){return this._static_buffer._is_id_exist(this._user.id)?(setTimeout(e.callback,5,{tag:e.tag},{emms:{code:0}},this._userinfo),jSW.RcCode.RC_CODE_S_OK):this._innerGetUserInfo(e)},swGetGroup:function(){return this._group},swModUser:function(e){var t={info:{name:this._user.name,email:this._userinfo.email,phone:this._userinfo.phone,description:this._userinfo.description,groupid:this._group._group.id,sysadmin:{isGroup:this._userinfo.isGroup,isUser:this._userinfo.isUser,isDev:this._userinfo.isDev,isDevAss:this._userinfo.isDevAss},resources:this._userinfo.resources,iptz:this._userinfo.iptz},callback:null,tag:null};return(e=n.extend({},t,e||{})).info.sysadmin=n.extend({},t.info.sysadmin,e.info.sysadmin||{}),this._mod_user(e)},_mod_user:function(e){var n=new proto.BVCU.UserConfig.UserInfo,o=0;return o+=e.info.sysadmin.isGroup?jSW.SwUserManager.SYSADMIN.GROUP:jSW.SwUserManager.SYSADMIN.NONE,o+=e.info.sysadmin.isUser?jSW.SwUserManager.SYSADMIN.USER:jSW.SwUserManager.SYSADMIN.NONE,o+=e.info.sysadmin.isDev?jSW.SwUserManager.SYSADMIN.DEV:jSW.SwUserManager.SYSADMIN.NONE,o+=e.info.sysadmin.isDevAss?jSW.SwUserManager.SYSADMIN.DEVASS:jSW.SwUserManager.SYSADMIN.NONE,n.setSname(e.info.name),n.setSemail(e.info.email),n.setSphone(e.info.phone),n.setSdescription(e.info.description),n.setIsysadmin(o),n.setIptz(e.info.iptz),n.setSid(this._userinfo.id),n.setSallocateid(this._userinfo.allocateId),n.setSgroupid(e.info.groupid),t._LocalResource_2Pb(e.info.resources,n),t.SendRequest({session:this._session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_MODUSER,payload:n,callback:e.callback,tag:e.tag})},swModPwd:function(e){return e=n.extend({},{data:{password:"",newpassword:""},callback:null,tag:null},e||{}),this._mod_pwd(e)},_mod_pwd:function(e){var o=new proto.BVCU.UserConfig.ModPassword;return o.setSid(this._user.id),o.setSpassword(n.string2Uint8Array(e.data.password)),o.setSnewpassword(n.string2Uint8Array(e.data.newpassword)),t.SendRequest({session:this._session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_MODPASSWD,payload:o,callback:e.callback,tag:e.tag})},swDelUser:function(e){return this._del_user(e)},_del_user:function(e){var n=new proto.BVCU.UserConfig.User;return n.setSid(this._user.id),n.setSgroupid(this._user.groupid),t.SendRequest({session:this._session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_DELUSER,payload:n,callback:e.callback,tag:e.tag})},_fresh_user_info:function(e){this._userinfo={id:e.sId,passwd:e.sPasswd,bsetpasswd:e.bSetPasswd,sysadmin:{isGroup:e.sysadmin.isGroup,isUser:e.sysadmin.isUser,isDev:e.sysadmin.isDev,isDevAss:e.sysadmin.isDevAss},iptz:e.iPtz,serverid:e.sServerId,groupid:e.sGroupId,imaxsession:e.iMaxSession,allocateId:e.sAllocateId,name:e.sName,phone:e.sPhone,email:e.sEmail,description:e.sDescription,resources:e.Resource.concat()}},_getUserInfo:function(e){var n=new proto.BVCU.UserConfig.User;return n.setSid(e.userid),n.setSgroupid(e.groupid),t.SendRequest({session:this._session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_USERINFO,payload:n,callback:e.callback,tag:e.tag})},_innerGetUserInfo:function(e){return this._getUserInfo({userid:this._user.id,groupid:this._user.groupid,callback:this._innerOnGetUserInfo,tag:{user:this,option:e}})},_innerOnGetUserInfo:function(e,t,n){var o=e.tag,i=o.user,r=o.option;i._getGroupInfo({callback:i._innerhelpOnGetUserInfo,tag:{option:r,data:n,user:i}})},_innerhelpOnGetUserInfo:function(e,t,n){var o=e.tag,i=o.user,r=o.option,s=o.data;(i._fresh_user_info(s),jSW.SwUserManager._InitIUserHelp.iCount-=1,jSW.SwUserManager._InitIUserHelp.iCount<=0)&&i._session.swGetUserManager()._onInitOver();null!=r.callback&&"function"==typeof r.callback&&r.callback({tag:r.tag},{emms:{code:0}},i._userinfo),i._static_buffer._push({id:i._userinfo.id,tag:i})},_getGroupInfo:function(e){this._group.swGetGroupInfo(e)}},jSW.SwUserManager._InitIUserHelp={iCount:0},jSW.SwUserManager.SwGroup=function(e,t,n){this._session=e,this._group=t,this._userlist=[],this.groupinfo=null,this._groupinfo=null,null!=n&&(this._groupinfo=n,this.groupinfo=n)},jSW.SwUserManager.SwGroup.prototype={_static_groupinfo_buffer:new jSW.SwUserManager.Buffer,_clearinfo:function(e){e._groupinfo=null,e.groupinfo=null},_getGroupInfo:function(e){var n=new proto.BVCU.UserConfig.UserGroup;return n.setSid(this._group.id),t.SendRequest({session:this._session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_GROUPINFO,payload:n,callback:this._onGetGroupInfo,tag:{group:this,option:e}})},_resolve:function(){this.groupinfo={id:this._group.id,name:this._groupinfo.name,parentid:this._groupinfo.parentid,description:this._groupinfo.description,resources:this._groupinfo.resources.concat(),allresources:[]},this.groupinfo.id!=jSW.SwUserManager.DEFAULT.GROUP_GOD&&(this.groupinfo.allresources=t._GetAllRescources(this._session,this.groupinfo.resources))},_onGetGroupInfo:function(e,t,n){var o=e.tag,i=o.group;i._groupinfo=n,i._resolve();var r=o.option;null!=r.callback&&"function"==typeof r.callback&&r.callback({tag:r.tag},{emms:{code:0}},n),i._static_groupinfo_buffer._push({id:i._group.id,tag:i})},_groupSetFilter:function(){this.groupinfo.id=this._group.id,this.groupinfo.parentid=this._group.parentid},_mod_group:function(e){var n=new proto.BVCU.UserConfig.UserGroupInfo;return n.setSid(this._group.id),n.setSname(e.info.name),n.setSdescription(e.info.description),n.setSparentid(e.info.parentid),t._LocalResource_2Pb(e.info.resources,n),t.SendRequest({session:this._session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_MODGROUP,payload:n,callback:e.callback,tag:e.tag})},_del_group:function(e){var n=new proto.BVCU.UserConfig.UserGroup;return null==this._userlist?(console.warn("please get group info before delete it!"),jSW.RcCode.RC_CODE_E_FAIL):null!=this._userlist&&this._userlist.length>0?(console.warn("we can't delete the group because it contains more than 1 user!"),jSW.RcCode.RC_CODE_E_FAIL):(n.setSid(this._group.id),n.setSparentid(this._group.parentid),t.SendRequest({session:this._session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_DELGROUP,payload:n,callback:e.callback,tag:e.tag}))},_add_user:function(e){var o=new proto.BVCU.UserConfig.UserInfo,i=0;return i+=e.info.sysadmin.isGroup?jSW.SwUserManager.SYSADMIN.GROUP:jSW.SwUserManager.SYSADMIN.NONE,i+=e.info.sysadmin.isUser?jSW.SwUserManager.SYSADMIN.USER:jSW.SwUserManager.SYSADMIN.NONE,i+=e.info.sysadmin.isDev?jSW.SwUserManager.SYSADMIN.DEV:jSW.SwUserManager.SYSADMIN.NONE,i+=e.info.sysadmin.isDevAss?jSW.SwUserManager.SYSADMIN.DEVASS:jSW.SwUserManager.SYSADMIN.NONE,o.setSid(e.info.id),e.info.passwd.length>0&&e.info.passwd.length<64?o.setSpasswd(n.string2Uint8Array(e.info.passwd)):e.info.passwd.length>64&&console.log("the passwd you seted is out of range"),o.setSname(e.info.name),o.setSemail(e.info.email),o.setSphone(e.info.phone),o.setSdescription(e.info.description),o.setIsysadmin(i),o.setIptz(e.info.iptz),o.setSallocateid(e.info.allocateId),o.setSgroupid(this._group.id),t._LocalResource_2Pb(e.info.resources,o),t.SendRequest({session:this._session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_ADDUSER,payload:o,callback:e.callback,tag:e.tag})},_onGetUser:function(e){var t=null,n=!1;for(userIndex in this._userlist)if((t=this._userlist[userIndex])._user.id==e.id){t._user=e,n=!0;break}n||(t=this._local_add_user(e));this._session.swGetUserManager();return t},_local_add_user:function(e){var t=new jSW.SwUserManager.SwUser(this._session,e,this);return this._userlist.push(t),t},_on_notify_mod_user:function(e){var t=null,n=!1;for(userindex in this._userlist){(t=this._userlist[userindex])._user.id==e.sId&&(n=!0);break}if(n)t._fresh_user_info(e);else{var o={id:e.sId,groupid:e.sGroupId,name:e.Sname};(t=new jSW.SwUserManager.SwUser(this._session,o,this))._fresh_user_info(e),this._userlist.push(t)}return t},_on_notify_del_user:function(e){var t=null;for(userindex in this._userlist)if((t=this._userlist[userindex])._user.id==e._user.id){this._userlist.splice(userindex,1);break}return t},swAddUser:function(e){var t={info:{id:"",passwd:"",name:"",email:"",phone:"",description:"",groupid:this._group.id,sysadmin:{isGroup:!1,isUser:!1,isDev:!1,isDevAss:!1},resources:[]},callback:null,tag:null};return(e=n.extend({},t,e||{})).info=n.extend({},t.info,e.info||{}),this._add_user(e)},swGetUserList:function(e){return setTimeout(e.callback,5,{tag:e.tag},{emms:{code:jSW.RcCode.RC_CODE_S_OK}},this._userlist),jSW.RcCode.RC_CODE_S_OK},swGetUserById:function(e){var t=null;for(userIndex in this._userlist)if((t=this._userlist[userIndex])._user.id==e)return t;return null},swGetGroupInfo:function(e){return this._static_groupinfo_buffer._is_id_exist(this._group.id)?(setTimeout(e.callback,5,{tag:e.tag},{emms:{code:0}},this.groupinfo),jSW.RcCode.RC_CODE_S_OK):this._getGroupInfo(e)},swModGroup:function(e){var t={info:{name:this._group.name,description:this._groupinfo.description,parentid:this._groupinfo.parentid,resources:this._groupinfo.resources},callback:null,tag:null};return(e=n.extend({},t,e||{})).info=n.extend({},t.info,e.info||{}),this._mod_group(e)},swDelGroup:function(e){return this._del_group(e)}},jSW.SwUserManager.prototype={_session:null,_grouplist:[],_ondatachangedcallback:null,_initCallback:null,_usertag:null,_isInitOver:!1,_currentUser:null,_currentuserid:"",_getUserGroupList:function(e){var n=t.JsonParamCommand(this._session._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_GROUPLIST,t.BVCU_Command("",-1,null));return t._internalSend({cmd:t.RequestHeader.usercfg.getgrouplist.cmd,session:this._session,request:n,callback:e.callback,tag:e.tag})},_getUserList:function(e){return t.SendRequest({session:this._session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_USERLIST,callback:e.callback,tag:e.tag})},_innerGetUserList:function(){this._getUserList({callback:this._onGetUserList,tag:this})},_onGetUserList:function(e,t,n){var o=e.tag,i=null,r=null,s=null;for(userindex in jSW.SwUserManager._InitIUserHelp.iCount=n.length,n)i=n[userindex],null!=(r=o._getGroupById(i.groupid))&&(s=r._onGetUser(i))._user.id==o._currentuserid&&(o._currentUser=s);o._onInitOver()},_getGroupById:function(e){var t=null;for(groupindex in this._grouplist)if((t=this._grouplist[groupindex])._group.id==e)return t;return null},_getOnlineUsers:function(e){return t.SendRequest({session:this._session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_ONLINE,callback:e.callback,tag:e.tag})},_getOnlineUserInfo:function(e){var n=new proto.BVCU.UserConfig.UserOnline;return n.setSzdevid(e.devid),n.setSuserid(e.userid),n.setIapplierid(e.applierid),t.SendRequest({session:this._session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_ONLINEINFO,payload:n,callback:e.callback,tag:e.tag})},_add_group:function(e){var n=new proto.BVCU.UserConfig.UserGroupInfo;return n.setSid(e.info.id),n.setSname(e.info.name),n.setSdescription(e.info.description),n.setSparentid(e.info.parentid),t._LocalResource_2Pb(e.info.resources,n),t.SendRequest({session:this._session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_ADDGROUP,payload:n,callback:e.callback,tag:e.tag})},_kickout_user:function(e){var n=new proto.BVCU.UserConfig.Kickout;return t.SendRequest({session:this._session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_USER_KICKOUT,payload:n,callback:e.callback,tag:e.tag})},_onInitOver:function(e){this._isInitOver&&!e||(this._isInitOver=!0,this._initCallback({tag:this._usertag},{emms:{code:0}},null))},_add_group_to_local:function(e,t){var n=new jSW.SwUserManager.SwGroup(e,t);this._grouplist.push(n)},_on_notify_mod_group:function(e){var t=!1,n=null;for(groupIndex in this._grouplist)if((n=this._grouplist[groupIndex])._group.id==e.id){t=!0;break}if(t)n._groupinfo=e,n.groupinfo=e;else{var o={id:e.id,name:e.name,parentid:e.parentid};n=new jSW.SwUserManager.SwGroup(this._session,o,e),this._grouplist.push(n)}return n},_on_notify_del_group:function(e){var t=null,n=!1;for(groupindex in this._grouplist)if((t=this._grouplist[groupindex])._group.id==e.id){this._grouplist.splice(groupindex,1),n=!0;break}return n?t:null},_on_notify_mod_user:function(e){var t=null,n=null;for(groupIndex in this._grouplist)if((t=this._grouplist[groupIndex])._group.id==e.sGroupId){n=t._on_notify_mod_user(e);break}return n},_on_notify_del_user:function(e){var t=null;return null!=(t=this._getUserById(e.id))&&(t=t._group._on_notify_del_user(t)),t},onGetGroupList:function(e,t,n){var o=e.tag.userManager,i=null,r=null,s=!1;for(groupindex in n){for(localgroupindex in i=n[groupindex],o._grouplist)if(r=o._grouplist[localgroupindex],i.id==r._group.id){r._group=i,s=!0;break}s||o._add_group_to_local(this.session,i),s=!1}o._innerGetUserList()},_onNotify:function(e,n,o){if(this._isInitOver){var i=null,r="",s=null;switch(e){case proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_ADDGROUP:i=proto.BVCU.UserConfig.UserGroupInfo.deserializeBinary(o),i=t.GroupInfoPb_2Json(i,this._session),s=this._on_notify_mod_group(i),r=t.RequestHeader.usercfg.addgroup.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_MODGROUP:i=proto.BVCU.UserConfig.UserGroupInfo.deserializeBinary(o),i=t.GroupInfoPb_2Json(i,this._session),s=this._on_notify_mod_group(i),r=t.RequestHeader.usercfg.modgroupinfo.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_DELGROUP:i=proto.BVCU.UserConfig.UserGroup.deserializeBinary(o),i=t.GroupPb_2Json(i),s=this._on_notify_del_group(i),r=t.RequestHeader.usercfg.delgroup.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_ADDUSER:i=proto.BVCU.UserConfig.UserInfo.deserializeBinary(o),i=t.USER_USERINFO_Pb2Json(i,this._session),s=this._on_notify_mod_user(i),r=t.RequestHeader.usercfg.adduser.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_MODUSER:i=proto.BVCU.UserConfig.UserInfo.deserializeBinary(o),i=t.USER_USERINFO_Pb2Json(i,this._session),s=this._on_notify_mod_user(i),r=t.RequestHeader.usercfg.moduserinfo.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_USER_DELUSER:i=proto.BVCU.UserConfig.User.deserializeBinary(o),i=t.USER_USERPb_2Json(i),s=this._on_notify_del_user(i),r=t.RequestHeader.usercfg.deluser.cmd}""!=r&&this._ondatachangedcallback(this,{},{cmd:r,target:s})}},swGetCurrentUser:function(){return this._isInitOver?this._currentUser:(console.log("please call get info function after init over!!!!!"),null)},swInit:function(e){if(null!=e&&null!=e.ondatachanged&&null!=e.callback)return this._ondatachangedcallback=e.ondatachanged,this._initCallback=e.callback,this._isInitOver?(this._onInitOver(!0),jSW.RcCode.RC_CODE_S_OK):(this._currentuserid=this._session._user,this._isInitOver=!1,this._usertag=e.tag,this._getUserGroupList({callback:this.onGetGroupList,tag:{userManager:this,isInit:!0}}));console.log("options must be fill correctly! please try again")},swGetCurrentUserId:function(){return this._currentuserid},swGetGroupList:function(e){return this._isInitOver?(setTimeout(e.callback,5,{tag:e.tag},{emms:{code:jSW.RcCode.RC_CODE_S_OK}},this._grouplist),jSW.RcCode.RC_CODE_S_OK):(console.log("please call get info function after init over!!!!!"),null)},swGetGroupById:function(e){return this._getGroupById(e)},swGetUserById:function(e,t){var n=this.swGetGroupById(e);return null==n?null:n.swGetUserById(t)},_getUserById:function(e){var t=null;for(groupindex in this._grouplist)if(group=this._grouplist[groupindex],null!=group&&null!=(t=group.swGetUserById(e)))break;return t},swAddGroup:function(e){var t=n.extend({},{info:{name:"",description:"",parentid:"",resources:[]},callback:null,tag:null},e||{});return this._add_group(t)}},jSW.SwConfManager=function(e){this._parent=e},jSW.SwConfManager.MODE_SPEAK={DISCUSSIONGROUP:0,CHAIRMAN:1},jSW.SwConfManager.MODE_JOIN={INVITE:0,PASSWORD:16,FREE:32},jSW.SwConfManager.MODE_APPLY={NEEDAGREE:0,AUTOAGREE:128},jSW.SwConfManager.MODE_START={STOPADMIN:0,FOREVER:256},jSW.SwConfManager.STATUS={STOPPED:0,STARTED:1},jSW.SwConfManager.POWER={ADMIN:1,MODETATOR:2},jSW.SwConfManager._UTILS={participatorToLocalUser:function(e,t){return{id:t.getSzid(),name:t.getSzusername(),addr:t.getSzaddr(),applierid:t.getIapplierid(),pid:t.getIpid(),aliasname:t.getSzaliasname(),isonline:1==t.getIstatus()||2==t.getIstatus()||3==t.getIstatus(),isleave:1==(1&t.getIstatus()),isinseat:2==(2&t.getIstatus()),isSpeak:3==(3&t.getIstatus()),isadmin:(t.getIpower()&jSW.SwConfManager.POWER.ADMIN)==jSW.SwConfManager.POWER.ADMIN,ismodetator:(t.getIpower()&jSW.SwConfManager.POWER.MODETATOR)==jSW.SwConfManager.POWER.MODETATOR,volume:t.getIvolume()}},confBaseInfoToLocalInfo:function(e){return{name:e.getSzname(),id:e.getSzid(),password:e.getSzpassword(),bIsDiscussiongroup:0==(15&e.getImode()),bIsChairman:1==(15&e.getImode()),bIsInvite:0==(56&e.getImode()),bIsPassword:16==(56&e.getImode()),bIsFree:32==(56&e.getImode()),bAutoApply:128==(128&e.getImode()),bAutoStart:256==(256&e.getImode()),bIsStarted:e.getIconfstatus()==jSW.SwConfManager.STATUS.STARTED,bAudioRecord:1==e.getIrecordstatus(),szRecordNRUID:e.getSzrecordnruid(),_imode:e.getImode(),_istatus:e.getIconfstatus(),iTimeout:e.getItimeout()}},onlineUserToLocal:function(e){return{userid:e.getSuserid(),devid:e.getSzdevid(),addr:e.getSzaddr(),isonline:1==e.getIstatus(),iapplierid:e.getIapplierid(),year:e.getStlogintime().getIyear(),month:e.getStlogintime().getImonth(),day:e.getStlogintime().getIday(),hour:e.getStlogintime().getIhour(),minute:e.getStlogintime().getIminute(),second:e.getStlogintime().getIsecond()}}},jSW.SwConfManager.prototype={_parent:null,_conf_list:[],_conf_list_names:[],_user_online:[],_user_online_names:[],_ifocus:-1,_callbackManager:null,_callback:null,_watchCallBack:null,_clear:function(){this._conf_list=[],this._conf_list_names=[]},_swFocus:function(e){this._ifocus=e},_getOnlineUsers:function(e){var n=t.JsonParamCommand(this._parent._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_GET_USER_ONLINE,t.BVCU_Command("",-1,null));return t._internalSend({cmd:t.RequestHeader.getonuserlist.cmd,session:this._parent,request:n,callback:function(e,t,n){var o=e.tag;o.confManager._swFreshUserOnlielist(n),e.tag=o.option.tag,o.option.callback(e,t,n)},tag:{confManager:this,option:e}})},_onNotify:function(e,t,n){if(e!=proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_CONF_CREATE&&e!=proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_BASEINFO){var o=n.getTargetid();-1==o.indexOf("CONF_")&&(o=o.replace("CONF","CONF_"));l=this.swGetConfByConfId(o);if(proto.WEBBVCU.MSGType.WEB_BVCU_CONF_IM_MSG!=e)null!=l&&l._onNotify(e,t,n.getPayload());else{var i=t;l._imAfterSendMsg(i.data,i.attchdata)}}else{var r=[],s=proto.BVCU.ConfBaseInfo.deserializeBinary(n.getPayload()),a=jSW.SwConfManager._UTILS.confBaseInfoToLocalInfo(s);r.push(a),this._swFreshConflist(r);var l=this.swGetConfByConfId(a.id);this._dispatchCallback(l,t,a.id)}},onSendMsgGetResult:function(e,t){this.swGetConfByConfId(e)},_onNotifyUserInfo:function(e,t){if(e!=proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_PU_ONOFFLINE){var n=t.getPayload(),o=proto.BVCU.Event_Source.deserializeBinary(n);console.log("notify: user "+o.getSzid()+(e==proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_USERLOGIN?"login":"logout"));var i=null;for(r=0;r<this._conf_list_names.length;r++)null!=(i=this._conf_list[this._conf_list_names[r]])&&i._onNotify(e,"",o)}else for(var r=0;r<this._conf_list_names.length;r++)null!=(i=this._conf_list[this._conf_list_names[r]])&&i._onNotify(e,"",t)},_swFreshConflist:function(e){for(var t=0;t<e.length;t++)null==this._conf_list[e[t].id]?(this._conf_list[e[t].id]=new jSW.SWCONF(this._parent,e[t]),this._conf_list_names[t]=e[t].id):this._conf_list[e[t].id]._freshBaseInfo(e[t]);e.length>0&&this._swFocus(0)},_swFreshConfInfo:function(e){for(var t=!1,n=0;n<this._conf_list_names.length;n++)if(e.baseinfo.id==this._conf_list_names[n]){t=!0;break}return t||(this._conf_list[e.baseinfo.id]=new jSW.SWCONF(this._parent,e.baseinfo),this._conf_list_names[this._conf_list_names.length]=e.baseinfo.id),this._conf_list[e.baseinfo.id]._swFreshConfInfo(e),this._conf_list[e.baseinfo.id]},_swFreshUserOnlielist:function(e){this._user_online=[],this._user_online_names=[];for(var t=0;t<e.length;t++)this._user_online_names[t]=e[t].userid+e[t].iapplierid,this._user_online[this._user_online_names[t]]=e[t];var n=null;for(t=0;t<this._conf_list_names.length;t++)null!=(n=this._conf_list[this._conf_list_names[t]])&&n._swFreshFreeUsers(e,this._parent._arr_pu)},_swGetConfList:function(e){var n=t.JsonParamCommand(this._parent._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_GET_CONF_LIST,t.BVCU_Command("",-1,null));return t._internalSend({cmd:t.RequestHeader.getconflist.cmd,session:this._parent,request:n,callback:e.callback,tag:e.tag})},swInit:function(e){var t={callback:e.callback,session:this._parent,confMgr:this},n=this._swGetConfList({callback:function(e,t,n){if(0==n.length){t.emms.code;e.tag.callback(t.emms.code)}var o=e.tag.session,i=e.tag.confMgr,r=[],s=null;for(iindex in n)(s={}).id=n[iindex].id,s.bGeted=!1,r.push(s);var a=function(e){if(e.iCurrentIndex>=e.szInfoTemp.length)e.initcallback(jSW.RcCode.RC_CODE_S_OK);else{var t=e.szInfoTemp[e.iCurrentIndex],n=e.confMgr.swGetConfByConfId(t.id);if(n){var o={callback:e.onGetConfInfo,parent:e.session,targetId:t.id,tag:e};n._swGetConfInfo(o)!=jSW.RcCode.RC_CODE_S_OK&&(console.log("conf init, on get conf info error"),e.initcallback(jSW.RcCode.RC_CODE_E_NOTFOUND))}else e.toNextIndex(!0),l({tag:e},{emms:jSW.RcCode.RC_CODE_S_OK})}},l=function(e,t,n){var o=e.tag,i=t.emms.code;if(i!=jSW.RcCode.RC_CODE_S_OK)o.initcallback(i);else{var r=o;r.toNextIndex(!0),o.getconfinfo(r)}};a({session:o,szInfoTemp:r,iCurrentIndex:0,onGetConfInfo:l,confMgr:i,initcallback:e.tag.callback,getconfinfo:a,toNextIndex:function(e){this.szInfoTemp[this.iCurrentIndex].bGeted=e,this.iCurrentIndex++}})},tag:t});return console.log("conference manager init :"+(0==n?"success":"faild")),n},swGetConfList:function(){for(var e=[],t=null,n=0;n<this._conf_list_names.length;n++)t=this._conf_list[this._conf_list_names[n]],e.push(t);return e},swGetConfByConfId:function(e){return this._conf_list[e]},swCreateConf:function(e){var o={confbaseinfo:{name:"conf",speakmode:jSW.SwConfManager.MODE_SPEAK.CHAIRMAN,joinmode:jSW.SwConfManager.MODE_JOIN.INVITE,applyformode:jSW.SwConfManager.MODE_APPLY.AUTOAGREE,startmode:jSW.SwConfManager.MODE_START.FOREVER,password:"",bautorecord:!1,itimeout:0},callback:null};e=n.extend({},o,e||{});var i=new proto.BVCU.ConfBaseInfo;e.confbaseinfo.speakmode==jSW.SwConfManager.MODE_SPEAK.DISCUSSIONGROUP&&(console.warn("the conference speak mode DISCUSSIONGROUP No longer support!"),e.confbaseinfo.speakmode=jSW.SwConfManager.MODE_SPEAK.CHAIRMAN);var r=e.confbaseinfo.speakmode+e.confbaseinfo.joinmode+e.confbaseinfo.applyformode+e.confbaseinfo.startmode+(e.confbaseinfo.bautorecord?512:0);if(i.setImode(r),0==e.confbaseinfo.name.length)return console.warn("create conference name is empty, server will named automatically"),jSW.RcCode.RC_CODE_E_BVCU_INVALIDARG;i.setSzname(e.confbaseinfo.name),e.confbaseinfo.joinmode==jSW.SwConfManager.MODE_JOIN.PASSWORD&&i.setSzpassword(e.confbaseinfo.password),i.setItimeout(e.confbaseinfo.itimeout);var s=t.JsonParamCommand(this._parent._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_SET_CONF_CREATE,t.BVCU_Command("",-1,i));return t._internalSend({cmd:t.RequestHeader.createconf.cmd,session:this._parent,request:s,callback:e.callback,tag:e.tag})},swDeleteConf:function(e){e=n.extend({},{confid:"",callback:null},e||{});var o=t.JsonParamCommand(this._parent._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_SET_CONF_DELETE,t.BVCU_Command(e.confid,-1,null));return t._internalSend({cmd:t.RequestHeader.deleteconf.cmd,session:this._parent,request:o,callback:e.callback,tag:e.tag})},swRegConfWatch:function(e){return this._watchCallBack=e,n.debugLogInfo("Reg Conf Watch Ok!"),jSW.RcCode.RC_CODE_S_OK},_dispatchCallback:function(e,t,n){this._watchCallBack&&this._watchCallBack(this,t,{conf:e,data:n})},_onConfDeletedOk:function(e){for(var t=!1,n=0,o=0;o<this._conf_list_names.length;o++)if(this._conf_list_names[o]==e){n=o,t=!0;break}t&&(this._conf_list_names.splice(n,1),this._conf_list.splice(e,1))},_onParticularAddResult:function(e){var t=e.targetid;this.swGetConfByConfId(t)._swGetConfInfo({parent:this._parent,targetId:t})},_onConfOpertaion:function(e){var t=this.swGetConfByConfId(e.targetid);null==t&&console.warn("con't find conf"),t._onConStatusChange(e.bIsStarted)},_onApplyForSpeak:function(e){var t=this.swGetConfByConfId(e.targetid);null==t&&console.warn("con't find conf"),t._onCurrentUserSpeakChange(e.bIsSpeak)},_deleteConfByConfId:function(e){if(null==this.swGetConfByConfId(e));else for(var t=0;t<this._conf_list_names.length;t++)if(this._conf_list_names[t]==e)return this._conf_list_names.splice(t,1),this._conf_list.splice(e,1),this._conf_list[e]=null,void console.log("conf:"+e+"delete success")}},jSW.SWCONF_USER=function(e,t){this._parent=e,this._user_base_info=t},jSW.SWCONF_USER.prototype={_parent:null,_user_base_info:null,swGetUserInfo:function(){return this._user_base_info}},jSW.SWCONF=function(e,t){this._parent=e,this._conf_base_info=t,this._msg_storage=[]},jSW.SWCONF.prototype={_parent:null,_conf_base_info:null,_conf_particulars:[],_conf_creater:null,_free_users:[],_is_speak:!1,_speak_user:null,_conf_current_index:-1,id:null,__is_freshed:!1,_getConfInfoCbk:function(e){},_swFreshFreeUsers:function(e,n){this._free_users=[];for(var o=null,i=null,r=null,s=!1,a=0;a<e.length;a++){s=!1,i=e[a];for(var l=0;l<this._conf_particulars.length;l++)if(o=this._conf_particulars[l],t.JudgeIdType(o.id).bCu&&o.id==i.devid&&i.iapplierid==o.applierid){s=!0;break}s||(this._free_users[this._free_users.length]={id:i.devid,name:i.userid,applierid:i.iapplierid})}for(var _=0;_<n.length;_++)if(s=!1,null!=(r=n[_])&&null!=r._info_pu&&0!=r._info_pu.onlinestatus){for(l=0;l<this._conf_particulars.length;l++)if(o=this._conf_particulars[l],t.JudgeIdType(o.id).bPu&&o.id==r._id_pu){s=!0;break}s||(this._free_users[this._free_users.length]={id:r._info_pu.id,name:r._info_pu.name})}},_swFreshConfInfo:function(e){this._conf_base_info=e.baseinfo,this._conf_particulars=e.particulars,this._conf_creater=this._conf_particulars[e.icreater],this._conf_current_index=e.icurrentuserindex,this.__is_freshed=!0},_getCurrentUser:function(e){if(!this.__is_freshed)return console.log("please do init before call me"),null;var t=null;return-1!=this._conf_current_index&&(t=this._conf_particulars[this._conf_current_index]),t},_particularOperation:function(e,n,o){for(var i=new proto.WEBBVCU.Conf_Participator_ADD,r=null,s=null,a=0;a<e.users.length;a++){var l=e.users[a].id;s=e.users[a],t.JudgeIdType(l).bCu?null!=s&&((r=i.addSzparticcipator()).setSzid(l),r.setSzaddr(s.addr),r.setSzusername(s.name),r.setIapplierid(s.applierid),r.setIpid(s.pid)):t.JudgeIdType(l).bPu?((r=i.addSzparticcipator()).setSzid(l),r.setIpid(s.pid)):t.JudgeIdType(l).bUa?((r=i.addSzparticcipator()).setSzid(l),r.setIapplierid(s.applierid),r.setIpid(s.pid),r.setSzaddr(s.addr),r.setSzusername(s.name)):((r=i.addSzparticcipator()).setSzid(l),r.setSzusername(s.name),console.log("the participater to add is offline user")),this._conf_base_info.iMode==jSW.SwConfManager.MODE_SPEAK.DISCUSSIONGROUP?r.setIallowedmediadir(jSW.MEDIADIR.AUDIOSEND+jSW.MEDIADIR.AUDIORECV):this._conf_base_info.iMode==jSW.SwConfManager.MODE_SPEAK.CHAIRMAN&&r.setIallowedmediadir(jSW.MEDIADIR.AUDIORECV)}if(0!=i.getSzparticcipatorList().length){var _=t.JsonParamCommand(this._parent._p_emms,o,t.BVCU_Command(this._conf_base_info.id,-1,i));return t._internalSend({cmd:n,session:this._parent,request:_,callback:e.callback,tag:e.tag})}console.log("添加用户列表为空")},_confOpertion:function(e,n,o,i){var r=t.JsonParamCommand(this._parent._p_emms,o,t.BVCU_Command(this._conf_base_info.id,-1,i));return t._internalSend({cmd:n,session:this._parent,request:r,callback:e.callback,tag:e.tag})},_onConStatusChange:function(e){this._conf_base_info.bIsStarted=e},_onCurrentUserSpeakChange:function(e){this.swGetCurrentUser().isSpeak=e},_freshBaseInfo:function(e){this._conf_base_info=e},_dhcbConIMSend:function(e,t){},_onSendMsgGetResult:function(e,n){if(!(e[0].iType==t.IMMSGTypes.PICTURE&&n)){var o={confid:this._conf_base_info.id,sender:this._getCurrentUser(),szmsgs:e,bismine:!0};this._onGetImMsg(o)}},swConfIMSend:function(e){var t=this._parent._immodule;return e._targetid=this._conf_base_info.id,t._swConfIMSend(e,proto.WEBBVCU.MSGType.WEB_BVCU_CONF_IM_MSG,this._dhcbConIMSend)},SwConfFileRecv:function(e){return this._parent._immodule._swConfIMSend(e,proto.WEBBVCU.MSGType.WEB_CONF_IM_FILE_MSG,this._dhcbConIMSend)},_imAfterSendMsg:function(e,t){var n=e.sEvent.szRemoteFilePath;this.swConfIMSend({msgitems:[{iType:t._dhcbtag,data:n}],callback:function(e,t,n){var o=e.tag.attchdata,i=e.tag.conf,r=e.tag.data;if(o&&"function"==typeof o.callback){var s=[{iType:o._dhcbtag,stFile:{szID:"",szFile:r.sEvent.szLocalFilePath,iFileSize:0,iDuration:0}}];o.callback(o.options,t,r),i._onSendMsgGetResult(s,!1)}},tag:{conf:this,attchdata:t,data:e}})},_imAfteRecvPicMsg:function(e){var n=e.szmsgs[0],o={msgitems:[{iType:n.iType,data:n.stFile.szFile,nruid:n.stFile.szID}],callback:function(e,t,n){},pcallback:function(e,n,o){if(o.sEvent.iEvent==jSW.FileTransEvent.FILE_TRANS_CLOSE){var i=e.tag.data,r=e.tag.conf;i.szmsgs[0].stFile.szFile=o.sEvent.imgbase64,r._onGetImMsg(i);var s=t.RequestHeader.confnotify.notifyimmsg.cmd;r._parent._confManager._dispatchCallback(r,s,i)}},tag:{conf:this,data:e}};return this._parent._immodule._swConfIMSend(o,proto.WEBBVCU.MSGType.WEB_CONF_IM_PIC_MSG,this._dhcbConIMSend)},swGetOnlineUsers:function(e){return this._parent._confManager._getOnlineUsers({callback:function(e,o,i){var r=e.tag;console.log("可翻牌的用户或设备:"+n.getJsonString(r.tag._free_users));var s=t.BuildEventOptions(null,null,null,r.optionstag);r.callback(s,o,r.tag._free_users)},tag:{callback:e.callback,tag:this,optionstag:e.tag}})},swGetCurrentUser:function(){return this.__is_freshed?this._conf_current_index<0?null:this._conf_particulars[this._conf_current_index]:(console.warn("please get conf details info first"),null)},_swGetConfInfo:function(e){null==e&&(e={});var n=null==e.parent?this._parent:e.parent,o=null==e.targetId?this._conf_base_info.id:e.targetId;return e.callback=null==e.callback?function(){}:e.callback,t.SendRequest({session:n,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_CONF_INFO,target:o,targetIndex:-1,cmd:t.RequestHeader.getconfinfo.cmd,callback:e.callback,tag:e.tag})},swSetConfAudioRecord:function(e){if(this._conf_base_info.bAudioRecord==e.bRecord&&this._conf_base_info.szRecordNRUID==e.szNruId)return setTimeout(function(e){e.callback({tag:e.tag},{emms:{code:jSW.RcCode.RC_CODE_S_OK}})},50,e),jSW.RcCode.RC_CODE_S_OK;var n=new proto.BVCU.ConfBaseInfo;n.setSzid(this._conf_base_info.id),n.setImode(this._conf_base_info._imode),n.setSzname(this._conf_base_info.name),e.bRecord?n.setSzrecordnruid(e.szNruId):n.setSzrecordnruid("");var o=this._conf_base_info.id;return t.SendRequest({session:this._parent,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_CONF_ALTER_AUDIO_RECORD_STATUS,target:o,targetIndex:-1,payload:n,cmd:t.RequestHeader.confaudiorecord.cmd,callback:e.callback,tag:e.tag})},_swGetParticipatorByNecessaryInfo:function(e){for(var t=null,n=0;n<this._conf_particulars.length;n++)if((t=this._conf_particulars[n]).id==e.id&&t.applierid==e.applierid&&t.pid==e.pid)return t;return null},swGetConfInfo:function(){return this._conf_base_info},swParticipatorRemove:function(e){var n,o;for(o=0;o<e.users.length;o++)null!=(n=this._swGetParticipatorByNecessaryInfo(e.users[o]))?t.JudgeIdType(n.id).bCu?n.id==this._conf_creater.id&&n.iapplierid==this._conf_creater.applierid&&(e.users.splice(o,1),console.warn("id:"+n.id+",name:"+n.name+"是创建者 移除该用户操作取消")):t.JudgeIdType(n.id).bPu?n.id==this._conf_creater.id&&(e.users.splice(o,1),console.warn("id:"+n.id+",name:"+n.name+"是创建者 移除该用户操作取消")):t.JudgeIdType(n.id).bUa&&n.id==this._conf_creater.id&&(e.users.splice(o,1),console.warn("id:"+n.id+",name:"+n.name+"是创建者 移除该用户操作取消")):console.warn(n.id+"not found");return e.users.length<=0?(console.warn("删除会议成员为空"),jSW.RcCode.RC_CODE_E_FAIL):this._particularOperation(e,t.RequestHeader.particularremove.cmd,proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_REMOVE)},swParticipatorAdd:function(e){return this._particularOperation(e,t.RequestHeader.particularadd.cmd,proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_ADD)},swGetParticularList:function(e){if(!this.__is_freshed)return console.warn("please get conf info first"),jSW.RcCode.RC_CODE_E_FAIL;var n=t.BuildEventOptions(null,null,this._parent._parent,e.tag),o=t.BuildResponse(jSW.RcCode.RC_CODE_S_OK,null);return setTimeout(e.callback,50,n,o,this._conf_particulars),jSW.RcCode.RC_CODE_S_OK},swConfStart:function(e){return this._conf_base_info.bIsStarted?(console.warn("conf is started"),jSW.RcCode.RC_CODE_E_FAIL):this._confOpertion(e,t.RequestHeader.confstart.cmd,proto.WEBBVCU.MSGType.WEB_BVCU_CONF_START)},swConfStop:function(e){return this._conf_base_info.bIsStarted?this._confOpertion(e,t.RequestHeader.confend.cmd,proto.WEBBVCU.MSGType.WEB_BVCU_CONF_STOP):(console.warn("conf is not started"),jSW.RcCode.RC_CODE_E_FAIL)},swApplyForSpeak:function(e){return this._conf_base_info.bIsChairman?this._is_speak?(console.warn("you are speaking, so you need not apply for one again"),jSW.RcCode.RC_CODE_E_FAIL):this._conf_base_info.bIsStarted?this._confOpertion(e,t.RequestHeader.applyforspeak.cmd,proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_APPLYFOR_STARTSPEAK):(console.warn("the conference you apply for speak is not started !"),jSW.RcCode.RC_CODE_E_FAIL):(console.warn("current conf mode not support apply for speak"),jSW.RcCode.RC_CODE_E_FAIL)},swApplyForEndSpeak:function(e){if(!this._conf_base_info.bIsChairman)return console.warn("current conf mode not support apply for speak"),jSW.RcCode.RC_CODE_E_FAIL;var n=this._getCurrentUser();return null!=n&&n.isSpeak?this._confOpertion(e,t.RequestHeader.applyforendspeak.cmd,proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_APPLYFOR_ENDSPEAK):(console.warn("no speak shoud be end that you are not speaking"),jSW.RcCode.RC_CODE_E_FAIL)},swInviteSpeak:function(e){if(!this._conf_base_info.bIsChairman)return console.warn("current conf mode not support invite speak"),jSW.RcCode.RC_CODE_E_FAIL;if(null==e.user)return console.warn("invite args error"),jSW.RcCode.RC_CODE_E_FAIL;var n,o=e.user.id;if(null==(n=this._swGetParticipatorByNecessaryInfo(e.user)))return console.warn("Participator you invited not exist!"),jSW.RcCode.RC_CODE_E_FAIL;if(!n.isonline)return console.warn("Participator you invited not in conference!"),jSW.RcCode.RC_CODE_E_FAIL;if(n.isSpeak)return console.warn("Participator you invited is speaking!"),jSW.RcCode.RC_CODE_E_FAIL;var i=new proto.BVCU.ConfParticipatorInfo;if(t.JudgeIdType(o).bCu)null!=n&&(i.setSzid(o),i.setSzusername(n.name),i.setIapplierid(n.applierid),i.setIpid(n.pid));else{if(!t.JudgeIdType(o).bPu)return console.error("语音会议添加用户 用户信息有问题"),jSW.RcCode.RC_CODE_E_FAIL;i.setSzid(o),i.setIapplierid(n.applierid),i.setIpid(n.pid)}var r=t.JsonParamCommand(this._parent._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_INVITE_SPEAK,t.BVCU_Command(this._conf_base_info.id,-1,i));return t._internalSend({cmd:t.RequestHeader.invitespeak.cmd,session:this._parent,request:r,callback:e.callback,tag:e.tag})},swTerminalSpeak:function(e){if(!this._conf_base_info.bIsChairman)return console.warn("current conf mode not support invite speak"),jSW.RcCode.RC_CODE_E_FAIL;if(null==e.user)return console.warn("terminate args error"),jSW.RcCode.RC_CODE_E_FAIL;var n,o=e.user.id;if(null==(n=this._swGetParticipatorByNecessaryInfo(e.user)))return console.warn("Participator you invited not exist!"),jSW.RcCode.RC_CODE_E_FAIL;if(!n.isonline||!n.isinseat)return console.warn("Participator you invited not in conference!"),jSW.RcCode.RC_CODE_E_FAIL;if(!n.isSpeak)return console.warn("Participator you invited is not speaking!"),jSW.RcCode.RC_CODE_E_FAIL;var i=new proto.BVCU.ConfParticipatorInfo;if(t.JudgeIdType(o).bCu)null!=n&&(i.setSzid(o),i.setSzusername(n.name),i.setIapplierid(n.applierid),i.setIpid(n.pid));else{if(!t.JudgeIdType(o).bPu)return console.error("语音会议添加用户 用户信息有问题"),jSW.RcCode.RC_CODE_E_FAIL;i.setSzid(o),i.setIapplierid(n.applierid),i.setIpid(n.pid)}var r=t.JsonParamCommand(this._parent._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_PARTICIPATOR_TERMINATE_SPEAK,t.BVCU_Command(this._conf_base_info.id,-1,i));return t._internalSend({cmd:t.RequestHeader.terminalspeak.cmd,session:this._parent,request:r,callback:e.callback,tag:e.tag})},swParticipatorLeave:function(e){if(this._conf_base_info.bIsStarted){var n=this.swGetCurrentUser();return null==n?jSW.RcCode.RC_CODE_E_FAIL:n.isinseat?this._confOpertion(e,t.RequestHeader.confleave.cmd,proto.WEBBVCU.MSGType.WEB_BVCU_CONF_LEAVE):(console.warn("currentUser never inseat :"+this._conf_base_info.id+", need not do leave"),jSW.RcCode.RC_CODE_S_OK)}return console.log("conf:"+this._conf_base_info.id+" not started , so can not do return"),jSW.RcCode.RC_CODE_E_FAIL},swParticipatorReturn:function(e){if(this._conf_base_info.bIsStarted){var n=this.swGetCurrentUser();if(null==n)return jSW.RcCode.RC_CODE_E_FAIL;if(!n.isleave)return console.warn("currentUser never leave :"+this._conf_base_info.id+", need not do return"),jSW.RcCode.RC_CODE_E_FAIL;var o=new proto.BVCU.ConfParticipatorInfo;return o.setIapplierid(n.applierid),o.setIpid(n.pid),o.setSzid(n.id),o.setSzusername(n.name),o.setSzaddr(n.addr),o.setIallowedmediadir(n.allowedmediadir),this._confOpertion(e,t.RequestHeader.confreturn.cmd,proto.WEBBVCU.MSGType.WEB_BVCU_CONF_RETURN,o)}return console.log("conf:"+this._conf_base_info.id+" not started , so can not do return"),jSW.RcCode.RC_CODE_E_FAIL},_addParticipators:function(e){for(var t=0;t<e.length;t++)this._conf_particulars[this._conf_particulars.length]=e[t]},_removeParticipator:function(e){for(var n,o=0;o<e.length;o++){participator=e[o];for(var i=0;i<this._conf_particulars.length;i++)if(n=this._conf_particulars[i],t.JudgeIdType(participator.id).bPu){if(participator.id==n.id)return this._conf_particulars.splice(i,1),void console.log("delete conf user success")}else if(t.JudgeIdType(participator.id).bCu){if(participator.id==n.id&&participator.applierid==n.applierid&&participator.name==n.name)return this._conf_particulars.splice(i,1),void console.log("delete conf user success")}else if(t.JudgeIdType(participator.id).bUa&&participator.id==n.id&&participator.name==n.name)return this._conf_particulars.splice(i,1),void console.log("delete conf user success")}console.log("delete conf user faild")},_updateParticipator:function(e){if(this.__is_freshed){for(var n,o=0;o<this._conf_particulars.length;o++)if(n=this._conf_particulars[o],t.JudgeIdType(e.id).bPu){if(e.id==n.id)return e.volume>128&&(e.volume=this._conf_particulars[o].volume),this._conf_particulars[o]=e,void console.log("update conf user success")}else if(t.JudgeIdType(e.id).bCu){if(e.id==n.id&&e.applierid==n.applierid&&e.name==n.name)return e.volume>128&&(e.volume=this._conf_particulars[o].volume),this._conf_particulars[o]=e,void console.log("update conf user success")}else if(t.JudgeIdType(e.id).bUa&&e.id==n.id&&e.name==n.name)return e.volume>128&&(e.volume=this._conf_particulars[o].volume),this._conf_particulars[o]=e,void console.log("update conf user success");this._conf_particulars.push(e)}else this._swGetConfInfo({callback:function(){console.log("update conf user success")}})},_onUserLoginout:function(e,t,n){for(var o=null,i=0;i<this._conf_particulars.length;i++)if((o=this._conf_particulars[i]).name==e&&(o.applierid==t||-1==t))return o.isonline=n,o;return null},swGetAllMsg:function(){return this._msg_storage},_onGetImMsg:function(e){this._msg_storage.push(e)},_getPartByToken:function(e,n){for(var o=null,i=0;i<this._conf_particulars.length;i++)if((o=this._conf_particulars[i]).id==e){if(t.JudgeIdType(o.id).bUx)return o;if(o.applierid==n)return o}},_onNotify:function(e,o,i){var r=null;switch(e){case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_CONF_START:this._conf_base_info.bIsStarted=!0,r=this._conf_base_info.id,o=t.RequestHeader.confnotify.notifyconfstart.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_CONF_DELETE:r=this._conf_base_info.id,this._parent._confManager._deleteConfByConfId(this._conf_base_info.id),o=t.RequestHeader.confnotify.notifyconfdelete.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_CONF_STOP:this._conf_base_info.bIsStarted=!1,o=t.RequestHeader.confnotify.notifyconfstop.cmd;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_ADD:for(var s=proto.BVCU.ConfParticipators.deserializeBinary(i).getConfportsList(),a=[],l=null,_=0;_<s.length;_++)l=jSW.SwConfManager._UTILS.participatorToLocalUser(this._parent,s[_]),a[_]=l,null!=l&&n.debugLogInfo("WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_JOIN:"+l.name);this._addParticipators(a),o=t.RequestHeader.confnotify.notifyparticipartoradd.cmd,r=a;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_JOIN:l=proto.BVCU.ConfParticipatorInfo.deserializeBinary(i);l=jSW.SwConfManager._UTILS.participatorToLocalUser(this._parent,l),(a=[]).push(l),this._addParticipators(a),r=a,o=t.RequestHeader.confnotify.notifyparticipartorjoin.cmd,console.log("WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_JOIN:"+l.name);break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_REMOVE:for(s=proto.BVCU.ConfParticipators.deserializeBinary(i).getConfportsList(),a=[],l=null,_=0;_<s.length;_++)l=jSW.SwConfManager._UTILS.participatorToLocalUser(this._parent,s[_]),a[_]=l,null!=l&&n.debugLogInfo("WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_REMOVE:"+l.name);this._removeParticipator(a),o=t.RequestHeader.confnotify.notifyparticipartorremove.cmd,r=a;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_EXIT:l=proto.BVCU.ConfParticipatorInfo.deserializeBinary(i);o=t.RequestHeader.confnotify.notifyparticipartorexit.cmd,l=jSW.SwConfManager._UTILS.participatorToLocalUser(this._parent,l),console.log("WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_EXIT:"+l.name);var c=[];c.push(l),this._removeParticipator(c),r=c;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_APPLYFOR_ENDSPEAK:r=proto.BVCU.ConfParticipatorInfo.deserializeBinary(i),o=t.RequestHeader.confnotify.notifyapplyforendspeak.cmd,r=jSW.SwConfManager._UTILS.participatorToLocalUser(this._parent,r),console.log("WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_APPLYFOR_ENDSPEAK:"+r.name),this._updateParticipator(r);break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_TERMINATE_SPEAK:r=proto.BVCU.ConfParticipatorInfo.deserializeBinary(i);o=t.RequestHeader.confnotify.notifyterminatespeak.cmd,r=jSW.SwConfManager._UTILS.participatorToLocalUser(this._parent,r),console.log("WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_TERMINATE_SPEAK:"+r.name),this._updateParticipator(r);break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_APPLYFOR_STARTSPEAK:r=proto.BVCU.ConfParticipatorInfo.deserializeBinary(i);o=t.RequestHeader.confnotify.notifyapplyforstartspeak.cmd,r=jSW.SwConfManager._UTILS.participatorToLocalUser(this._parent,r),console.log("WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_APPLYFOR_STARTSPEAK:"+r.name),this._updateParticipator(r);break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_INVITE_SPEAK:r=proto.BVCU.ConfParticipatorInfo.deserializeBinary(i);o=t.RequestHeader.confnotify.notifyinvitespeak.cmd,r=jSW.SwConfManager._UTILS.participatorToLocalUser(this._parent,r),console.log("WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_INVITE_SPEAK:"+r.name),this._updateParticipator(r);break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_LEAVE:r=proto.BVCU.ConfParticipatorInfo.deserializeBinary(i);o=t.RequestHeader.confnotify.notifyparticipartorleave.cmd,r=jSW.SwConfManager._UTILS.participatorToLocalUser(this._parent,r),console.log("WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_LEAVE:"+r.name),this._updateParticipator(r);break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_RETURN:r=proto.BVCU.ConfParticipatorInfo.deserializeBinary(i);o=t.RequestHeader.confnotify.notifyparticipartorreturn.cmd,r=jSW.SwConfManager._UTILS.participatorToLocalUser(this._parent,r),console.log("WEB_BVCU_CONF_NOTIFY_PARTICIPATOR_RETURN:"+r.name),this._updateParticipator(r);break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_PARTICIPATOR_MODIFY:r=proto.BVCU.ConfParticipatorInfo.deserializeBinary(i);o=t.RequestHeader.confnotify.notifyparticipatormodify.cmd,r=jSW.SwConfManager._UTILS.participatorToLocalUser(this._parent,r),console.log("notifyparticipatormodify:"+r.name),this._updateParticipator(r),r.isinseat&&(this._conf_base_info.bIsStarted=!0);var u=[];u.push(r),r=u;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_USERLOGIN:o=t.RequestHeader.confnotify.notifyparticipatormodify.cmd;var d=i;if(r=[],!(g=this._onUserLoginout(d.getSzid(),d.getIvalue(),!0)))return;r.push(g);break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_USERLOGOUT:o=t.RequestHeader.confnotify.notifyparticipatormodify.cmd;d=i;if(r=[],!(g=this._onUserLoginout(d.getSzid(),d.getIvalue(),!1)))return;r.push(g);break;case proto.WEBBVCU.MSGType.WEB_BVCU_NOTIFY_PU_ONOFFLINE:o=t.RequestHeader.confnotify.notifyparticipatormodify.cmd;var p=i,C=[];for(_=0;_<p.length;_++){var g;if(!(g=this._onUserLoginout(p[_]._id_pu,-1,1==p[_]._info_pu.onlinestatus)))return;C.push(g)}r=C;break;case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_NOTIFY_IM_MSG:o=t.RequestHeader.confnotify.notifyimmsg.cmd,r=proto.WEBBVCU.IMMsgPks.deserializeBinary(i);var S=5==(r=t.IMMsgPksPb2_Json(r)).imsgtype&&0==r.isDownload,f=this._getPartByToken(r.szSourceId,r.iSourceId),E=f==this._getCurrentUser();if(r={confid:r.szTargetId,sender:f,szmsgs:r.szmsg,bismine:E},S)return void this._imAfteRecvPicMsg(r);this._onGetImMsg(r)}this._parent._confManager._dispatchCallback(this,o,r)}},jSW.SWPu=function(e,t){t.getChannellistList(),t.getPubaseinfo();this._parent=e,this._innerCommUpdata(t),n.debugLogInfo(this._info_pu.id+"v:"+this._arr_channel.length+",g"+this._arr_gps.length)},jSW.SWPu.SATELLITE={GPS:1,BDS:2,GLONASS:4,GALILEO:8,QZSS:16},jSW.SWPu.prototype={_parent:null,_id_pu:null,_name_pu:null,_info_pu:null,_arr_channel:null,_arr_gps:null,_arr_tsp:null,_gps_attr:null,swReboot:function(){return jSW.RcCode.RC_CODE_E_UNSUPPORTED},swSetPuManualrecord:function(e){var o=new proto.BVCU.PUConfig.ManualRecord;return e=n.extend({},{istart:1,ilength:-1,callback:null},e||{}),o.setBstart(e.istart),o.setIlength(t.Int2Uint(e.ilength)),t.SendRequest({session:this._parent,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_MANUALRECORD,target:this._id_pu,payload:o,callback:e.callback,tag:e.tag})},swPuControl:function(e){var n=t.CheckOptions(proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_REBOOT_OR_SHUTDOWN,e);if(n!=jSW.RcCode.RC_CODE_S_OK)return n;var o=new proto.WEBBVCU.PU_CONTROL;return o.setIoption(e.ioption),n=t.SendRequest({session:this._parent,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_REBOOT_OR_SHUTDOWN,target:this._id_pu,payload:o,callback:e.callback,tag:e.tag})},swSetPuSnapshot:function(e){var o=new proto.BVCU.PUConfig.Snapshot;return e=n.extend({},{istart:0,icyclecount:0,szftpid:null,callback:null,tag:null},e||{}),o.setBstart(e.istart),o.setIcyclecount(e.icyclecount),o.setSzftpid(e.szftpid),t.SendRequest({session:this._parent,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_SNAPSHOT,target:this._id_pu,payload:o,callback:e.callback,tag:e.tag})},swGetChanel:function(e){for(var t=0;t<this._arr_channel.length;t++)if(this._arr_channel[t]._id_chanel==e)return this._arr_channel[t];for(t=0;t<this._arr_gps.length;t++)if(this._arr_gps[t]._id_chanel==e)return this._arr_gps[t];for(t=0;t<this._arr_tsp.length;t++)if(this._arr_tsp[t]._id_chanel==e)return this._arr_tsp[t];return null},_innerCommUpdata:function(e){var o=e.getPubaseinfo(),i=e.getChannellistList();this._info_pu={bootduration:o.getIbootduration(),boottime:{year:o.getStboottime().getIyear(),month:o.getStboottime().getImonth(),day:o.getStboottime().getIday(),hour:o.getStboottime().getIhour(),minute:o.getStboottime().getIminute(),second:o.getStboottime().getIsecond()},chanelcount:i.length,chanellist:[],id:o.getSzid(),lat:o.getIlatitude(),long:o.getIlongitude(),name:o.getSzpuname(),onlinestatus:o.getIonlinestatus(),onlinethrough:o.getIonlinethrough(),onlinetime:{year:o.getStonlinetime().getIyear(),month:o.getStonlinetime().getImonth(),day:o.getStonlinetime().getIday(),hour:o.getStonlinetime().getIhour(),minute:o.getStonlinetime().getIminute(),second:o.getStonlinetime().getIsecond()}},this._id_pu=this._info_pu.id,this._name_pu=this._info_pu.name,this._arr_channel=[],this._arr_gps=[],this._arr_tsp=[];for(var r=0;r<i.length;r++){var s=t.ChanelType.getType(i[r].getIchannelindex()),a=null;if(s==t.ChanelType.chanel){var l=new jSW.SWVideoChanel(this,i[r]);this._arr_channel.push(l),a=l}else if(s==t.ChanelType.gps){var _=new jSW.SWGPSChanel(this,i[r]);this._arr_gps.push(_),a=_}else if(s==t.ChanelType.tsp){var c=new jSW.SWTSPChanel(this,i[r]);this._arr_tsp.push(c),a=c}this._info_pu.chanellist.push(a)}n.debugLogInfo(this._info_pu.id+"v:"+this._arr_channel.length+",g"+this._arr_gps.length)},_internalUpdate:function(e){this._innerCommUpdata(e),0==this._info_pu.onlinestatus&&this._clear()},compare:function(e){return!!this._parent.compare(e._parent)&&this._id_pu==e._id_pu},_clear:function(){for(var e=0;e<this._arr_channel.length;e++)0==this._arr_channel[e]._info_chanel.status&&this._arr_channel[e]._clear();for(e=0;e<this._arr_gps.length;e++)0==this._arr_gps[e]._info_chanel.status&&this._arr_gps[e].swClose();for(e=0;e<this._arr_tsp.length;e++)0==this._arr_tsp[e]._info_chanel.status&&this._arr_tsp[e].swClose()}},jSW.CommonDlgMgr=function(e){this._session=e,this._arraydlg=[]},jSW.CommonDlgMgr.prototype={push:function(e){var t=this.buildKey(e.getHDlg());this._arraydlg[t]=e},createAndSave:function(e,t){var n=new jSW.CommonDlg(e);return this.push(n,t),n},get:function(e){return this._arraydlg[this.buildKey(e)]},getSession:function(){return this._session},each:function(e,t,n){for(iindex in this._arraydlg)if(this._arraydlg[iindex])if(t){if(e.bind(t)(this._arraydlg[iindex],n))break}else if(e(this._arraydlg[iindex],n))break},free:function(e){this._arraydlg[this.buildKey(e)]=null},buildKey:function(e){return"dlg"+e},getDefault:function(){var e=null;return this.each(function(t){if(null==e)return e=t,!0}),e}},jSW.CommonDlg=function(e,t){this._channel=e,this._hDlg=t,this._mdiv=null,this._dlgParams=null,this._media=0,this._rotate=0,this._prototype=-1,this._info=""},jSW.CommonDlg.prototype={getkey:function(){return this._hDlg},compare:function(e){return this.getkey()==e.getkey()},getHDlg:function(){return this._hDlg},getDlgParams:function(){return null==this._dlgParams&&(this._dlgParams=t.BVCU_DialogParam(this._channel._parent._id_pu,this._channel._id_chanel,0,this._prototype,0,0,this._hDlg)),this._dlgParams},getPlayDiv:function(){return this._mdiv},setParams:function(e,t,n,o){this._mdiv=e,this._hDlg=t,this._media=n,this._prototype=o},getMedia:function(){return this._media},getRotate:function(){return this._rotate},setRotate:function(e){this._rotate=e},getProteType:function(){return this._prototype},getOpts:function(e){return e||(e={hdl:-1}),e.hdlg=this._hDlg,e},getInfo:function(){return""==this._info&&(this._info=this._channel._parent._id_pu+" "+this._channel._id_chanel+" "+this._hDlg),this._info},onMediaChange:function(e){this._media=e},_reset:function(){this._media=0},setHdlg:function(e){this._hDlg=e}},jSW.SWVideoChanel=function(e,t){this._parent=e,this._info_chanel={id:t.getIchannelindex(),name:t.getSzname(),ptz:t.getIptz(),media:t.getImediadir()>>10,status:1023&t.getImediadir()},this._id_chanel=this._info_chanel.id,this._name_chanle=this._info_chanel.name,this._meida_chanel=this._info_chanel.media,this._ptz_chanel=this._info_chanel.ptz,this._url_channel=null,this.m_live_hls=null,this.m_live_rtmp=null,this._session=this._parent._parent,this._commDlgMgr=new jSW.CommonDlgMgr(this._session),this.ismuti=!1,this._open_status=jSW.SWVideoChanel._OpenStatus.NOT_OPEND,this._intercom=new jSW.SWVideoChanel.InterCom(this)},jSW.SWVideoChanel._OpenStatus={NOT_OPEND:0,OPENING:1,OPENED:2},jSW.SWVideoChanel._OcxFullScreen={_lastVideoChanel:null,_hDlg:-1,beforeFullScreen:function(e,t){this._lastVideoChanel=e,this._hDlg=t},onClickEsc:function(){o.CheckOcx()&&document.msFullscreenElement&&document.msExitFullscreen()},upDateDialog:function(){this._lastVideoChanel&&this._lastVideoChanel._updateDialog(this._hDlg),document.msFullscreenElement||(this._lastVideoChanel=null)},onFullScreenChange:function(){setTimeout(jSW.SWVideoChanel._OcxFullScreen.upDateDialog.bind(jSW.SWVideoChanel._OcxFullScreen),200)}},document.addEventListener("keydown",function(){27==(window.event||arguments[0]).keyCode&&jSW.SWVideoChanel._OcxFullScreen.onClickEsc()}),jSW.SWVideoChanel.prototype={m_prototype:4,swSrcType:function(){return this.m_prototype==t.ProtoType.HLS?"hls":this.m_prototype==t.ProtoType.OCX?"ocx":this.m_prototype==t.ProtoType.RTMP?"rtmp":"unknown"},localRecords:[],_notifyDialogEventStorage:function(e,t){var n=null,o=!1;for(iIndex in this.localRecords)if((n=this.localRecords[iIndex]).szfilename==t.szfilename){o=!0;break}switch(o||(n={iresult:jSW.RcCode.RC_CODE_S_OK,szfilename:t.szfilename,itimestampbegin:0,itimestampend:0},this.localRecords.push(n)),e){case proto.WEBBVCU.MSGType.WEB_NOTIFY_BVCU_EVENT_STORAGE_FILE_OPEN:n.itimestampbegin=t.itimestamp,n.iresult=t.iresult;break;case proto.WEBBVCU.MSGType.WEB_NOTIFY_BVCU_EVENT_STORAGE_FILE_CLOSE:n.itimestampend=t.itimestamp,n.iresult=t.iresult;break;case proto.WEBBVCU.MSGType.WEB_NOTIFY_BVCU_EVENT_STORAGE_ERROR:n.iresult=t.iresult}if((e==proto.WEBBVCU.MSGType.WEB_NOTIFY_BVCU_EVENT_STORAGE_FILE_CLOSE||e==proto.WEBBVCU.MSGType.WEB_NOTIFY_BVCU_EVENT_STORAGE_ERROR)&&null!=this._callbackAfterRecordHasResult){var i={channel:this,storage:n};this._callbackAfterRecordHasResult(i)}},_callbackAfterRecordHasResult:null,_videoPlayer:null,_iVideoPlayerRotate:0,_OnNeedSaveVideoPlayer:function(e){this._videoPlayer=e,this._iVideoPlayerRotate=0},swFullScreen:function(e){return this._autoDlgProxy(e,function(e,t,n,i,r){if(o.CheckOcx()){var s=e.getPlayDiv().bv_uuid+"_0077554tempdiv",a=document.getElementById(s);document.onmsfullscreenchange||(document.onmsfullscreenchange=jSW.SWVideoChanel._OcxFullScreen.onFullScreenChange),document.msFullscreenElement?document.msExitFullscreen():(jSW.SWVideoChanel._OcxFullScreen.beforeFullScreen(this,r),a.msRequestFullscreen())}else o.calltype==jSW.CallProtoType.HTTP&&(this._videoPlayer.isFullscreen()?this._videoPlayer.exitFullscreen():this._videoPlayer.requestFullscreen());return jSW.RcCode.RC_CODE_S_OK})},swGetDialogInfo:function(e){var n=new proto.BVCU.CMSConfig.CMSCFG_DialogInfo,o=new proto.BVCU.CMSConfig.CMSCFG_ChannelInfo;o.setSzid(this._parent._id_pu),n.setSttarget(o),n.setIchannelindex(this._id_chanel);t.SendRequest({session:this._parent._parent,payload:n,msgtype:proto.WEBBVCU.MSGType.WEB_GET_CMS_DIALOGINFO,callback:e.callback,tag:e.tag});return jSW.RcCode.RC_CODE_S_OK},swVideoRotate:function(e){return this._autoDlgProxy(e,function(t,i,r,s,a){var l=t.getRotate();return l+=e.irotate,o.CheckOcx()?this._swOnDivSizeChange(l,a,e):o.CheckHttp()?null==this._videoPlayer?(n.debugLogInfo(r+" "+s+" video rotate faild, due not playing"),jSW.RcCode.RC_CODE_E_FAIL):(this._videoPlayer.zoomrotate({rotate:this._iVideoPlayerRotate,debug:!1}),setTimeout(e.callback,50,{tag:e.tag},{emms:{code:jSW.RcCode.RC_CODE_S_OK}}),jSW.RcCode.RC_CODE_S_OK):void 0})},swVideoStretch:function(e){return this._autoDlgSendProxy(e,function(t){var n=new proto.WEBBVCU.CommonData;return n.setIdata1(e.bStretch?1:0),{msgtype:proto.WEBBVCU.MSGType.WEB_VIDEO_DIALOG_STRETCH,payload:n}})},swLocalSnapshot:function(e){return e.szFileName&&0!=e.szFileName.length?this._autoDlgSendProxy(e,function(t){var o=new proto.WEBBVCU.CommonData;return o.setIdata1(e.iQuality?e.iQuality:100),o.setSzdata(n.string2Uint8Array(e.szFileName)),{msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_LOCAL_SNAPSHOT,payload:o}}):(console.log("swLocalSnapshot SzFilePath Is Invalid"),jSW.RcCode.RC_CODE_E_INVALIDARG)},_updateDialog:function(e){var t=jSW.RcCode.RC_CODE_E_UNSUPPORTED;return o.CheckOcx()?t=this._commSendProxy(options,function(){return{msgtype:proto.WEBBVCU.MSGType.WEB_VIDEO_DIALOG_UPDATE,hdlg:e}}):t},_swOnDivSizeChange:function(e,o,i){var r=new proto.WEBBVCU.VideoDialogRotate;r.setSzpuid(n.string2Uint8Array(this._parent._id_pu)),r.setIchannelindex(this._id_chanel),r.setIrotate(e);t.SendRequest({session:this._parent._parent,payload:r,msgtype:proto.WEBBVCU.MSGType.WEB_VIDEO_DIALOG_ROTATE,hdlg:o,callback:i.callback,tag:i.tag});return jSW.RcCode.RC_CODE_S_OK},_onOcxChanelChange:function(e,t,n){jSW.CallProtoType.OCX,o.calltype},_pushCommDlg:function(e){this._commDlgMgr.push(e)},_beginOpen:function(){this.ismuti||(this._open_status=jSW.SWVideoChanel._OpenStatus.OPENING)},_endOpenHasResult:function(e){this.ismuti||(this._open_status=e?jSW.SWVideoChanel._OpenStatus.OPENED:jSW.SWVideoChanel._OpenStatus.NOT_OPEND)},_closeHasResult:function(e){this.ismuti||e&&(this._open_status=jSW.SWVideoChanel._OpenStatus.NOT_OPEND)},_checkCanOpen:function(e){return this.ismuti=e,!!this.ismuti||this._open_status==jSW.SWVideoChanel._OpenStatus.NOT_OPEND},_fillOpenParam:function(e){this.ismuti=e},_autoDlgProxy:function(e,t,n){var o=this._getOptsHdlg(e);if(this.ismuti&&(void 0===o||-1==o))return console.log("can't find the dialog from you hdlg"),jSW.RcCode.RC_CODE_E_INVALIDARG;var i=this.ismuti?this._commDlgMgr.get(o):this._commDlgMgr.getDefault();return null==i?(console.log("can't find the dialog from you hdlg, maybe it's been closed"),jSW.RcCode.RC_CODE_E_NOTFOUND):(o=i.getHDlg(),this._commProxy(function(e,r,s){return t.bind(this)(i,e,r,s,o,n)}))},_getOptsHdlg:function(e){return e&&void 0!==e.hdlg?e.hdlg:-1},_getDesDiv:function(e){return"string"==typeof e?document.getElementById(e):e},_commProxy:function(e){return null==this._parent||null==this._parent._parent?(console.error("internal error, this._parent is null"),jSW.RcCode.RC_CODE_E_FAIL):e.bind(this)(this._parent._parent,this._parent._id_pu,this._id_chanel)},_commSendProxy:function(e,o){return this._commProxy(function(i,r,s){var a={payload:null,msgtype:-1,cmd:"",hdlg:-1,callback:e.callback,tag:e.tag},l=o.bind(this)();return l=n.extend({},a,l||{}),t.SendRequest({session:i,target:r,targetIndex:s,msgtype:l.msgtype,callback:l.callback,payload:l.payload,hdlg:l.hdlg,tag:l.tag,cmd:l.cmd})})},_autoDlgSendProxy:function(e,o,i){return this._autoDlgProxy(e,function(r,s,a,l,_){var c=o.bind(this)(r);c=n.extend({},{payload:null,msgtype:-1,cmd:"",hdlg:-1,callback:null,tag:null},c||{});var u=t.SendRequest({session:s,target:a,targetIndex:l,msgtype:c.msgtype,callback:e.callback,payload:c.payload,hdlg:_,tag:e.tag,cmd:c.cmd});return i&&i.bind(this)(r),u})},swOpen:function(e){return this._commProxy(function(o,i,r){var s={callback:null,tag:null,prototype:"auto",media:jSW.MEDIADIR.VIDEORECV};e=n.extend({},s,e||{});var a=this._eventHandle.getProtoType(e.prototype);if(jSW.RcCode.bFaild(a.rc))return a.rc;var l=a.prototype,_=e.tag.div,c=null,u=!1;if(null==_)console.warn("no have div ,we will not display the video stream, just throw stream url");else{var d=this._eventHandle.beforeOpenPreparePlayDiv(l,_);c=d.playObj,u=d.isNeedDelay}var p=!!e.useoptions.bovertcp,C=this._eventHandle.sendOpenChanel,g=t.BVCU_DialogParam(i,r,0,l,e.media,0,0,p);return!!e.useoptions.bstretch&&g.setBstretch(!0),u?(setTimeout(function(){C(o,e,c,g)},500),jSW.RcCode.RC_CODE_S_OK):C(o,e,c,g)})},swOpenEx:function(e){var t={callback:null,div:"",prototype:"auto",media:jSW.MEDIADIR.VIDEORECV,bovertcp:!1,tag:null,ismuti:!1,bstretch:!1},o=n.extend({},t,e||{});if(!this._eventHandle.checkMedia(o.media))return jSW.RcCode.RC_CODE_E_INVALIDARG;if(!this._checkCanOpen(o.ismuti)){e.ismuti||console.log("current open chanel model is mutil open!");var i=jSW.RcCode.RC_CODE_E_ALREADYEXIST;return console.log(jSW.RcCode.trans(i)),jSW.RcCode.RC_CODE_E_ALREADYEXIST}this._beginOpen(),o.div=this._getDesDiv(o.div),null==o.div&&console.warn("no have div ,we will not display the video stream, just throw stream url");var r=this.swOpen({prototype:o.prototype,tag:{div:o.div,channel:this,userdata:o.tag},useoptions:o,media:o.media,callback:this._eventHandle.onSwOpenExHasResult});return jSW.RcCode.bFaild(r)&&this._endOpenHasResult(!1),r},_eventHandle:{getProtoType:function(e){var i={rc:jSW.RcCode.RC_CODE_S_OK,prototype:-1},r=-1;return o.calltype==jSW.CallProtoType.OCX?r=t.ProtoType.OCX:"hls"==e?r=t.ProtoType.HLS:"rtmp"==e?n.supportFlash()?r=t.ProtoType.RTMP:(console.error("not supported flash (rtmp)"),i.rc=jSW.RcCode.RC_CODE_E_UNSUPPORTED):r=n.supportFlash()?t.ProtoType.RTMP:t.ProtoType.HLS,i.prototype=r,i},sendOpenChanel:function(e,n,o,i){null!=o&&(t.ProtoType.OCX==i.getProto()&&i.setHwnd(o.GetWMHwnd()),o.style.display="block");var r=t.JsonParamDialog(e._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_OPEN_CHANLE,i);return t._internalSend({cmd:t.RequestHeader.openchanle.cmd,session:e,request:r,callback:n.callback,opt:n,tag:n.tag})},beforeOpenPreparePlayDiv:function(e,o){var i=null,r=!1;void 0===o.bv_uuid&&(o.bv_uuid=n.generateUUID());var s=o.bv_uuid+"_0077553",a=document.getElementById(s);if(null!=a&&(a.style.display="none"),s=o.bv_uuid+"_0077554",null!=(a=document.getElementById(s))&&(a.style.display="none"),t.ProtoType.HLS==e||t.ProtoType.RTMP==e){var l=o.bv_uuid+"_0077553";null==(i=document.getElementById(l))&&((i=document.createElement("VIDEO")).setAttribute("id",l),i.setAttribute("class","video-js vjs-default-skin vjs-big-play-centered"),i.style.width="100%",i.style.height="100%",i.style.display="block",o.appendChild(i))}else if(t.ProtoType.OCX==e){var _=(l=o.bv_uuid+"_0077554")+"tempdiv";if(null==(i=document.getElementById(l))){var c=document.getElementById(_);null==c&&((c=document.createElement("div")).id=l+"tempdiv",c.style.width="100%",c.style.height="100%"),c.style.display="block",o.appendChild(c),(i=document.createElement("object")).id=l,i.classid="clsid:CDE6C639-4BA8-4A09-81EB-DCE76A61FE98",i.style.width="100%",i.style.height="100%",i.style.display="block",i.tag=this,c.appendChild(i),r=!0;var u=l+"ocxeventid",d=document.getElementById(u);null==d&&((d=document.createElement("script")).id=l+"ocxeventid",d.type="text/javascript",d.setAttribute("for",l),d.setAttribute("event","OnHwndEvent(hwnd, ieventtype, pParam)"),d.text="jSW._swOcxPlayerOnEvent(ieventtype, this.tag);",document.body.appendChild(d))}}return{playObj:i,isNeedDelay:r}},onSwOpenExHasResult:function(e,n,i){var r=n.getPayload(),s=proto.WEBBVCU.Open_Dialog_Response.deserializeBinary(r),a=e.tag.channel,l=e.tag.userdata,_="",c=e.request.getPayload(),u=proto.WEBBVCU.BVCU_DialogParam.deserializeBinary(c),d=-1,p=jSW.RcCode.bSuccess(n.getCode()),C=u.getProto();s.hasUrl()&&(_=s.getUrl());var g=null;if(p){if(s.hasHdlg()&&(d=s.getHdlg(),i.setParams(e.tag.div,d,u.getMedia(),C),a._pushCommDlg(i)),null!=e.session){u.getId(),u.getMajor();var S,f=a;if(null!=f)C==t.ProtoType.HLS?S=o.http+_:C==t.ProtoType.RTMP&&(S="rtmp://"+o.ip+_),f._url_chanel={proto:f.swSrcType(),url:S}}if(null==e.tag.div||C!=t.ProtoType.HLS&&C!=t.ProtoType.RTMP)C==t.ProtoType.OCX&&(g={hdlg:i._hDlg});else{var E=e.tag.div.bv_uuid+"_0077553";if(null==document.getElementById(E))return void console.error("not have player");var h=null,m=null;C==t.ProtoType.HLS?h=o.http+_:C==t.ProtoType.RTMP&&(m="rtmp://"+o.ip+_);var B=videojs(E,{controlBar:!1,controls:!1},function(){C==t.ProtoType.HLS?this.src({type:"application/vnd.apple.mpegurl",src:h}):C==t.ProtoType.RTMP&&this.src({type:"rtmp/flv",src:m}),this.play()});null!=a&&a._OnNeedSaveVideoPlayer(B)}}var I=e.opt;I&&I.useoptions&&"function"==typeof I.useoptions.callback&&(I.useoptions.tag=l,I.useoptions.callback(I.useoptions,n,g)),I&&I.useoptions&&I.useoptions.chanel&&(I.useoptions.chanel.m_live_hls=h,I.useoptions.chanel.m_live_rtmp=m),a&&a._endOpenHasResult(p)},afterCloseDlgClearResource:function(e){if(e){var t=e.bv_uuid+"_0077553",n=document.getElementById(t+"tempdiv"),o=document.getElementById(t);if(null!=o&&(o.parentNode.removeChild(o),null!=n&&n.parentNode.removeChild(n)),"undefined"!=typeof videojs)try{var i=videojs(t);i&&(i.dispose(),this._videoPlayer=null)}catch(e){}t=e.bv_uuid+"_0077554",o=document.getElementById(t),n=document.getElementById(t+"tempdiv"),null!=o&&o.parentNode.removeChild(o),null!=n&&n.parentNode.removeChild(n);var r=t+"ocxeventid",s=document.getElementById(r);s&&s.parentNode.removeChild(s)}},_checkMedia:function(e,t){var n=0;for(var o in t)n|=t[o];return!!(e|n==n)},checkMedia:function(e){var t=!1;return(t=o.CheckOcx()?this._checkMedia(e,[jSW.MEDIADIR.VIDEORECV,jSW.MEDIADIR.AUDIORECV]):this._checkMedia(e,[jSW.MEDIADIR.VIDEORECV]))||console.log("the media dir you want to view is not support"),t}},swAlterVolume:function(e){return this._intercom._volumeProxy(function(t,n){if(void 0===e.volume)return jSW.RcCode.RC_CODE_E_BVCU_INVALIDARG;if(e.volume.icapture<0||e.volume.icapture>100||e.volume.iplay<0||e.volume.iplay>100)return jSW.RcCode.RC_CODE_E_BVCU_INVALIDARG;var o=new proto.WEBBVCU.BVCU_DialogControlParam_Render;return o.setIplackbackvolume(e.volume.iplay),o.setIcapturevolume(e.volume.icapture),this._commSendProxy(e,function(){return{payload:o,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_ALTER_VIDEO_VOLUME,cmd:"swAlterVolume",hdlg:n}})},this)},onAlterVolumeOk:function(e){this._intercom.setVolume(e)},swGetVolume:function(e){var t=null,n=this._intercom._volumeProxy(function(e,n){return t=e,jSW.RcCode.RC_CODE_S_OK},this);if(jSW.RcCode.bSuccess(n)){var o={tag:e.tag},i={emms:{code:jSW.RcCode.RC_CODE_S_OK}};setTimeout(e.callback,50,o,i,t)}return console.log("on get volume ok"),n},onIntercomOpenOk:function(e,t,n){this._intercom.onOpenHasResult(e,t,n)},onIntercomCloseOK:function(e){this._intercom.onCloseHasResult(e)},onAlterMedirDirOk:function(e,t,n){if(e){var o=this._commDlgMgr.get(n);o&&o.onMediaChange(t)}else this._intercom.onAlterHasResult(t)},swOpenIntercom:function(e){var t=this._intercom._openProxy(function(t){var o=((e=n.extend({},{isSendAudio:!0,isRecvAudio:!0,callback:null,tag:null},e||{})).isSendAudio?jSW.MEDIADIR.AUDIOSEND:jSW.MEDIADIR.ALLNULL)+(e.isRecvAudio?jSW.MEDIADIR.AUDIORECV:jSW.MEDIADIR.ALLNULL),i=new proto.WEBBVCU.CommonData;return i.setIdata1(o),this._commSendProxy(e,function(){return{payload:i,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_OPEN_INTERCOM,cmd:"",hdlg:-1}})},this);return t},swCloseIntercom:function(e){return this._intercom._closeProxy(function(t){return this._commSendProxy(e,function(){return{payload:null,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_CLOSE_INTERCOM,cmd:"",hdlg:t}})},this)},swAlterAudioDir:function(e){return this._intercom._alterProxy(function(t,o){var i=(t&jSW.MEDIADIR.AUDIORECV)==jSW.MEDIADIR.AUDIORECV,r=(t&jSW.MEDIADIR.AUDIOSEND)==jSW.MEDIADIR.AUDIOSEND,s={isSendAudio:r,isRecvAudio:i,callback:null,tag:null};if((e=n.extend({},s,e||{})).isRecvAudio==i&&e.isSendAudio==r)return console.log("i dont't think you should alter video dir, current status is you wished!"),jSW.RcCode.RC_CODE_S_OK;var a=(e.isRecvAudio?jSW.MEDIADIR.AUDIORECV:jSW.MEDIADIR.ALLNULL)+(e.isSendAudio?jSW.MEDIADIR.AUDIOSEND:jSW.MEDIADIR.ALLNULL),l=new proto.WEBBVCU.CommonData;return l.setIdata1(a),this._commSendProxy(e,function(){return{payload:l,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_ALTER_AUDIO_DIALOG_DIR,cmd:"",hdlg:o}})},this)},swBIsIntercomOpened:function(){this._intercom.bIsOpen()},swAlterVideoDir:function(e){return jSW.CallProtoType.OCX!=o.calltype?(console.error("only ocx support Alert, right now!"),jSW.RcCode.RC_CODE_E_UNSUPPORTED):this._autoDlgProxy(e,function(o){if(null==o)return jSW.RcCode.RC_CODE_E_NOTFOUND;var i=o.getMedia(),r=(i&jSW.MEDIADIR.VIDEORECV)==jSW.MEDIADIR.VIDEORECV,s=(i&jSW.MEDIADIR.AUDIORECV)==jSW.MEDIADIR.AUDIORECV,a={isRecvAudio:s,isRecvVideo:r,div:null,callback:null,tag:null,hDlg:-1};if((e=n.extend({},a,e||{})).isRecvAudio==s&&e.isRecvVideo==r)return console.log("i dont't think you should alter video dir, current status is your wished!"),jSW.RcCode.RC_CODE_S_OK;var l=(e.isRecvAudio?jSW.MEDIADIR.AUDIORECV:jSW.MEDIADIR.ALLNULL)+(e.isRecvVideo?jSW.MEDIADIR.VIDEORECV:jSW.MEDIADIR.ALLNULL),_=new proto.WEBBVCU.CommonData;return _.setIdata1(l),e=n.extend({},a,e||{}),this._autoDlgSendProxy(e,function(e){return{msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_ALTER_VIDEO_DIALOG_DIR,payload:_,cmd:t.RequestHeader.altervideodir.cmd}})})},swGetLocalRecord:function(e){return o.CheckNotOcx()?(console.error("only ocx support local record"),jSW.RcCode.RC_CODE_E_FAIL):this._autoDlgSendProxy(e,function(){return{msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_LOCAL_RECORD}})},swSetLocalRecord:function(e){if(o.CheckNotOcx())return console.error("only ocx support local record"),RC_CODE_E_FAIL;e=n.extend({},{szpath:"",ifileleninseconds:-1,callbak:null,recordCallback:null,tag:null},e||{});var t=new proto.WEBBVCU.LocalStorage;return t.setDir(n.string2Uint8Array(e.szpath)),t.setIfileleninseconds(Number(e.ifileleninseconds)),this._callbackAfterRecordHasResult=e.recordCallback,this._autoDlgSendProxy(e,function(){return{payload:t,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_LOCAL_RECORD}})},swSetNruRecord:function(e){e=n.extend({},{istart:0,ilength:-1,imediadir:0,callbak:null,recordCallback:null,tag:null},e||{});var o=new proto.BVCU.NRUConfig.ManualRecord;return o.setSzid(this._parent._id_pu),o.setIchannelindex(this._id_chanel),o.setBstart(e.istart),o.setIlength(e.ilength),o.setImediadir(e.imediadir),t.SendRequest({session:this._parent._parent,payload:o,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_SUBMETHOD_NRU_MANUALRECORD,callback:e.callback,tag:e.tag})},swGetUrl:function(){return this._url_chanel},swSnapshot:function(e){return e=n.extend({},{callback:null,tag:null},e||{}),this._autoDlgSendProxy(e,function(){return{msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_SNAPSHOT}})},swGetPtzAttr:function(e){if(null==this._parent&&this._parent._parent)return console.error("internal error, this._parent is null"),jSW.RcCode.RC_CODE_E_INVALIDARG;e=n.extend({},{callback:null,tag:null},e||{});var o=this._parent._parent,i=new t.BVCU_Command(this._parent._id_pu,this._id_chanel),r=t.RequestHeader.getptzattr,s=new t.JsonParamCommand(o._p_emms,r.requestHeader,i);return t._internalSend({cmd:t.RequestHeader.getptzattr.cmd,session:o,cmd:r.cmd,request:s,callback:e.callback,tag:e.tag})},swSetPtzAttr:function(e){},swPtzCtrl:function(e){if(null==this._parent&&this._parent._parent)return console.error("internal error, this._parent is null"),jSW.RcCode.RC_CODE_E_INVALIDARG;e=n.extend({},{ptzCtrl:{iPTZCommand:0,bStop:1,iParam1:0,iParam2:0,iParam3:0},callback:null,tag:null},e||{});var o=this._parent._parent,i=new proto.BVCU.PUConfig.PTZControl;i.setIptzcommand(e.ptzCtrl.iPTZCommand),i.setBstop(e.ptzCtrl.bstop),i.setIparam1(e.ptzCtrl.iparam1),i.setIparam2(e.ptzCtrl.iparam2),i.setIparam3(e.ptzCtrl.iparam3);var r=new t.BVCU_Command(this._parent._id_pu,this._id_chanel,i),s=new t.JsonParamCommand(o._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_SET_PTZ,r);return t._internalSend({cmd:t.RequestHeader.ptzctrl.cmd,session:o,request:s,callback:e.callback,tag:e.tag})},_swKeepLiveDlg:function(e){var n=e.getOpts(),o=this._autoDlgSendProxy(n,function(){return{msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_KEEPALIVE,payload:null,cmd:t.RequestHeader.keeplive.cmd}});return console.log("keeplive chanel: "+e.getInfo()),o},swKeepLive:function(){this._commDlgMgr.each(this._swKeepLiveDlg,this),this._intercom._keep_alive(function(e){var n={hdlg:e};this._commSendProxy(n,function(){return{msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_KEEPALIVE,payload:null,cmd:t.RequestHeader.keeplive.cmd}})},this)},swHide:function(e){return this._autoDlgProxy(e,function(e,t,n,o){var i=e.getPlayDiv(),r=i+"_0077553";try{if(videojs&&"undefined"!=typeof videojs){var s=videojs(r);s&&s.dispose()}}catch(e){}var a=document.getElementById(r);return null!=a&&(a.style.display="none"),r=i.bv_uuid+"_0077554",null!=(a=document.getElementById(r))&&(a.style.display="none"),jSW.RcCode.RC_CODE_S_OK}),jSW.RcCode.RC_CODE_S_OK},swShow:function(e){this._autoDlgProxy(e,function(e,n,o,i,r){var s=e.getPlayDiv(),a=e.getProteType();if(a==t.ProtoType.HLS||a==t.ProtoType.RTMP){var l=s.bv_uuid+"_0077553",_=document.getElementById(l);null!=_?_.style.display="block":((_=document.createElement("VIDEO")).setAttribute("id",l),_.setAttribute("class","video-js vjs-default-skin vjs-big-play-centered"),_.style.width="100%",_.style.height="100%",_.style.display="block",s.appendChild(_));try{var c=this;videojs(l,{controlBar:!1,controls:!1},function(){a==t.ProtoType.HLS?this.src({type:"application/vnd.apple.mpegurl",src:c.m_live_hls}):a==t.ProtoType.RTMP&&this.src({type:"rtmp/flv",src:c.m_live_rtmp}),this.play()})}catch(e){console.warn(e.message)}}else a==t.ProtoType.OCX&&(l=s.bv_uuid+"_0077554",null!=(_=document.getElementById(l))&&(_.style.display="block"),setTimeout(this._updateDialog.bind(this),500,r))})},_clear:function(){this._commDlgMgr.each(function(e,t){t.swClose(e.getHDlg())},this)},swClose:function(e){var n={hdlg:e};return this._autoDlgSendProxy(n,function(e){var n=e.getDlgParams();return{msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_CLOSE_CHANLE,payload:n,cmd:t.RequestHeader.closechanle.cmd}},function(e){var t=e.getPlayDiv();this._eventHandle.afterCloseDlgClearResource(t),this._commDlgMgr.free(e.getHDlg()),this._closeHasResult(!0),console.log("close chanel: "+e.getInfo())})},compare:function(e){return!!this._parent.compare(e._parent)&&this._id_chanel==e._id_chanel}},jSW.SWVideoChanel.InterComStatus=function(){this._status=jSW.SWVideoChanel.InterComStatus.Types.INIT},jSW.SWVideoChanel.InterComStatus.Types={INIT:0,DOING:1,DONE:2},jSW.SWVideoChanel.InterComStatus.prototype={reset:function(){this._status=jSW.SWVideoChanel.InterComStatus.Types.INIT},setDoing:function(){this._status=jSW.SWVideoChanel.InterComStatus.Types.DOING},setDone:function(){this._status=jSW.SWVideoChanel.InterComStatus.Types.DONE},bInit:function(){return jSW.SWVideoChanel.InterComStatus.Types.INIT==this._status},bDoing:function(){return jSW.SWVideoChanel.InterComStatus.Types.DOING==this._status},bDone:function(){return jSW.SWVideoChanel.InterComStatus.Types.DONE==this._status}},jSW.SWVideoChanel.InterCom=function(e){this.status=new jSW.SWVideoChanel.InterComStatus,this._commDlg=new jSW.CommonDlg(e),this._channel=e,this._volume={icapture:50,iplay:50}},jSW.SWVideoChanel.InterCom.prototype={_getCurMedia:function(){return this._commDlg.getMedia()},_getHdlg:function(){return this._commDlg.getHDlg()},_openProxy:function(e,t){if(!o.CheckOcx())return console.log("only ocx support intercom"),jSW.RcCode.RC_CODE_E_UNSUPPORTED;var n=jSW.RcCode.RC_CODE_E_FAIL;return this.status.bDone()?(console.log("intercom has opened, can not be open twice! you can call swAlterAudioDir to change medir dir or close it try again!"),jSW.RcCode.RC_CODE_E_ALREADYEXIST):this.status.bDoing()?jSW.RcCode.RC_CODE_E_BUSY:(this.status.setDoing(),n=e.bind(t)(this._getCurMedia()),jSW.RcCode.bFaild(n)&&this.status.reset(),n)},_closeProxy:function(e,t){if(!o.CheckOcx())return console.log("only ocx support intercom"),jSW.RcCode.RC_CODE_E_UNSUPPORTED;var n=jSW.RcCode.RC_CODE_E_FAIL;return this.status.bInit()?jSW.RcCode.RC_CODE_E_NOTFOUND:this.status.bDoing()?jSW.RcCode.RC_CODE_E_BUSY:(this.status.setDoing(),n=e.bind(t)(this._getHdlg()),jSW.RcCode.bFaild(n)&&this.status.setDone(),n)},_alterProxy:function(e,t){if(!o.CheckOcx())return console.log("only ocx support intercom"),jSW.RcCode.RC_CODE_E_UNSUPPORTED;var n=jSW.RcCode.RC_CODE_E_FAIL;return this.status.bInit()?jSW.RcCode.RC_CODE_E_NOTFOUND:this.status.bDoing()?jSW.RcCode.RC_CODE_E_BUSY:(n=e.bind(t)(this._getCurMedia(),this._getHdlg()),jSW.RcCode.bFaild(n),n)},_volumeProxy:function(e,t){if(!o.CheckOcx())return console.log("only ocx support intercom"),jSW.RcCode.RC_CODE_E_UNSUPPORTED;var n=jSW.RcCode.RC_CODE_E_FAIL;return this.status.bInit()?jSW.RcCode.RC_CODE_E_NOTFOUND:this.status.bDoing()?jSW.RcCode.RC_CODE_E_BUSY:(n=e.bind(t)(this.__getVolume(),this._getHdlg()),jSW.RcCode.bFaild(n),n)},__getVolume:function(){return{icapture:this._volume.icapture,iplay:this._volume.iplay}},setVolume:function(e){this._volume={icapture:e.icapture,iplay:e.iplay}},_clear:function(e,t){this.status.bDone()&&(e.bind(t)(this._getHdlg()),this._reset())},_keep_alive:function(e,t){this.status.bDone()&&e.bind(t)(this._getHdlg())},_reset:function(){this.status.reset(),this._commDlg._reset()},onAlterHasResult:function(e){this._commDlg.onMediaChange(e),this.status.setDone()},onOpenHasResult:function(e,t,n){e?(this._commDlg.onMediaChange(t),this._commDlg.setHdlg(n),this.status.setDone()):this._reset()},onCloseHasResult:function(e){this._reset()},bIsOpen:function(){return this.status.bDone()}},jSW.SWGPSChanel=function(e,t){this._parent=e,this._info_chanel={id:t.getIchannelindex(),name:t.getSzname(),ptz:t.getIptz(),media:t.getImediadir()>>10,status:1023&t.getImediadir()},this._id_chanel=this._info_chanel.id,this._name_chanle=this._info_chanel.name},jSW.SWGPSChanel.prototype={_parent:null,_id_chanel:null,_name_chanel:null,_info_chanel:null,m_is_open:!1,swClose:function(){this.m_is_open=!1},swOpen:function(e){if(null==this._parent||null==this._parent._parent)return console.error("internal error, this._parent is null"),jSW.RcCode.RC_CODE_E_INVALIDARG;this.m_is_open=!0;var o=this._parent._parent,i=t.RequestHeader.pugpsdata,r=new t.JsonParamCommand(o._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_GET_PUGPSDATA,t.BVCU_Command(this._parent._id_pu,this._id_chanel,null));e=n.extend({},{callback:null,tag:null,repeat:1,interval:5e3},e||{});var s=function(e,n){var a=!1;-1==e.repeat?a=!0:e.repeat>0&&(e.repeat=e.repeat-1,a=!0),a&&n.m_is_open&&(t._internalSend({cmd:t.RequestHeader.openchanletsp.cmd,session:o,cmd:i.cmd,request:r,callback:e.callback,tag:e.tag}),setTimeout(function(){s(e,n)},e.interval))};return s(e,this),jSW.RcCode.RC_CODE_S_OK},swGetGpsAttr:function(e){return t.SendRequest({session:this._parent._parent,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_GET_PU_GPS,target:this._parent._id_pu,targetIndex:this._id_chanel,callback:e.callback,tag:e.tag})},swSetPuGpsAttr:function(e){return this.swGetGpsAttr({chanelid:e.chanelid,callback:function(n,o,i){var r=new proto.BVCU.PUConfig.GPSParam,s=n.tag,a=s.options;return r.setBenable(a.isenable),r.setIsetupsatellitesignal(i.isetupsatellitesignal),r.setIreportinterval(i.ireportinterval),r.setIreportdistance(i.ireportdistance),t.SendRequest({session:s.session,msgtype:proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_GPS,target:s.puid,targetIndex:this._id_chanel,payload:r,callback:e.callback,tag:s.options.tag})},tag:{session:this._parent._parent,options:e,puid:this._parent._id_pu}})}},jSW.SWTSPChanel=function(e,t){this._parent=e,this._info_chanel={id:t.getIchannelindex(),name:t.getSzname(),ptz:t.getIptz(),media:t.getImediadir()>>10,status:1023&t.getImediadir()},this._id_chanel=this._info_chanel.id,this._name_chanle=this._info_chanel.name},jSW.SWTSPChanel.prototype={_parent:null,_id_chanel:null,_name_chanel:null,_info_chanel:null,swClose:function(){if(null==this._parent||null==this._parent._parent)return console.warn("internal error, this._parent is null"),jSW.RcCode.RC_CODE_E_INVALIDARG;var e=this._parent._parent,n=t.BVCU_DialogParam(this._parent._id_pu,this._id_chanel,0,t.ProtoType.OTHER,0),o=t.JsonParamDialog(e._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_CLOSE_CHANLE,n),i=t._internalSend({cmd:t.RequestHeader.closechanle.cmd,session:e,request:o});return console.log("close chanel: "+this._parent._id_pu+" "+this._id_chanel),i},swOpen:function(e){if(null==this._parent||null==this._parent._parent)return console.error("internal error, this._parent is null"),jSW.RcCode.RC_CODE_E_INVALIDARG;var o=this._parent._parent,i=t.BVCU_DialogParam(this._parent._id_pu,this._id_chanel,0,t.ProtoType.OTHER,0),r=t.JsonParamDialog(o._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_OPEN_CHANLE_TSP,i);return e=n.extend({},{callback:null,tag:null},e||{}),t._internalSend({cmd:t.RequestHeader.openchanletsp.cmd,session:o,request:r,callback:e.callback,tag:e.tag})},swWrite:function(e){if(null==this._parent||null==this._parent._parent)return console.error("internal error, this._parent is null"),jSW.RcCode.RC_CODE_E_INVALIDARG;if(null==e.data)return console.error("write data is null"),jSW.RcCode.RC_CODE_E_INVALIDARG;var o=this._parent._parent,i=new proto.WEBBVCU.Notify_TSP_Data;if(i.setTargetid(this._parent._id_pu),i.setTargetindex(this._id_chanel),e.data instanceof Uint8Array);else if(e.data instanceof Array){var r=new Uint8Array(e.data.length),s=null;for(iiteindex in e.data)s=(s=e.data[iiteindex]).replace("0x",""),r[iiteindex]+=16*Number(s.charAt(0)),r[iiteindex]+=Number(s.charAt(1));e.data=r}else e.data=n.string2Uint8Array(e.data);i.setData(e.data);var a=t.JsonParamTSPDialog(o._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_WRITE_CHANLE_TSP,i);return e=n.extend({},{callback:null,data:null,tag:null},e||{}),t._internalSend({cmd:t.RequestHeader.writechanletsp.cmd,session:o,request:a,callback:e.callback,tag:e.tag})},swKeepLive:function(){if(null==this._parent&&this._parent._parent)return console.error("internal error, this._parent is null"),jSW.RcCode.RC_CODE_E_INVALIDARG;var e=this._parent._parent,n=new t.BVCU_DialogParam(this._parent._id_pu,this._id_chanel,0,t.ProtoType.OTHER,0),o=new t.JsonParamDialog(e._p_emms,proto.WEBBVCU.MSGType.WEB_BVCU_KEEPALIVE,n),i=t._internalSend({cmd:t.RequestHeader.keeplivechanle.cmd,session:e,request:o});return console.log("keeplive tsp chanel: "+n.getId()+" "+n.getMajor()),i},compare:function(e){return!!this._parent.compare(e._parent)&&this._id_chanel==e._id_chanel}},jSW.SWPlayer=function(e,t){this._parent=e,this._nru_id=t.nruId,this._file=t.file,this._dialog_id=t.dialogId,this._parent_div=t.parentDiv,this._player_id=t.playerId,this._time_begin=t.time_begin,this._time_end=t.time_end,this._bar=t.bar,this._bar.restTime(1e3*this.swGetDuration()),this._bar.setUserData(this),this._closecallback=t.callback,this._tag=t.tag},jSW.SWPlayer.prototype={_parent:null,_file:null,_nru_id:null,_dialog_id:-1,_player_id:null,_parent_div:null,_current_pts:-1,_time_begin:-1,_time_end:-1,_bar:null,_on_update_pts:function(e){this._current_pts=e,this._bar.changeBar(1e3*this.swGetCurrentTime())},swGetDuration:function(){return this._time_end-this._time_begin},swGetCurrentTime:function(){return-1==this._current_pts?0:Math.round(this._current_pts/1e3)-this._time_begin-28800},swStep:function(e){return(e=n.extend({},{},e||{})).cmdtype="STEP",e.dialogId=this._dialog_id,this._parent.swRecordPlayCtrl(e)},swJump:function(e){return(e=n.extend({},{},e||{})).cmdtype="PLAY",e.dialogId=this._dialog_id,this._parent.swRecordPlayCtrl(e)},swPlay:function(e){return(e=n.extend({},{},e||{})).cmdtype="PLAY",e.dialogId=this._dialog_id,this._parent.swRecordPlayCtrl(e)},swPause:function(e){return(e=n.extend({},{},e||{})).cmdtype="PAUSE",e.dialogId=this._dialog_id,this._parent.swRecordPlayCtrl(e)},swClose:function(e){(e=n.extend({},{},e||{})).cmdtype="TEARDOWN",e.dialogId=this._dialog_id;var t=this._parent.swRecordPlayCtrl(e);return this._parent_div.innerHTML="",this._parent_div.bv_uuid="",this._parent._swDelRecordPlayer(e.dialogId),this._closecallback&&this._closecallback(this._tag),t}},function(e){e.string2Uint8Array=function(e){var t,n,o=new Array;t=e.length;for(var i=0;i<t;i++)(n=e.charCodeAt(i))>=65536&&n<=1114111?(o.push(n>>18&7|240),o.push(n>>12&63|128),o.push(n>>6&63|128),o.push(63&n|128)):n>=2048&&n<=65535?(o.push(n>>12&15|224),o.push(n>>6&63|128),o.push(63&n|128)):n>=128&&n<=2047?(o.push(n>>6&31|192),o.push(63&n|128)):o.push(255&n);return o},e.getJsonString=function(e){return JSON.stringify(e)},e.getJsonObject=function(e){return jQuery.parseJSON(e)},e.isIE=function(){return!!(window.ActiveXObject||"ActiveXObject"in window)},e.supportFlash=function(){if(e.isIE())try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return!0}catch(e){}else try{if(void 0!=navigator.plugins["Shockwave Flash"])return!0}catch(e){}return!1},e.ManEmitCallback=function(e,t,n){var o={tag:e.tag},i={emms:t},r=e.callback;setTimeout(function(){r(o,i,n)},50)},e.CheckAsyncOption=function(e,t){var n=jSW.RcCode.RC_CODE_E_INVALIDARG;return e&&e.callback&&(n=t()),n},e.consoleLog=function(e,t){console.log(e+(t==jSW.RcCode.RC_CODE_S_OK?"Ok":"Failed"))},e.debugLog=function(t,n){e._IsDebug&&this.consoleLog(t,n)},e.debugLogInfo=function(t){e._IsDebug&&console.log(t)},e._IsDebug=!1,e.ajax=function(e,t){jQuery.ajax(e,t)},e.extend=function(e,t,n){return jQuery.extend(e,t,n)},e._getSessionById=function(e){var t=o.session_list,n=null,i=0;for(i=0;i<t.length;i++)if((n=t[i])&&n._p_emms.getSession()&&e==n._p_emms.getSession())return n;return null},e.generateUUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)})},e.FilterPath=function(e){for(var t=e,n=(t=(t=t.replace(":","")).replace(/\\/g,"/")).split("/"),o="",i=0;i<n.length;i++)1!=i&&(o+=n[i],i!=n.length-1&&(o+="/"));return o},e.PathParse=function(e){var t=e,n=(t=(t=t.replace(":","")).replace(/\\/g,"/")).split("/"),o=n[n.length-1].split("_");return{szpuid:o[0]+"_"+o[1],ichannelindex:o[2]}}}(n),function(e){e.JudgeIdType=function(e){var t={bPu:!1,bCu:!1,bUa:!1,bUx:!1};return 0==e.indexOf("PU_")?t.bPu=!0:0==e.indexOf("CU_")?t.bCu=!0:0==e.indexOf("UA_")?t.bUa=!0:0==e.indexOf("UX_")&&(t.bUx=!0),t},e.BuildEventOptions=function(e,t,n,o){return{cmd:e,request:t,session:n,tag:o}},e.BuildResponse=function(e,t){return{emms:{code:e},request:t}},e.ChanelType={unknow:"type_unknow",chanel:"type_chanel",gps:"type_gps",tsp:"type_tsp",custom:"type_custom",getType:function(t){return t>=0&&t<=65535?e.ChanelType.chanel:t>=65536&&t<=65791?e.ChanelType.gps:t>=65792&&t<=66047?e.ChanelType.tsp:t>=15728640&&t<=15728895?e.ChanelType.custom:e.ChanelType.unknow}},e.RequestHeader={notifys:{notify:{cmd:"notify"},notify_pu_onoffline:{cmd:"notify_pu_onoffline"},notify_event_source:{cmd:"notify_event_source"},notify_tsp_data:{cmd:"notify_tsp_data"},notify_down_from_pu:{cmd:"notify_down_from_pu"},notify_pu_apply_for_opening_dialog:{cmd:"notify_pu_apply_for_opening_dialog"},notifyimmsg:{cmd:"notifyimmsg"}},confnotify:{notifyconfcreate:{cmd:"notifyconfcreate"},notifyconfstart:{cmd:"notifyconfstart"},notifyconfdelete:{cmd:"notifyconfdelete"},notifyconfstop:{cmd:"getconfstop"},notifyparticipartoradd:{cmd:"notifyparticipartoradd"},notifyparticipartorjoin:{cmd:"notifyparticipartorjoin"},notifyparticipartorremove:{cmd:"notifyparticipartorremove"},notifyparticipartorexit:{cmd:"notifyparticipartorexit"},notifyapplyforstartspeak:{cmd:"notifyapplyforstartspeak"},notifyapplyforendspeak:{cmd:"notifyapplyforendspeak"},notifyinvitespeak:{cmd:"notifyinvitespeak"},notifyterminatespeak:{cmd:"notifyterminatespeak"},notifyparticipartorleave:{cmd:"notifyparticipartorleave"},notifyparticipartorreturn:{cmd:"notifyparticipartorreturn"},notifyparticipatormodify:{cmd:"notifyparticipatormodify"},notifyimmsg:{cmd:"notifyimmsg"},notifybaseinfo:{cmd:"notifybaseinfo"}},pubkey:{cmd:"pubkey"},login:{cmd:"login"},logout:{cmd:"logout"},keeplive:{cmd:"keeplive"},pulist:{cmd:"pulist"},openchanle:{cmd:"openchanle"},altervideodir:{cmd:"altervideodir"},keeplivechanle:{cmd:"keeplivechanle"},openchanletsp:{cmd:"openchanletsp"},writechanletsp:{cmd:"writechanletsp"},closechanle:{cmd:"closechanle"},pugpsdata:{cmd:"pugpsdata"},searchlist:{cmd:"searchlist"},recordfile_del:{cmd:"recordfile_del"},vod:{cmd:"vod"},snapshot:{cmd:"snapshot"},getptzattr:{cmd:"getptzattr"},setptzattr:{cmd:"setptzattr"},ptzctrl:{cmd:"ptzctrl"},getconflist:{cmd:"getconflist"},getconfinfo:{cmd:"getconfinfo"},confaudiorecord:{cmd:"confaudiorecord"},confimsend:{cmd:"confimsend"},getonuserlist:{cmd:"getonuserlist"},createconf:{cmd:"createconf"},deleteconf:{cmd:"deleteconf"},particularadd:{cmd:"particularadd"},particularremove:{cmd:"particularremove"},applyforspeak:{cmd:"applyforspeak"},applyforendspeak:{cmd:"applyforendspeak"},confstart:{cmd:"confstart"},confend:{cmd:"confend"},invitespeak:{cmd:"invitespeak"},terminalspeak:{cmd:"terminalspeak"},confleave:{cmd:"confleave"},confreturn:{cmd:"confreturn"},pucfg:{getpudeviceinfo:{cmd:"getpudeviceinfo"},getpuethernet:{cmd:"getpuethernet"},getpuradionetwork:{cmd:"getpuradionetwork"},getpuwifi:{cmd:"getpuwifi"},getPuPower:{cmd:"getPuPower"},getPuOnlineControl:{cmd:"getPuOnlineControl"},getPuUpdateStatus:{cmd:"getPuUpdateStatus"},getPuLinkactionList:{cmd:"getPuLinkactionList"},getPuCarInfo:{cmd:"getPuCarInfo"},getPuZfyInfo:{cmd:"getPuZfyInfo"},setPuZfyInfo:{cmd:"setPuZfyInfo"},getPuServers:{cmd:"getPuServers"}},usercfg:{modgroupinfo:{cmd:"modgroupinfo"},moduserinfo:{cmd:"moduserinfo"},moduserpwd:{cmd:"moduserpwd"},addgroup:{cmd:"addgroup"},adduser:{cmd:"adduser"},delgroup:{cmd:"delgroup"},deluser:{cmd:"deluser"},getgrouplist:{cmd:"getgrouplist"}},recordplay:{play:{cmd:"recordplay_play"},pause:{cmd:"recordplay_pause"},teardown:{cmd:"recordplay_teardown"}},compare:function(e,t){return e.req==t.req&&e.subreq==t.subreq}},e.ProtoType={HLS:1,RTMP:2,OCX:4,OTHER:5},e.RotateType={RIGHT90:90,LEFT90:-90},e.SendRequest=function(t){dft_options={session:null,msgtype:-1,target:"",targetIndex:-1,payload:null,cmd:"",hdlg:-1,callback:null,callbackrelay:null,tag:null,_dhcb:null,_dhcbtag:null},t=n.extend({},dft_options,t||{});var o=this.JsonParamCommand(t.session._p_emms,t.msgtype,e.BVCU_Command(t.target,t.targetIndex,t.payload,t.hdlg)),i=null;return null!=t.callbackrelay&&(i={callback:t.callbackrelay,options:{tag:t.tag},_dhcbtag:t._dhcbtag}),e._internalSend({cmd:t.cmd,session:t.session,request:o,callback:t.callback,attchdata:i,tag:t.tag})},e.EmmsHeader=function(e,t){this.key=e,this.ver=t,this.session="",this.id=0,this.code=0},e.GetPuLanguageByIndex=function(e){return 0==e?"INVALID":1==e?"ENGLISH":2==e?"CHINESE_SIMPLIFIED":3==e?"CHINESE_TRADITIONAL":void 0},e.BVCU_ServerParam=function(e,t,n,o){this.server=e,this.port=t,this.user=n,this.password=o},e.BVCU_DialogParam=function(e,t,n,o,i,r,s,a){var l=new proto.WEBBVCU.BVCU_DialogParam;return l.setId(e),l.setMajor(t),l.setMinor(n),l.setProto(o),l.setMedia(i),l.setHdlg(s),a&&l.setBovertcp(1),"undefined"!=r&&l.setHwnd(r),l},e.BVCU_Command=function(e,t,o,i){var r=new proto.WEBBVCU.Request;if(r.setTargetid(e),r.setTargetindex(t),r.setHdlg(i),null!=o)try{r.setPayload(o.serializeBinary().buffer)}catch(e){r.setPayload(n.string2Uint8Array(o))}return r},e.ParamPuList=function(e,t,n,o,i){var r=new proto.WEBBVCU.BVCU_GetPulist;return r.setStatus(e),r.setPagesize(t),r.setPage(n),r.setIndex(o),r.setIcount(i),r},e.BVCU_SearchInfo=function(e,t,n){this.iType=e,this.iPostition=t,this.iCount=n,this.iTotalCount=-1},e.SearchType={UNKNOWN:0,FILE:1,CU_LOGIN:2,PU_LOGIN:3,OPERATE:4,DIALOG:5,PULIST:6,EVENT:7},e.BVCU_Search_FileFilter=function(e,t,n,o,i,r,s,a){this.szPUID=e,this.iChannelIndex=t,this.iTimeBegin=n,this.iTimeEnd=o,this.iFileType=i,this.iRecordType=r,this.iFileSizeMin=s,this.iFileSizeMax=a},e.CheckOptions=function(e,t){var n=function(t,n,o){e+n};switch(e){case proto.WEBBVCU.MSGType.WEB_BVCU_CONF_IM_MSG:void 0!=t.szTextMsg&&null!=t.szTextMsg||n(0,"szTextMsg: set error!"),void 0!=t.callback&&null!=t.callback||n(0,"callback: set error!");break;case proto.WEBBVCU.MSGType.WEB_BVCU_SET_PU_REBOOT_OR_SHUTDOWN:void 0!=t.ioption&&null!=t.ioption&&0==t.ioption&&1==t.ioption||n(0,"ioption: set error!"),void 0!=t.callback&&null!=t.callback||n(0,"callback: set error!")}return jSW.RcCode.RC_CODE_S_OK},e.uint8ArrayToHexArray=function(e){for(var t=[],n="",o=0;o<e.length;o+=2)n="",n+=String.fromCharCode(e[o]),n+=String.fromCharCode(e[o+1]),t.push(n);return t},e.uint8ArrayToHex=function(e){for(var t="",n=0;n<e.length;n++)t+=(e[n]>>4).toString(16),t+=(15&e[n]).toString(16);return t},e.HexToString=function(e){return String.fromCharCode.apply(null,e)},e.LargeHexToString=function(e){for(var t="",n=0;n<e.length/2;n++){var o=[e[2*n],e[2*n+1]];t+=String.fromCharCode.apply(null,o)}return t},e.EventSourcePb2_Json=function(e){return{iEventType:(e=proto.BVCU.Event_Source.deserializeBinary(e)).getIeventtype(),stTime:this.Walltime2Json(e.getSttime()),szID:e.getSzid(),iSubDevIdx:e.getIsubdevidx(),iValue:e.getIvalue()}},e.SWFileTransInfoPb2_Json=function(e){return{iCreateTime:(e=proto.WEBBVCU.FileTransInfo.deserializeBinary(e)).getIcreatetime(),iOnlineTime:e.getIonlinetime(),iTransferBytes:e.getItransferbytes(),iTotalBytes:e.getItotalbytes(),iSpeedKBpsLongTerm:e.getIspeedkbpslongterm(),iSpeedKBpsShortTerm:e.getIspeedkbpsshortterm()}},e.SWFileTransEventPb2_Json=function(e){var t=(e=proto.WEBBVCU.FileTransInfo.deserializeBinary(e)).getDownfilefrompu(),n=t.getImgbase64();return{iEvent:e.getIevent(),iResult:e.getIresult(),szRemoteFilePath:t.getSzremotefilepathname(),szLocalFilePath:t.getSzlocalfilepathname(),imgbase64:n.length>0?this.LargeHexToString(t.getImgbase64()):"",nruid:e.getSznruid()}},e.SWOpenDialogPb2_Json=function(e){return{szID:(e=proto.BVCU.PUConfig.OpenDialog.deserializeBinary(e)).getSzid(),iChannelIndex:e.getIchannelindex(),iStreamIndex:e.getIstreamindex(),iAVStreamDir:e.getIavstreamdir(),bRecord:e.getBrecord(),iApplierID:e.getIapplierid()}},e.IMFilePb2json=function(e){return{szID:e.getSzid(),szFile:e.getSzfilepath(),iFileSize:e.getIfilesize(),iDuration:e.getIduration()}},e.IMMsgPb2_Json=function(e){var t=[];e=e.getSzmsgsList();for(var n,o=null,i=0,r=0;r<e.length;r++)n={iType:i=(o=e[r]).getItype(),szTextMsg:i==this.IMMSGTypes.TEXT||i==this.IMMSGTypes.FACE?o.getSztextmsg():null,stGpsData:i==this.IMMSGTypes.GPS?this.GPSDatapb2Json(o.getStgpsdata()):null,stFile:i==this.IMMSGTypes.PICTURE||i==this.IMMSGTypes.FILE?this.IMFilePb2json(o.getStfile()):null},t.push(n);return t},e.IMMsgPksPb2_Json=function(t){var n={iSourceId:t.getIsourceid(),szSourceId:t.getSzsourceid(),iTargetId:t.getItargetid(),szTargetId:t.getSztargetid(),szmsg:[],isPic:t.getBispic(),isDownload:t.getBisdownload(),imsgtype:t.getImsgtype()},o=proto.BVCU.IM_Msgs.deserializeBinary(t.getPayload());return n.szmsg=e.IMMsgPb2_Json(o),n},e.IMMSGTypes={UNKNOWN:0,TEXT:1,FACE:2,GPS:3,FILE:4,PICTURE:5,AUDIO:6,VIDEO:7,CUSTOM:8},e.EVENTACTIONS={NONE:0,DISKERROR:1,OUTOFDISKSPACE:2,VIDEOLOST:4096,VIDEOMD:4097,VIDEOOCCLUSION:4098,ALERTIN:4099,PERIOD:4100,PUONLINE:4101,PUOFFLINE:4102,LOWTEMPERATURE:4103,HIGHTEMPERATURE:4104,SLOWSPEED:4105,OVERSPEED:4106,INTOREGION:4107,OUTREGION:4108,LOWVOLTAGE:4109,HIGHVOLTAGE:4110,NRUONLINE:8192,NRUOFFLINE:8193,VTDUONLINE:12288,VTDUOFFLINE:12289,CMSONLINE:16384,CMSOFFLINE:16385,USERLOGIN:20480,USERLOGOUT:20481,DECONLINE:24576,DECOFFLINE:24577,CUSTOM:268435456},e.BVCU_EventStoragePb2_Json=function(e){return{iresult:(e=proto.WEBBVCU.EventStorage.deserializeBinary(e)).getIresult(),szfilename:this.HexToString(e.getSzfilename()),itimestamp:e.getItimestamp()}},e.Int2Uint=function(e){var t=Number(e),n=new Uint32Array(1);return n[0]=t,n[0]},e._CmdParse=function(e,t){return jSW.DependencyMgr.cmdParseInJect(function(n){return n.parseCmd(e,t)})},e.OperateSearchLogs2_Json=function(t){var n=proto.BVCU.Search.Search_Response.deserializeBinary(t),o=n.getStsearchinfo(),i=n.getPoperatelogList(),r={info:null,result:[]},s={ipostition:o.getIpostition(),icount:o.getIcount(),itotalcount:o.getItotalcount()};r.info=s;var a=null,l=null;for(operationindex in i)(l={szsourceid:(a=i[operationindex]).getSzsourceid(),szusername:a.getSzusername(),sztargetid:a.getSztargetid(),imethod:a.getImethod(),isubmethod:a.getIsubmethod(),iapplierid:a.getIapplierid(),itargetindex:a.getItargetindex(),ioperatetime:a.getIoperatetime(),bresult:a.getIresult(),szdescription:a.getSzdescription(),smethod:null}).smethod=e._CmdParse(l.imethod,l.isubmethod),r.result.push(l);return r},e._GetAllRescources=function(e,t){var n=[],o=null,i=null,r=null,s=null;try{for(puindex in e._arr_pu){for(recindex in o=e._arr_pu[puindex],r=null,t)if(s=t[recindex],o._id_pu==s.puid){r=s;break}if(null==r)for(channelindex in r={puid:o._id_pu,puname:o._info_pu.name.length>0?o._info_pu.name:o._id_pu,config:!1,channels:[]},o._arr_channel)i={channelindex:o._arr_channel[channelindex]._id_chanel,iscansee:!1},r.channels.push(i);n.push(r)}}catch(e){}return n},e._LocalResource_2Pb=function(e,t){var n=null,o=null,i=null,r=null,s=null;for(recindex in e){for(channelindex in o=e[recindex],n=new proto.BVCU.UserConfig.Resource,i=new proto.BVCU.UserConfig.PUPermissions,n.setSpuid(o.puid),n.setSzpermissions(i),i.setConfig(o.config?jSW.SwUserManager.PERMISSIONS.ON:jSW.SwUserManager.PERMISSIONS.OFF),r=new Uint8Array(o.channels.length),o.channels)r[(s=o.channels[channelindex]).channelindex]=s.iscansee?jSW.SwUserManager.PERMISSIONS.ON:jSW.SwUserManager.PERMISSIONS.OFF;i.setChannel(r),t.addPresource(n,recindex)}},e._BVCU_UCFG_Resource_Pb2Json=function(e,t){var n,o=e.getSzpermissions(),i=[],r=o.getChannel(),s=null;for(channelIndex in r)r[channelIndex],s={channelindex:Number(channelIndex),iscansee:r[channelIndex]==jSW.SwUserManager.PERMISSIONS.ON},i.push(s);return n=t._swGetPu(e.getSpuid()),{puid:e.getSpuid(),puname:null!=n&&n._info_pu.name.length>0?n._info_pu.name:e.getSpuid(),config:1==o.getConfig(),channels:i}},e.Walltime2Json=function(e){return{year:e.getIyear(),month:e.getImonth(),day:e.getIday(),hour:e.getIhour(),minute:e.getIminute(),second:e.getIsecond()}},e.GPSDatapb2Json=function(t){return{angle:t.getIangle(),antennaState:t.getBantennastate(),height:t.getIheight(),lat:t.getIlatitude(),lng:t.getIlongitude(),orientationState:t.getBorientationstate(),speed:t.getIspeed(),starCount:t.getIstarcount(),time:e.Walltime2Json(t.getSttime())}},e.FTPFileInfoGPSInfo2Json=function(t){var n=t.getFileinfo(),o=this.FTPFileInfo2Json(n),i=this.HexToString(t.getSzpuid()),r=this.HexToString(t.getSzpuname()),s=t.getSzgpsdataList(),a={fileinfo:o,gpsdata:{szpuid:i,szpuname:r,szgpspoint:[]}},l=null,_=null;for(gpsindex in s)_=s[gpsindex],l=e.GPSDatapb2Json(_),a.gpsdata.szgpspoint.push(l);return a},e.FTPFileInfo2Json=function(t){return{szFilePath:e.HexToString(t.getSzfilepath()),szFileName:e.HexToString(t.getSzfilename()),iTimeBegin:t.getItimebegin(),iTimeEnd:t.getItimeend(),iFileSize:t.getIfilesize()}},e.CmsChannelInfo2Json=function(e){var t={szID:null,iApplierID:0,iMediaDir:0,bOverTCP:0};return t.szID=e.getSzid(),t.iApplierID=e.getIapplierid(),t.iMediaDir=e.getImediadir(),t.bOverTCP=e.getBovertcp(),t},e.CmsDialogInfos2Json=function(t){var n=[];return t.getCmsdialoginfosList().forEach(function(t){var o={stRequestor:null,stTarget:null,szVTDUID:null,iChannelIndex:-1,iPathWay:0};o.stRequestor=e.CmsChannelInfo2Json(t.getStrequestor()),o.stTarget=e.CmsChannelInfo2Json(t.getSttarget()),o.szVTDUID=t.getSzvtduid(),o.iChannelIndex=t.getIchannelindex(),o.iPathWay=t.getIpathway(),n.push(o)}),n},e.GroupPb_2Json=function(e){return{id:e.getSid(),name:e.getSname(),parentid:e.getSparentid()}},e.GroupInfoPb_2Json=function(t,n){var o=t.getPresourceList(),i=this.BVCU_UCFG_Resource_Pb2Json(o,n);return{id:t.getSid(),name:t.getSname(),parentid:t.getSparentid(),description:t.getSdescription(),resources:i,allresources:e._GetAllRescources(n,[])}},e.USER_USERPb_2Json=function(e){return{id:e.getSid(),groupid:e.getSgroupid(),name:e.getSname()}},e.USER_USERINFO_Pb2Json=function(e,t){var n=e.getPresourceList();n=this.BVCU_UCFG_Resource_Pb2Json(n,t);var o=e.getIsysadmin();return{sId:e.getSid(),sPasswd:e.getSpasswd(),bSetPasswd:e.getSpasswd().length>0,sysadmin:{isGroup:(o&jSW.SwUserManager.SYSADMIN.GROUP)==jSW.SwUserManager.SYSADMIN.GROUP,isUser:(o&jSW.SwUserManager.SYSADMIN.USER)==jSW.SwUserManager.SYSADMIN.USER,isDev:(o&jSW.SwUserManager.SYSADMIN.DEV)==jSW.SwUserManager.SYSADMIN.DEV,isDevAss:(o&jSW.SwUserManager.SYSADMIN.DEVASS)==jSW.SwUserManager.SYSADMIN.DEVASS},iPtz:e.getIptz(),sServerId:e.getSserverid(),sGroupId:e.getSgroupid(),iMaxSession:e.getImaxsession(),sAllocateId:e.getSallocateid(),sName:e.getSname(),sPhone:e.getSphone(),sEmail:e.getSemail(),sDescription:e.getSdescription(),Resource:n}},e.BVCU_UCFG_Resource_Pb2Json=function(e,t){var n=null,o=[],i=null;for(resourceindex in e)n=e[resourceindex],i=this._BVCU_UCFG_Resource_Pb2Json(n,t),o.push(i);return o},e._BVCU_DayTimeSlice_Pb2Json=function(e){return{iHourBegin:e.getChourbegin(),iMinuteBegin:e.getCminutebegin(),iSecondBegin:e.getCsecondbegin(),iHourEnd:e.getChourend(),iMinuteEnd:e.getCminuteend(),iSecondEnd:e.getCsecondend()}},e.BVCU_DayTimeSlice_Pb2Json=function(e){var t=e.getStdayList();return{period0:{time:this._BVCU_DayTimeSlice_Pb2Json(t[0].getSttime()),rco:this._OnlineControlOne_Pb2Json(t[0].getStrco())},period1:{time:this._BVCU_DayTimeSlice_Pb2Json(t[1].getSttime()),rco:this._OnlineControlOne_Pb2Json(t[1].getStrco())},period2:{time:this._BVCU_DayTimeSlice_Pb2Json(t[2].getSttime()),rco:this._OnlineControlOne_Pb2Json(t[2].getStrco())},period3:{time:this._BVCU_DayTimeSlice_Pb2Json(t[3].getSttime()),rco:this._OnlineControlOne_Pb2Json(t[3].getStrco())},period4:{time:this._BVCU_DayTimeSlice_Pb2Json(t[4].getSttime()),rco:this._OnlineControlOne_Pb2Json(t[4].getStrco())},period5:{time:this._BVCU_DayTimeSlice_Pb2Json(t[5].getSttime()),rco:this._OnlineControlOne_Pb2Json(t[5].getStrco())}}},e.BVCU_DayTimeSlice_Pb2JsonOnly=function(e){var t=e.getStdayList();return{period0:this._BVCU_DayTimeSlice_Pb2Json(t[0]),period1:this._BVCU_DayTimeSlice_Pb2Json(t[1]),period2:this._BVCU_DayTimeSlice_Pb2Json(t[2]),period3:this._BVCU_DayTimeSlice_Pb2Json(t[3]),period4:this._BVCU_DayTimeSlice_Pb2Json(t[4]),period5:this._BVCU_DayTimeSlice_Pb2Json(t[5])}},e._OnlineControlOne_Pb2Json=function(e){return{iTrigger:e.getItrigger(),iEvent:e.getIevent(),iOnlineTime:e.getIonlinetime(),iThrough:e.getIthrough()}},e.Drivers2Json=function(e){var t=null,n=null,o=null,i=[];for(driverindex in e)o={stPersonInfo:{szName:(n=(t=e[driverindex]).getStpersoninfo()).getSzname(),cGender:n.getCgender(),sAge:n.getSage()},szCardID:t.getSzcardid(),szCertificateID:t.getSzcertificateid(),szIssuingAgency:t.getSzissuingagency()},i.push(o);return i},e.ParamSearchList=function(e,t){var n=new proto.BVCU.Search.Search_Request,o=new proto.BVCU.Search.SearchInfo,i=new proto.BVCU.Search.Search_FileFilter,r=t.iChannelIndex;return o.setIcount(e.iCount),o.setIpostition(e.iPostition),o.setItype(e.iType),i.setSzpuid(t.szPUID),-1==t.iChannelIndex&&(r=4294967295),i.setIchannelindex(r),i.setIfiletype(t.iFileType),i.setItimebegin(t.iTimeBegin),i.setItimeend(t.iTimeEnd),i.setIfilesizemin(t.iFileSizeMin),i.setIfilesizemax(t.iFileSizeMax),i.setIrecordtype(t.iRecordType),i.setSzdesc1(t.szDesc1),i.setSzdesc2(t.szDesc2),i.setItimecondition(t.iTimeCondition),n.setStsearchinfo(o),n.setStfilefilter(i),n},e.JsonParamLogin=function(e,t,n){this.emms=e,this.request=t,this.param=n},e.JsonParamNoAttach=function(e,t){var n=new proto.WEBBVCU.Request;return n.setEmms(e),n.setMsgtype(t),n},e.JsonParamDialog=function(e,t,n){var o=new proto.WEBBVCU.Request;return o.setEmms(e),o.setMsgtype(t),o.setPayload(n.serializeBinary().buffer),o.setTargetid(n.getId()),o.setTargetindex(n.getMajor()),o.setHdlg(n.getHdlg()),o},e.JsonParamTSPDialog=function(e,t,n){var o=new proto.WEBBVCU.Request;return o.setEmms(e),o.setMsgtype(t),o.setPayload(n.serializeBinary().buffer),o},e.JsonParamCommand=function(e,t,n){return n.setEmms(e),n.setMsgtype(t),n},e.txRequest=new Array,e.txRequestHelp=new Array,e.txGetRequestId=function(){for(var t=-1,n=0;n<e.txRequest.length;n++)null==e.txRequest[n]&&(t=n);return-1==t&&(t=n,e.txRequest[n]=1),t},e.txGetRequestRelayId=function(){for(var t=-1,n=0;n<e.txRequestHelp.length;n++)null==e.txRequestHelp[n]&&(t=n);return-1==t&&(t=n,e.txRequestHelp[n]=1),t},e.txSetRequestOption=function(t,n){e.txRequest[t]=n},e.txSetRequestHelperOption=function(t,n){e.txRequestHelp[t]=n},e.txGetRequestOption=function(t){return t>=0&&t<e.txRequest.length?e.txRequest[t]:null},e.txGetRequestHelperOption=function(t){return t>=0&&t<e.txRequestHelp.length?e.txRequestHelp[t]:null},e.txOnResponseUint8Array=function(t,o){var i=t,r=null;try{r=proto.WEBBVCU.Response.deserializeBinary(o)}catch(t){var s=e.HexToString(o);n.debugLog("deserialize protobuf error:"+s),n.debugLog(t)}if(r)if(i=r.getId(),options=e.txGetRequestOption(i),-2017==i){var a=r.getEmms(),l=n._getSessionById(a.getSession());if(l)null==options&&(options={cmd:null,callback:null}),l._internalNotify(options,r);else{var _=r.getMsgtype();console.warn(_+"session not found "+a.getSession())}}else options&&(e.txSetRequestOption(i,null),options.success&&"function"==typeof options.success&&options.success(r,0))},e.txOnResponse=function(t,n){var o=t,i=null;try{if(jSW._mMgr.bUseOcx())e.txOnResponseUint8Array(o,n);else{var r=new FileReader;r.addEventListener("loadend",function(){var t=r.result,n=new Uint8Array(t);e.txOnResponseUint8Array(o,n)}),r.readAsArrayBuffer(n)}}catch(t){console.error("error: "+t),(i=e.txGetRequestOption(o))&&(e.txSetRequestOption(o,null),i.error&&"function"==typeof i.error&&i.error(i.option,n,"get json object fail"))}},e.testSend="",e._internalSend=function(t){var n=t.session,o=t.request,i=e.txGetRequestId();if(o.setId(Number(i)),o.setRelayid(-1),null!=t.attchdata){var r=e.txGetRequestRelayId();o.setRelayid(r)}var s=null,a=null;if(o.getMsgtype()==proto.WEBBVCU.MSGType.WEB_BVCU_GET_PUBKEY)console.log("获取公钥"),a=o.serializeBinary();else if(o.getMsgtype()==proto.WEBBVCU.MSGType.WEB_BVCU_LOGIN)s=o.getPayload(),a=jnRSA.RSA_Encrypt_32UIntTo8Array(n.pubkey_d,n.pubkey_n,s),o.setPayload(a),a=o.serializeBinary(),console.log("登录:公钥 d:"+n.pubkey_d+", n:"+n.pubkey_n);else{if(!(n._serverConfig||null!=t.enforce&&t.enforce))return n._internalOnResponseFail(t,"","not login"),jSW.RcCode.RC_CODE_E_DISCONNECTED;a=o.serializeBinary()}if(a){jSW._mMgr.bUseOcx()||(a=a.buffer);var l={data:a,option:t,requestID:i,success:function(e,o){n._internalOnResponseSuccess(t,e,o)},error:function(e,o,i){n._internalOnResponseFail(t,o,i)}};return e.txSetRequestOption(i,l),null!=t.attchdata&&e.txSetRequestHelperOption(r,t.attchdata),e.testSend=l.data,n._send(l.data)}return jSW.RcCode.RC_CODE_E_FAIL}}(t),jSW.MEDIADIR={ALLNULL:0,VIDEOSEND:1,VIDEORECV:2,AUDIOSEND:4,AUDIORECV:8,DATASEND:16,DATARECV:32},jSW.FileTransEvent={DEFAULT:0,FILE_TRANS_OPEN:1,FILE_TRANS_CLOSE:2,FILE_TRANS_PROCESS:3},jSW.RcCode={RC_CODE_S_OK:0,RC_CODE_S_OTHER:1,RC_CODE_E_FAIL:-1,RC_CODE_E_INVALIDARG:-2,RC_CODE_E_USERNAME:-3,RC_CODE_E_PASSWORD:-4,RC_CODE_E_NOTFOUND:-5,RC_CODE_E_UNSUPPORTED:-6,RC_CODE_E_BUSY:-7,RC_CODE_E_NOTINITILIZED:-8,RC_CODE_E_TIMEOUT:-9,RC_CODE_E_ALREADYEXIST:-10,RC_CODE_E_DISCONNECTED:-11,RC_CODE_E_OTHER:-11,RC_CODE_E_BVCU_FAILED:20101,RC_CODE_E_BVCU_INVALIDARG:20102,RC_CODE_E_BVCU_UNSUPPORTED:20103,RC_CODE_E_BVCU_ALLOCMEMFAILED:20104,RC_CODE_E_BVCU_MEMALIGNMENT:20105,RC_CODE_E_BVCU_NOTFOUND:20106,RC_CODE_E_BVCU_NOTALLOWED:20107,RC_CODE_E_BVCU_IO:20108,RC_CODE_E_BVCU_EOF:20109,RC_CODE_E_BVCU_INVALIDDATA:20110,RC_CODE_E_BVCU_NOTIMPL:20111,RC_CODE_E_BVCU_BUSY:20112,RC_CODE_E_BVCU_INUSE:20113,RC_CODE_E_BVCU_BADREQUEST:20114,RC_CODE_E_BVCU_AUTHORIZE_FAILED:20115,RC_CODE_E_BVCU_BADSTATE:20116,RC_CODE_E_BVCU_NOTINITILIZED:20117,RC_CODE_E_BVCU_FATALERROR:20118,RC_CODE_E_BVCU_OUTOFSPACE:20119,RC_CODE_E_BVCU_DISCONNECTED:20120,RC_CODE_E_BVCU_TIMEOUT:20121,RC_CODE_E_BVCU_CONNECTFAILED:20122,RC_CODE_E_BVCU_ABORTED:20123,RC_CODE_E_BVCU_THRAEDCONTEXT:20124,RC_CODE_E_BVCU_UNAVAILABLE:20125,RC_CODE_E_BVCU_ALREADYEXIST:20126,RC_CODE_E_BVCU_SEVERINTERNAL:20127,RC_CODE_E_BVCU_MAXRETRIES:20128,RC_CODE_E_BVCU_AAA_OBJECTNOTFOUND:20129,RC_CODE_S_BVCU_OK:20130,RC_CODE_S_BVCU_IGNORE:20131,RC_CODE_S_BVCU_PENDING:20132,RC_CODE_S_BVCU_CONTINUE:20133,RC_CODE_S_SAV_OPEN_FAIL:20134,RC_CODE_E_REDIS_CONNECTED_FAIL:30601,RC_CODE_E_REDIS_SET_FAIL:30602,RC_CODE_E_REDIS_GET_FAIL:30603,RC_CODE_E_REDIS_GET_NIL:30604,RC_CODE_E_SW_CONNECTION_EXIT:30701,RC_CODE_E_SW_CONNECTION_NOT_EXIT:30702,RC_CODE_E_SW_PU_NOT_EXIT:30703,RC_CODE_E_SW_CHANEL_NOT_EXIT:30704,RC_CODE_E_SW_CREATE_THREAD_FAIL:30705,RC_CODE_E_SW_LISTENER_INIT_FAIL:30706,RC_CODE_E_SW_HIREDIS_INIT_FAIL:30707,RC_CODE_E_SW_JSON_PARSE:30708,RC_CODE_E_SW_HAVE_LOGIN:30709,RC_CODE_E_SW_LOGIN_ING:30710,RC_CODE_E_SW_CHANEL_HAVE_OPEN:30711,RC_CODE_E_SW_CHANEL_OPENING:30712,RC_CODE_E_SW_UN_SUPPORTED:30713,RC_CODE_E_SW_WAIT:30714,RC_CODE_E_SW_TIME_OUT:30715,RC_CODE_E_SW_INVALID_URL:30716,RC_CODE_E_SW_FILE_NOT_EXIST:30717,RC_CODE_E_SW_IO:30718,RC_CODE_E_SW_CHANEL_TYPE:30719,RC_CODE_S_HTTP_HAVE_NOTIFY:30720,RC_CODE_E_SOCKET_FAIL:30801,RC_CODE_E_SOCKET_CREATE_OBJECT:30802,RC_CODE_E_SOCKET_BIND:30803,RC_CODE_E_SOCKET_REGISTER_SIGNAL:30804,RC_CODE_E_SOCKET_SEND:30805,RC_CODE_E_INVALIDIP:30201,RC_CODE_E_INVALIDPORT:30202,RC_CODE_E_SERVICE_NOT_START:10501,bSuccess:function(e){return this.RC_CODE_S_OK==e},bFaild:function(e){return this.RC_CODE_S_OK!=e},trans:function(e){for(var t in this)if(this[t]==e)return t;return""}},jSW.PTZCommand={BVCU_PTZ_COMMAND_UP:0,BVCU_PTZ_COMMAND_DOWN:1,BVCU_PTZ_COMMAND_LEFT:2,BVCU_PTZ_COMMAND_RIGHT:3,BVCU_PTZ_COMMAND_LEFTTOP:4,BVCU_PTZ_COMMAND_RIGHTTOP:5,BVCU_PTZ_COMMAND_LEFTDOWN:6,BVCU_PTZ_COMMAND_RIGHTDOWN:7,BVCU_PTZ_COMMAND_ZOOM_INC:8,BVCU_PTZ_COMMAND_ZOOM_DEC:9,BVCU_PTZ_COMMAND_FOCUS_INC:10,BVCU_PTZ_COMMAND_FOCUS_DEC:11,BVCU_PTZ_COMMAND_APERTURE_INC:12,BVCU_PTZ_COMMAND_APERTURE_DEC:13,BVCU_PTZ_COMMAND_PRESET_GO:14,BVCU_PTZ_COMMAND_PRESET_SET:15,BVCU_PTZ_COMMAND_PRESET_SETNAME:16,BVCU_PTZ_COMMAND_PRESET_DEL:17,BVCU_PTZ_COMMAND_CRUISE_GO:18,BVCU_PTZ_COMMAND_CRUISE_STOP:19,BVCU_PTZ_COMMAND_CRUISE_SET:20,BVCU_PTZ_COMMAND_CRUISE_DEL:21,BVCU_PTZ_COMMAND_AUX:22,BVCU_PTZ_COMMAND_LOCK:23},jSW.SWCallbackManager=function(e,t){this.owner=e,this.callbacks={};for(var n=0;n<t.length;n++)this.callbacks[t[n]]=[]},jSW.SWCallbackManager.prototype={owner:null,callbacks:null,addCallback:function(e,t){"function"==typeof t&&this.callbacks[e]&&this.callbacks[e].push(t)},removeCallback:function(e,t){if("function"==typeof t&&this.callbacks[e])for(var n=this.callbacks[e],o=n.length,i=0;i<o;i++)if(n[i]===t){n.splice(i,1);break}},dispatchCallback:function(e,t){if(this.callbacks[e])for(var n=0;n<this.callbacks[e].length;n+=1)try{this.callbacks[e][n](this.owner,e,t)}catch(e){console.error(e)}}},function(e){var t=!1;e.bUseOcx=function(){return t&&o.CheckOcx()},e.bWsTest=function(){return!1};var n=!1;e.setBUseOcxWs=function(e){n?t!=e&&console.log("You Cann't Change The Ws Mode Right Now"):(n=!0,t=e)};var i=!1,r=!1;e.loadWebSocket=function(t,n,o){e.bUseOcx()?i||r?i&&t(n,o,a):(r=!0,jSW.DependencyMgr.loadDependsProxy(["modules/oxWebSocket.js"],null,function(){console.log("using ocx websocket"),t(n,o,a),i=!0},null)||console.error("bad ocxWebsocketLoad")):(console.log("using broswer websocket"),t(n,o,WebSocket))},e.oWsOpen=function(e){this.bUseOcx()&&e.open()};var s=null,a=null;e.regOcxWebSocket=function(e,t){(a=e).SetOcxHandle(l),s=t},e.GetOcxWsTag=function(){return s};var l=null;e.RegOcxHandle=function(e){l=e}}(jSW._mMgr=jSW._mMgr||{})};jSW.DependencyMgr=new function(){var _that=this,DependencyModuleName="DependCollection",AfterAsyncLoadHasResult=function(e){var t=e.getPath();null==t?e.emit():AsyncLoadJsCss(t,AfterAsyncLoadHasResult,e)},AsyncLoadJsCss=function(e,t,n){var o=null;e.indexOf(".js")>0?((o=document.createElement("script")).src=e,o.type="text/javascript"):e.indexOf(".css")>0&&((o=document.createElement("link")).type="text/css",o.rel="stylesheet",o.href=e),o&&(o.onload=function(){t(n)},document.head.appendChild(o))},LoadJsOrScript=function(e,t,n){var o=e;return!!window.XMLHttpRequest&&(AfterAsyncLoadHasResult({szPaths:o,index:0,lastIndex:0,getPath:function(){return this.index<this.szPaths.length?(this.lastIndex=this.index,this.index++,this.szPaths[this.lastIndex]):null},onResult:t,emit:function(){this.onResult&&this.onResult(this.tag)},tag:n}),!0)},ModuleInfo=function(e,t){this.names=e,this.promise=t,this.szNames=null},loadGetPaths=function(e,t){return new ModuleInfo(e,t).GetAbsPath()},loadDependsProxy=function(e,t,n,o){var i=loadGetPaths(e,t);return LoadJsOrScript(i,n,o)},RegModule=function(e,t){_that[DependencyModuleName][e]=t},InjectModule=function(e,t){return t(e)},GetModuleEntiey=function(e,t){return void 0===_that[DependencyModuleName]&&(_that[DependencyModuleName]={}),_that[e][t]},GetRegedModule=function(e,t,n){var o=GetModuleEntiey(DependencyModuleName,e);if(o)return InjectModule(o,n);loadDependsProxy([t],null,function(){var t=GetModuleEntiey(DependencyModuleName,e);InjectModule(t,n)},null)};jSW.jswGetDependUrl=function(e){return loadGetPaths([e])[0]},this.LoadProDepends=function(e,t){return loadDependsProxy(["thlib/jquery-1.8.2.min.js","bv.js","utils/Base64.js","utils/BigInt.js","utils/jn_rsa.js"],["jQuery","proto","Base64","BigInt","jnRSA"],e,t)},this.LoadHttpDepends=function(e,t){return loadDependsProxy(["thlib/video.min.js","thlib/videojs-contrib-hls.min.js","thlib/videojs.zoomrotate.js","thlib/video-js.min.css"],"videojs",e,t)},this.LoadOcxDepends=function(e,t){return loadDependsProxy(["thlib/jquery-playbar.js","thlib/barstyle.css"],null,e,t)},this.loadDependsProxy=loadDependsProxy,this.cmdParseInJect=function(e,t){return GetRegedModule("CmdParse","modules/CmdParse.js",t?e.bind(t):e)},ModuleInfo.prototype={dependencyRelativePath:"jswlib/",proJswPath:null,GetAbsPath:function(){if(null==this.szNames){this.szNames=[],null==this.proJswPath&&this._getJswProPath();for(var e="",t=0;t<this.names.length;t++)this.checkAllPromise(t)||(e=this.proJswPath+this.dependencyRelativePath+this.names[t],this.szNames.push(e))}return this.szNames},_getJswProPath:function(){for(var e=document.getElementsByTagName("script"),t=null,n=0;n<e.length;n++)if(e[n].src.indexOf("jsw.js")>=0){t=e[n];break}if(!t)return console.error("you can not modify the name of jsw.js, please check"),null;var o=t.src.split("jsw.js");this.proJswPath=o[0]},checkAllPromise:function(iIndex){var proExp="((typeof (pl) != 'undefined'))";return!!this.promise&&(this.promise instanceof Array?eval(proExp.replace("pl",this.promise[iIndex])):eval(proExp.replace("pl",this.promise)))}},this.RegModule=RegModule},jSWInit()}(jSW),String.prototype.startsWith=function(e){return 0==this.indexOf(e)}}]);